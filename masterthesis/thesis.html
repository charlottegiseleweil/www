<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script type="text/javascript">/*<![CDATA[*/
  /*
  LaTeXMathML.js from http://math.etsu.edu/LaTeXMathML/
  Adapted by Jeff Knisely and Douglas Woodall from ASCIIMathML.js v. 1.4.7,
  (c) 2005 Peter Jipsen http://www.chapman.edu/~jipsen.
  Released under the GNU General Public License version 2 or later.
  See the GNU General Public License (at http://www.gnu.org/copyleft/gpl.html)
  for more details.
  */
  var checkForMathML=true;var notifyIfNoMathML=true;var alertIfNoMathML=false;var mathcolor="";var mathfontfamily="";var showasciiformulaonhover=true;var isIE=document.createElementNS==null;if(document.getElementById==null)
  alert("This webpage requires a recent browser such as \nMozilla/Netscape 7+ or Internet Explorer 6+MathPlayer")
  function AMcreateElementXHTML(t){if(isIE)return document.createElement(t);else return document.createElementNS("http://www.w3.org/1999/xhtml",t);}
  function AMnoMathMLNote(){var nd=AMcreateElementXHTML("h3");nd.setAttribute("align","center")
  nd.appendChild(AMcreateElementXHTML("p"));nd.appendChild(document.createTextNode("To view the "));var an=AMcreateElementXHTML("a");an.appendChild(document.createTextNode("LaTeXMathML"));an.setAttribute("href","http://www.maths.nott.ac.uk/personal/drw/lm.html");nd.appendChild(an);nd.appendChild(document.createTextNode(" notation use Internet Explorer 6+"));an=AMcreateElementXHTML("a");an.appendChild(document.createTextNode("MathPlayer"));an.setAttribute("href","http://www.dessci.com/en/products/mathplayer/download.htm");nd.appendChild(an);nd.appendChild(document.createTextNode(" or Netscape/Mozilla/Firefox"));nd.appendChild(AMcreateElementXHTML("p"));return nd;}
  function AMisMathMLavailable(){if(navigator.appName.slice(0,8)=="Netscape")
  if(navigator.appVersion.slice(0,1)>="5")return null;else return AMnoMathMLNote();else if(navigator.appName.slice(0,9)=="Microsoft")
  try{var ActiveX=new ActiveXObject("MathPlayer.Factory.1");return null;}catch(e){return AMnoMathMLNote();}
  else return AMnoMathMLNote();}
  var AMcal=[0xEF35,0x212C,0xEF36,0xEF37,0x2130,0x2131,0xEF38,0x210B,0x2110,0xEF39,0xEF3A,0x2112,0x2133,0xEF3B,0xEF3C,0xEF3D,0xEF3E,0x211B,0xEF3F,0xEF40,0xEF41,0xEF42,0xEF43,0xEF44,0xEF45,0xEF46];var AMfrk=[0xEF5D,0xEF5E,0x212D,0xEF5F,0xEF60,0xEF61,0xEF62,0x210C,0x2111,0xEF63,0xEF64,0xEF65,0xEF66,0xEF67,0xEF68,0xEF69,0xEF6A,0x211C,0xEF6B,0xEF6C,0xEF6D,0xEF6E,0xEF6F,0xEF70,0xEF71,0x2128];var AMbbb=[0xEF8C,0xEF8D,0x2102,0xEF8E,0xEF8F,0xEF90,0xEF91,0x210D,0xEF92,0xEF93,0xEF94,0xEF95,0xEF96,0x2115,0xEF97,0x2119,0x211A,0x211D,0xEF98,0xEF99,0xEF9A,0xEF9B,0xEF9C,0xEF9D,0xEF9E,0x2124];var CONST=0,UNARY=1,BINARY=2,INFIX=3,LEFTBRACKET=4,RIGHTBRACKET=5,SPACE=6,UNDEROVER=7,DEFINITION=8,TEXT=9,BIG=10,LONG=11,STRETCHY=12,MATRIX=13;var AMsqrt={input:"\\sqrt",tag:"msqrt",output:"sqrt",ttype:UNARY},AMroot={input:"\\root",tag:"mroot",output:"root",ttype:BINARY},AMfrac={input:"\\frac",tag:"mfrac",output:"/",ttype:BINARY},AMover={input:"\\stackrel",tag:"mover",output:"stackrel",ttype:BINARY},AMatop={input:"\\atop",tag:"mfrac",output:"",ttype:INFIX},AMchoose={input:"\\choose",tag:"mfrac",output:"",ttype:INFIX},AMsub={input:"_",tag:"msub",output:"_",ttype:INFIX},AMsup={input:"^",tag:"msup",output:"^",ttype:INFIX},AMtext={input:"\\mathrm",tag:"mtext",output:"text",ttype:TEXT},AMmbox={input:"\\mbox",tag:"mtext",output:"mbox",ttype:TEXT};var AMsymbols=[{input:"\\alpha",tag:"mi",output:"\u03B1",ttype:CONST},{input:"\\beta",tag:"mi",output:"\u03B2",ttype:CONST},{input:"\\gamma",tag:"mi",output:"\u03B3",ttype:CONST},{input:"\\delta",tag:"mi",output:"\u03B4",ttype:CONST},{input:"\\epsilon",tag:"mi",output:"\u03B5",ttype:CONST},{input:"\\varepsilon",tag:"mi",output:"\u025B",ttype:CONST},{input:"\\zeta",tag:"mi",output:"\u03B6",ttype:CONST},{input:"\\eta",tag:"mi",output:"\u03B7",ttype:CONST},{input:"\\theta",tag:"mi",output:"\u03B8",ttype:CONST},{input:"\\vartheta",tag:"mi",output:"\u03D1",ttype:CONST},{input:"\\iota",tag:"mi",output:"\u03B9",ttype:CONST},{input:"\\kappa",tag:"mi",output:"\u03BA",ttype:CONST},{input:"\\lambda",tag:"mi",output:"\u03BB",ttype:CONST},{input:"\\mu",tag:"mi",output:"\u03BC",ttype:CONST},{input:"\\nu",tag:"mi",output:"\u03BD",ttype:CONST},{input:"\\xi",tag:"mi",output:"\u03BE",ttype:CONST},{input:"\\pi",tag:"mi",output:"\u03C0",ttype:CONST},{input:"\\varpi",tag:"mi",output:"\u03D6",ttype:CONST},{input:"\\rho",tag:"mi",output:"\u03C1",ttype:CONST},{input:"\\varrho",tag:"mi",output:"\u03F1",ttype:CONST},{input:"\\varsigma",tag:"mi",output:"\u03C2",ttype:CONST},{input:"\\sigma",tag:"mi",output:"\u03C3",ttype:CONST},{input:"\\tau",tag:"mi",output:"\u03C4",ttype:CONST},{input:"\\upsilon",tag:"mi",output:"\u03C5",ttype:CONST},{input:"\\phi",tag:"mi",output:"\u03C6",ttype:CONST},{input:"\\varphi",tag:"mi",output:"\u03D5",ttype:CONST},{input:"\\chi",tag:"mi",output:"\u03C7",ttype:CONST},{input:"\\psi",tag:"mi",output:"\u03C8",ttype:CONST},{input:"\\omega",tag:"mi",output:"\u03C9",ttype:CONST},{input:"\\Gamma",tag:"mo",output:"\u0393",ttype:CONST},{input:"\\Delta",tag:"mo",output:"\u0394",ttype:CONST},{input:"\\Theta",tag:"mo",output:"\u0398",ttype:CONST},{input:"\\Lambda",tag:"mo",output:"\u039B",ttype:CONST},{input:"\\Xi",tag:"mo",output:"\u039E",ttype:CONST},{input:"\\Pi",tag:"mo",output:"\u03A0",ttype:CONST},{input:"\\Sigma",tag:"mo",output:"\u03A3",ttype:CONST},{input:"\\Upsilon",tag:"mo",output:"\u03A5",ttype:CONST},{input:"\\Phi",tag:"mo",output:"\u03A6",ttype:CONST},{input:"\\Psi",tag:"mo",output:"\u03A8",ttype:CONST},{input:"\\Omega",tag:"mo",output:"\u03A9",ttype:CONST},{input:"\\frac12",tag:"mo",output:"\u00BD",ttype:CONST},{input:"\\frac14",tag:"mo",output:"\u00BC",ttype:CONST},{input:"\\frac34",tag:"mo",output:"\u00BE",ttype:CONST},{input:"\\frac13",tag:"mo",output:"\u2153",ttype:CONST},{input:"\\frac23",tag:"mo",output:"\u2154",ttype:CONST},{input:"\\frac15",tag:"mo",output:"\u2155",ttype:CONST},{input:"\\frac25",tag:"mo",output:"\u2156",ttype:CONST},{input:"\\frac35",tag:"mo",output:"\u2157",ttype:CONST},{input:"\\frac45",tag:"mo",output:"\u2158",ttype:CONST},{input:"\\frac16",tag:"mo",output:"\u2159",ttype:CONST},{input:"\\frac56",tag:"mo",output:"\u215A",ttype:CONST},{input:"\\frac18",tag:"mo",output:"\u215B",ttype:CONST},{input:"\\frac38",tag:"mo",output:"\u215C",ttype:CONST},{input:"\\frac58",tag:"mo",output:"\u215D",ttype:CONST},{input:"\\frac78",tag:"mo",output:"\u215E",ttype:CONST},{input:"\\pm",tag:"mo",output:"\u00B1",ttype:CONST},{input:"\\mp",tag:"mo",output:"\u2213",ttype:CONST},{input:"\\triangleleft",tag:"mo",output:"\u22B2",ttype:CONST},{input:"\\triangleright",tag:"mo",output:"\u22B3",ttype:CONST},{input:"\\cdot",tag:"mo",output:"\u22C5",ttype:CONST},{input:"\\star",tag:"mo",output:"\u22C6",ttype:CONST},{input:"\\ast",tag:"mo",output:"\u002A",ttype:CONST},{input:"\\times",tag:"mo",output:"\u00D7",ttype:CONST},{input:"\\div",tag:"mo",output:"\u00F7",ttype:CONST},{input:"\\circ",tag:"mo",output:"\u2218",ttype:CONST},{input:"\\bullet",tag:"mo",output:"\u2022",ttype:CONST},{input:"\\oplus",tag:"mo",output:"\u2295",ttype:CONST},{input:"\\ominus",tag:"mo",output:"\u2296",ttype:CONST},{input:"\\otimes",tag:"mo",output:"\u2297",ttype:CONST},{input:"\\bigcirc",tag:"mo",output:"\u25CB",ttype:CONST},{input:"\\oslash",tag:"mo",output:"\u2298",ttype:CONST},{input:"\\odot",tag:"mo",output:"\u2299",ttype:CONST},{input:"\\land",tag:"mo",output:"\u2227",ttype:CONST},{input:"\\wedge",tag:"mo",output:"\u2227",ttype:CONST},{input:"\\lor",tag:"mo",output:"\u2228",ttype:CONST},{input:"\\vee",tag:"mo",output:"\u2228",ttype:CONST},{input:"\\cap",tag:"mo",output:"\u2229",ttype:CONST},{input:"\\cup",tag:"mo",output:"\u222A",ttype:CONST},{input:"\\sqcap",tag:"mo",output:"\u2293",ttype:CONST},{input:"\\sqcup",tag:"mo",output:"\u2294",ttype:CONST},{input:"\\uplus",tag:"mo",output:"\u228E",ttype:CONST},{input:"\\amalg",tag:"mo",output:"\u2210",ttype:CONST},{input:"\\bigtriangleup",tag:"mo",output:"\u25B3",ttype:CONST},{input:"\\bigtriangledown",tag:"mo",output:"\u25BD",ttype:CONST},{input:"\\dag",tag:"mo",output:"\u2020",ttype:CONST},{input:"\\dagger",tag:"mo",output:"\u2020",ttype:CONST},{input:"\\ddag",tag:"mo",output:"\u2021",ttype:CONST},{input:"\\ddagger",tag:"mo",output:"\u2021",ttype:CONST},{input:"\\lhd",tag:"mo",output:"\u22B2",ttype:CONST},{input:"\\rhd",tag:"mo",output:"\u22B3",ttype:CONST},{input:"\\unlhd",tag:"mo",output:"\u22B4",ttype:CONST},{input:"\\unrhd",tag:"mo",output:"\u22B5",ttype:CONST},{input:"\\sum",tag:"mo",output:"\u2211",ttype:UNDEROVER},{input:"\\prod",tag:"mo",output:"\u220F",ttype:UNDEROVER},{input:"\\bigcap",tag:"mo",output:"\u22C2",ttype:UNDEROVER},{input:"\\bigcup",tag:"mo",output:"\u22C3",ttype:UNDEROVER},{input:"\\bigwedge",tag:"mo",output:"\u22C0",ttype:UNDEROVER},{input:"\\bigvee",tag:"mo",output:"\u22C1",ttype:UNDEROVER},{input:"\\bigsqcap",tag:"mo",output:"\u2A05",ttype:UNDEROVER},{input:"\\bigsqcup",tag:"mo",output:"\u2A06",ttype:UNDEROVER},{input:"\\coprod",tag:"mo",output:"\u2210",ttype:UNDEROVER},{input:"\\bigoplus",tag:"mo",output:"\u2A01",ttype:UNDEROVER},{input:"\\bigotimes",tag:"mo",output:"\u2A02",ttype:UNDEROVER},{input:"\\bigodot",tag:"mo",output:"\u2A00",ttype:UNDEROVER},{input:"\\biguplus",tag:"mo",output:"\u2A04",ttype:UNDEROVER},{input:"\\int",tag:"mo",output:"\u222B",ttype:CONST},{input:"\\oint",tag:"mo",output:"\u222E",ttype:CONST},{input:":=",tag:"mo",output:":=",ttype:CONST},{input:"\\lt",tag:"mo",output:"<",ttype:CONST},{input:"\\gt",tag:"mo",output:">",ttype:CONST},{input:"\\ne",tag:"mo",output:"\u2260",ttype:CONST},{input:"\\neq",tag:"mo",output:"\u2260",ttype:CONST},{input:"\\le",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\leq",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\leqslant",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\ge",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\geq",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\geqslant",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\equiv",tag:"mo",output:"\u2261",ttype:CONST},{input:"\\ll",tag:"mo",output:"\u226A",ttype:CONST},{input:"\\gg",tag:"mo",output:"\u226B",ttype:CONST},{input:"\\doteq",tag:"mo",output:"\u2250",ttype:CONST},{input:"\\prec",tag:"mo",output:"\u227A",ttype:CONST},{input:"\\succ",tag:"mo",output:"\u227B",ttype:CONST},{input:"\\preceq",tag:"mo",output:"\u227C",ttype:CONST},{input:"\\succeq",tag:"mo",output:"\u227D",ttype:CONST},{input:"\\subset",tag:"mo",output:"\u2282",ttype:CONST},{input:"\\supset",tag:"mo",output:"\u2283",ttype:CONST},{input:"\\subseteq",tag:"mo",output:"\u2286",ttype:CONST},{input:"\\supseteq",tag:"mo",output:"\u2287",ttype:CONST},{input:"\\sqsubset",tag:"mo",output:"\u228F",ttype:CONST},{input:"\\sqsupset",tag:"mo",output:"\u2290",ttype:CONST},{input:"\\sqsubseteq",tag:"mo",output:"\u2291",ttype:CONST},{input:"\\sqsupseteq",tag:"mo",output:"\u2292",ttype:CONST},{input:"\\sim",tag:"mo",output:"\u223C",ttype:CONST},{input:"\\simeq",tag:"mo",output:"\u2243",ttype:CONST},{input:"\\approx",tag:"mo",output:"\u2248",ttype:CONST},{input:"\\cong",tag:"mo",output:"\u2245",ttype:CONST},{input:"\\Join",tag:"mo",output:"\u22C8",ttype:CONST},{input:"\\bowtie",tag:"mo",output:"\u22C8",ttype:CONST},{input:"\\in",tag:"mo",output:"\u2208",ttype:CONST},{input:"\\ni",tag:"mo",output:"\u220B",ttype:CONST},{input:"\\owns",tag:"mo",output:"\u220B",ttype:CONST},{input:"\\propto",tag:"mo",output:"\u221D",ttype:CONST},{input:"\\vdash",tag:"mo",output:"\u22A2",ttype:CONST},{input:"\\dashv",tag:"mo",output:"\u22A3",ttype:CONST},{input:"\\models",tag:"mo",output:"\u22A8",ttype:CONST},{input:"\\perp",tag:"mo",output:"\u22A5",ttype:CONST},{input:"\\smile",tag:"mo",output:"\u2323",ttype:CONST},{input:"\\frown",tag:"mo",output:"\u2322",ttype:CONST},{input:"\\asymp",tag:"mo",output:"\u224D",ttype:CONST},{input:"\\notin",tag:"mo",output:"\u2209",ttype:CONST},{input:"\\begin{eqnarray}",output:"X",ttype:MATRIX,invisible:true},{input:"\\begin{array}",output:"X",ttype:MATRIX,invisible:true},{input:"\\\\",output:"}&{",ttype:DEFINITION},{input:"\\end{eqnarray}",output:"}}",ttype:DEFINITION},{input:"\\end{array}",output:"}}",ttype:DEFINITION},{input:"\\big",tag:"mo",output:"X",atval:"1.2",ieval:"2.2",ttype:BIG},{input:"\\Big",tag:"mo",output:"X",atval:"1.6",ieval:"2.6",ttype:BIG},{input:"\\bigg",tag:"mo",output:"X",atval:"2.2",ieval:"3.2",ttype:BIG},{input:"\\Bigg",tag:"mo",output:"X",atval:"2.9",ieval:"3.9",ttype:BIG},{input:"\\left",tag:"mo",output:"X",ttype:LEFTBRACKET},{input:"\\right",tag:"mo",output:"X",ttype:RIGHTBRACKET},{input:"{",output:"{",ttype:LEFTBRACKET,invisible:true},{input:"}",output:"}",ttype:RIGHTBRACKET,invisible:true},{input:"(",tag:"mo",output:"(",atval:"1",ttype:STRETCHY},{input:"[",tag:"mo",output:"[",atval:"1",ttype:STRETCHY},{input:"\\lbrack",tag:"mo",output:"[",atval:"1",ttype:STRETCHY},{input:"\\{",tag:"mo",output:"{",atval:"1",ttype:STRETCHY},{input:"\\lbrace",tag:"mo",output:"{",atval:"1",ttype:STRETCHY},{input:"\\langle",tag:"mo",output:"\u2329",atval:"1",ttype:STRETCHY},{input:"\\lfloor",tag:"mo",output:"\u230A",atval:"1",ttype:STRETCHY},{input:"\\lceil",tag:"mo",output:"\u2308",atval:"1",ttype:STRETCHY},{input:")",tag:"mo",output:")",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"]",tag:"mo",output:"]",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rbrack",tag:"mo",output:"]",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\}",tag:"mo",output:"}",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rbrace",tag:"mo",output:"}",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rangle",tag:"mo",output:"\u232A",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rfloor",tag:"mo",output:"\u230B",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rceil",tag:"mo",output:"\u2309",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"|",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\|",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"\\vert",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\Vert",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"\\mid",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\parallel",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"/",tag:"mo",output:"/",atval:"1.01",ttype:STRETCHY},{input:"\\backslash",tag:"mo",output:"\u2216",atval:"1",ttype:STRETCHY},{input:"\\setminus",tag:"mo",output:"\\",ttype:CONST},{input:"\\!",tag:"mspace",atname:"width",atval:"-0.167em",ttype:SPACE},{input:"\\,",tag:"mspace",atname:"width",atval:"0.167em",ttype:SPACE},{input:"\\>",tag:"mspace",atname:"width",atval:"0.222em",ttype:SPACE},{input:"\\:",tag:"mspace",atname:"width",atval:"0.222em",ttype:SPACE},{input:"\\;",tag:"mspace",atname:"width",atval:"0.278em",ttype:SPACE},{input:"~",tag:"mspace",atname:"width",atval:"0.333em",ttype:SPACE},{input:"\\quad",tag:"mspace",atname:"width",atval:"1em",ttype:SPACE},{input:"\\qquad",tag:"mspace",atname:"width",atval:"2em",ttype:SPACE},{input:"\\prime",tag:"mo",output:"\u2032",ttype:CONST},{input:"'",tag:"mo",output:"\u02B9",ttype:CONST},{input:"''",tag:"mo",output:"\u02BA",ttype:CONST},{input:"'''",tag:"mo",output:"\u2034",ttype:CONST},{input:"''''",tag:"mo",output:"\u2057",ttype:CONST},{input:"\\ldots",tag:"mo",output:"\u2026",ttype:CONST},{input:"\\cdots",tag:"mo",output:"\u22EF",ttype:CONST},{input:"\\vdots",tag:"mo",output:"\u22EE",ttype:CONST},{input:"\\ddots",tag:"mo",output:"\u22F1",ttype:CONST},{input:"\\forall",tag:"mo",output:"\u2200",ttype:CONST},{input:"\\exists",tag:"mo",output:"\u2203",ttype:CONST},{input:"\\Re",tag:"mo",output:"\u211C",ttype:CONST},{input:"\\Im",tag:"mo",output:"\u2111",ttype:CONST},{input:"\\aleph",tag:"mo",output:"\u2135",ttype:CONST},{input:"\\hbar",tag:"mo",output:"\u210F",ttype:CONST},{input:"\\ell",tag:"mo",output:"\u2113",ttype:CONST},{input:"\\wp",tag:"mo",output:"\u2118",ttype:CONST},{input:"\\emptyset",tag:"mo",output:"\u2205",ttype:CONST},{input:"\\infty",tag:"mo",output:"\u221E",ttype:CONST},{input:"\\surd",tag:"mo",output:"\\sqrt{}",ttype:DEFINITION},{input:"\\partial",tag:"mo",output:"\u2202",ttype:CONST},{input:"\\nabla",tag:"mo",output:"\u2207",ttype:CONST},{input:"\\triangle",tag:"mo",output:"\u25B3",ttype:CONST},{input:"\\therefore",tag:"mo",output:"\u2234",ttype:CONST},{input:"\\angle",tag:"mo",output:"\u2220",ttype:CONST},{input:"\\diamond",tag:"mo",output:"\u22C4",ttype:CONST},{input:"\\Diamond",tag:"mo",output:"\u25C7",ttype:CONST},{input:"\\neg",tag:"mo",output:"\u00AC",ttype:CONST},{input:"\\lnot",tag:"mo",output:"\u00AC",ttype:CONST},{input:"\\bot",tag:"mo",output:"\u22A5",ttype:CONST},{input:"\\top",tag:"mo",output:"\u22A4",ttype:CONST},{input:"\\square",tag:"mo",output:"\u25AB",ttype:CONST},{input:"\\Box",tag:"mo",output:"\u25A1",ttype:CONST},{input:"\\wr",tag:"mo",output:"\u2240",ttype:CONST},{input:"\\arccos",tag:"mi",output:"arccos",ttype:UNARY,func:true},{input:"\\arcsin",tag:"mi",output:"arcsin",ttype:UNARY,func:true},{input:"\\arctan",tag:"mi",output:"arctan",ttype:UNARY,func:true},{input:"\\arg",tag:"mi",output:"arg",ttype:UNARY,func:true},{input:"\\cos",tag:"mi",output:"cos",ttype:UNARY,func:true},{input:"\\cosh",tag:"mi",output:"cosh",ttype:UNARY,func:true},{input:"\\cot",tag:"mi",output:"cot",ttype:UNARY,func:true},{input:"\\coth",tag:"mi",output:"coth",ttype:UNARY,func:true},{input:"\\csc",tag:"mi",output:"csc",ttype:UNARY,func:true},{input:"\\deg",tag:"mi",output:"deg",ttype:UNARY,func:true},{input:"\\det",tag:"mi",output:"det",ttype:UNARY,func:true},{input:"\\dim",tag:"mi",output:"dim",ttype:UNARY,func:true},{input:"\\exp",tag:"mi",output:"exp",ttype:UNARY,func:true},{input:"\\gcd",tag:"mi",output:"gcd",ttype:UNARY,func:true},{input:"\\hom",tag:"mi",output:"hom",ttype:UNARY,func:true},{input:"\\inf",tag:"mo",output:"inf",ttype:UNDEROVER},{input:"\\ker",tag:"mi",output:"ker",ttype:UNARY,func:true},{input:"\\lg",tag:"mi",output:"lg",ttype:UNARY,func:true},{input:"\\lim",tag:"mo",output:"lim",ttype:UNDEROVER},{input:"\\liminf",tag:"mo",output:"liminf",ttype:UNDEROVER},{input:"\\limsup",tag:"mo",output:"limsup",ttype:UNDEROVER},{input:"\\ln",tag:"mi",output:"ln",ttype:UNARY,func:true},{input:"\\log",tag:"mi",output:"log",ttype:UNARY,func:true},{input:"\\max",tag:"mo",output:"max",ttype:UNDEROVER},{input:"\\min",tag:"mo",output:"min",ttype:UNDEROVER},{input:"\\Pr",tag:"mi",output:"Pr",ttype:UNARY,func:true},{input:"\\sec",tag:"mi",output:"sec",ttype:UNARY,func:true},{input:"\\sin",tag:"mi",output:"sin",ttype:UNARY,func:true},{input:"\\sinh",tag:"mi",output:"sinh",ttype:UNARY,func:true},{input:"\\sup",tag:"mo",output:"sup",ttype:UNDEROVER},{input:"\\tan",tag:"mi",output:"tan",ttype:UNARY,func:true},{input:"\\tanh",tag:"mi",output:"tanh",ttype:UNARY,func:true},{input:"\\gets",tag:"mo",output:"\u2190",ttype:CONST},{input:"\\leftarrow",tag:"mo",output:"\u2190",ttype:CONST},{input:"\\to",tag:"mo",output:"\u2192",ttype:CONST},{input:"\\rightarrow",tag:"mo",output:"\u2192",ttype:CONST},{input:"\\leftrightarrow",tag:"mo",output:"\u2194",ttype:CONST},{input:"\\uparrow",tag:"mo",output:"\u2191",ttype:CONST},{input:"\\downarrow",tag:"mo",output:"\u2193",ttype:CONST},{input:"\\updownarrow",tag:"mo",output:"\u2195",ttype:CONST},{input:"\\Leftarrow",tag:"mo",output:"\u21D0",ttype:CONST},{input:"\\Rightarrow",tag:"mo",output:"\u21D2",ttype:CONST},{input:"\\Leftrightarrow",tag:"mo",output:"\u21D4",ttype:CONST},{input:"\\iff",tag:"mo",output:"~\\Longleftrightarrow~",ttype:DEFINITION},{input:"\\Uparrow",tag:"mo",output:"\u21D1",ttype:CONST},{input:"\\Downarrow",tag:"mo",output:"\u21D3",ttype:CONST},{input:"\\Updownarrow",tag:"mo",output:"\u21D5",ttype:CONST},{input:"\\mapsto",tag:"mo",output:"\u21A6",ttype:CONST},{input:"\\longleftarrow",tag:"mo",output:"\u2190",ttype:LONG},{input:"\\longrightarrow",tag:"mo",output:"\u2192",ttype:LONG},{input:"\\longleftrightarrow",tag:"mo",output:"\u2194",ttype:LONG},{input:"\\Longleftarrow",tag:"mo",output:"\u21D0",ttype:LONG},{input:"\\Longrightarrow",tag:"mo",output:"\u21D2",ttype:LONG},{input:"\\Longleftrightarrow",tag:"mo",output:"\u21D4",ttype:LONG},{input:"\\longmapsto",tag:"mo",output:"\u21A6",ttype:CONST},AMsqrt,AMroot,AMfrac,AMover,AMsub,AMsup,AMtext,AMmbox,AMatop,AMchoose,{input:"\\acute",tag:"mover",output:"\u00B4",ttype:UNARY,acc:true},{input:"\\grave",tag:"mover",output:"\u0060",ttype:UNARY,acc:true},{input:"\\breve",tag:"mover",output:"\u02D8",ttype:UNARY,acc:true},{input:"\\check",tag:"mover",output:"\u02C7",ttype:UNARY,acc:true},{input:"\\dot",tag:"mover",output:".",ttype:UNARY,acc:true},{input:"\\ddot",tag:"mover",output:"..",ttype:UNARY,acc:true},{input:"\\mathring",tag:"mover",output:"\u00B0",ttype:UNARY,acc:true},{input:"\\vec",tag:"mover",output:"\u20D7",ttype:UNARY,acc:true},{input:"\\overrightarrow",tag:"mover",output:"\u20D7",ttype:UNARY,acc:true},{input:"\\overleftarrow",tag:"mover",output:"\u20D6",ttype:UNARY,acc:true},{input:"\\hat",tag:"mover",output:"\u005E",ttype:UNARY,acc:true},{input:"\\widehat",tag:"mover",output:"\u0302",ttype:UNARY,acc:true},{input:"\\tilde",tag:"mover",output:"~",ttype:UNARY,acc:true},{input:"\\widetilde",tag:"mover",output:"\u02DC",ttype:UNARY,acc:true},{input:"\\bar",tag:"mover",output:"\u203E",ttype:UNARY,acc:true},{input:"\\overbrace",tag:"mover",output:"\uFE37",ttype:UNARY,acc:true},{input:"\\overbracket",tag:"mover",output:"\u23B4",ttype:UNARY,acc:true},{input:"\\overline",tag:"mover",output:"\u00AF",ttype:UNARY,acc:true},{input:"\\underbrace",tag:"munder",output:"\uFE38",ttype:UNARY,acc:true},{input:"\\underbracket",tag:"munder",output:"\u23B5",ttype:UNARY,acc:true},{input:"\\underline",tag:"munder",output:"\u00AF",ttype:UNARY,acc:true},{input:"\\displaystyle",tag:"mstyle",atname:"displaystyle",atval:"true",ttype:UNARY},{input:"\\textstyle",tag:"mstyle",atname:"displaystyle",atval:"false",ttype:UNARY},{input:"\\scriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"1",ttype:UNARY},{input:"\\scriptscriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"2",ttype:UNARY},{input:"\\textrm",tag:"mstyle",output:"\\mathrm",ttype:DEFINITION},{input:"\\mathbf",tag:"mstyle",atname:"mathvariant",atval:"bold",ttype:UNARY},{input:"\\textbf",tag:"mstyle",atname:"mathvariant",atval:"bold",ttype:UNARY},{input:"\\mathit",tag:"mstyle",atname:"mathvariant",atval:"italic",ttype:UNARY},{input:"\\textit",tag:"mstyle",atname:"mathvariant",atval:"italic",ttype:UNARY},{input:"\\mathtt",tag:"mstyle",atname:"mathvariant",atval:"monospace",ttype:UNARY},{input:"\\texttt",tag:"mstyle",atname:"mathvariant",atval:"monospace",ttype:UNARY},{input:"\\mathsf",tag:"mstyle",atname:"mathvariant",atval:"sans-serif",ttype:UNARY},{input:"\\mathbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",ttype:UNARY,codes:AMbbb},{input:"\\mathcal",tag:"mstyle",atname:"mathvariant",atval:"script",ttype:UNARY,codes:AMcal},{input:"\\mathfrak",tag:"mstyle",atname:"mathvariant",atval:"fraktur",ttype:UNARY,codes:AMfrk},{input:"\\textcolor",tag:"mstyle",atname:"mathvariant",atval:"mathcolor",ttype:BINARY},{input:"\\colorbox",tag:"mstyle",atname:"mathvariant",atval:"background",ttype:BINARY}];function compareNames(s1,s2){if(s1.input>s2.input)return 1
  else return-1;}
  var AMnames=[];function AMinitSymbols(){AMsymbols.sort(compareNames);for(i=0;i<AMsymbols.length;i++)AMnames[i]=AMsymbols[i].input;}
  var AMmathml="http://www.w3.org/1998/Math/MathML";function AMcreateElementMathML(t){if(isIE)return document.createElement("m:"+t);else return document.createElementNS(AMmathml,t);}
  function AMcreateMmlNode(t,frag){if(isIE)var node=document.createElement("m:"+t);else var node=document.createElementNS(AMmathml,t);node.appendChild(frag);return node;}
  function newcommand(oldstr,newstr){AMsymbols=AMsymbols.concat([{input:oldstr,tag:"mo",output:newstr,ttype:DEFINITION}]);}
  function AMremoveCharsAndBlanks(str,n){var st;st=str.slice(n);for(var i=0;i<st.length&&st.charCodeAt(i)<=32;i=i+1);return st.slice(i);}
  function AMposition(arr,str,n){if(n==0){var h,m;n=-1;h=arr.length;while(n+1<h){m=(n+h)>>1;if(arr[m]<str)n=m;else h=m;}
  return h;}else
  for(var i=n;i<arr.length&&arr[i]<str;i++);return i;}
  function AMgetSymbol(str){var k=0;var j=0;var mk;var st;var tagst;var match="";var more=true;for(var i=1;i<=str.length&&more;i++){st=str.slice(0,i);j=k;k=AMposition(AMnames,st,j);if(k<AMnames.length&&str.slice(0,AMnames[k].length)==AMnames[k]){match=AMnames[k];mk=k;i=match.length;}
  more=k<AMnames.length&&str.slice(0,AMnames[k].length)>=AMnames[k];}
  AMpreviousSymbol=AMcurrentSymbol;if(match!=""){AMcurrentSymbol=AMsymbols[mk].ttype;return AMsymbols[mk];}
  AMcurrentSymbol=CONST;k=1;st=str.slice(0,1);if("0"<=st&&st<="9")tagst="mn";else tagst=(("A">st||st>"Z")&&("a">st||st>"z")?"mo":"mi");return{input:st,tag:tagst,output:st,ttype:CONST};}
  var AMpreviousSymbol,AMcurrentSymbol;function AMparseSexpr(str){var symbol,node,result,result2,i,st,newFrag=document.createDocumentFragment();str=AMremoveCharsAndBlanks(str,0);symbol=AMgetSymbol(str);if(symbol==null||symbol.ttype==RIGHTBRACKET)
  return[null,str,null];if(symbol.ttype==DEFINITION){str=symbol.output+AMremoveCharsAndBlanks(str,symbol.input.length);symbol=AMgetSymbol(str);if(symbol==null||symbol.ttype==RIGHTBRACKET)
  return[null,str,null];}
  str=AMremoveCharsAndBlanks(str,symbol.input.length);switch(symbol.ttype){case SPACE:node=AMcreateElementMathML(symbol.tag);node.setAttribute(symbol.atname,symbol.atval);return[node,str,symbol.tag];case UNDEROVER:if(isIE){if(symbol.input.substr(0,4)=="\\big"){str="\\"+symbol.input.substr(4)+str;symbol=AMgetSymbol(str);symbol.ttype=UNDEROVER;str=AMremoveCharsAndBlanks(str,symbol.input.length);}}
  return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];case CONST:var output=symbol.output;if(isIE){if(symbol.input=="'")
  output="\u2032";else if(symbol.input=="''")
  output="\u2033";else if(symbol.input=="'''")
  output="\u2033\u2032";else if(symbol.input=="''''")
  output="\u2033\u2033";else if(symbol.input=="\\square")
  output="\u25A1";else if(symbol.input.substr(0,5)=="\\frac"){var denom=symbol.input.substr(6,1);if(denom=="5"||denom=="6"){str=symbol.input.replace(/\\frac/,"\\frac ")+str;return[node,str,symbol.tag];}}}
  node=AMcreateMmlNode(symbol.tag,document.createTextNode(output));return[node,str,symbol.tag];case LONG:node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));node.setAttribute("minsize","1.5");node.setAttribute("maxsize","1.5");node=AMcreateMmlNode("mover",node);node.appendChild(AMcreateElementMathML("mspace"));return[node,str,symbol.tag];case STRETCHY:if(isIE&&symbol.input=="\\backslash")
  symbol.output="\\";node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));if(symbol.input=="|"||symbol.input=="\\vert"||symbol.input=="\\|"||symbol.input=="\\Vert"){node.setAttribute("lspace","0em");node.setAttribute("rspace","0em");}
  node.setAttribute("maxsize",symbol.atval);if(symbol.rtag!=null)
  return[node,str,symbol.rtag];else
  return[node,str,symbol.tag];case BIG:var atval=symbol.atval;if(isIE)
  atval=symbol.ieval;symbol=AMgetSymbol(str);if(symbol==null)
  return[null,str,null];str=AMremoveCharsAndBlanks(str,symbol.input.length);node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("height",atval+"ex");node=AMcreateMmlNode("mrow",node);node.appendChild(space);}else{node.setAttribute("minsize",atval);node.setAttribute("maxsize",atval);}
  return[node,str,symbol.tag];case LEFTBRACKET:if(symbol.input=="\\left"){symbol=AMgetSymbol(str);if(symbol!=null){if(symbol.input==".")
  symbol.invisible=true;str=AMremoveCharsAndBlanks(str,symbol.input.length);}}
  result=AMparseExpr(str,true,false);if(symbol==null||(typeof symbol.invisible=="boolean"&&symbol.invisible))
  node=AMcreateMmlNode("mrow",result[0]);else{node=AMcreateMmlNode("mo",document.createTextNode(symbol.output));node=AMcreateMmlNode("mrow",node);node.appendChild(result[0]);}
  return[node,result[1],result[2]];case MATRIX:if(symbol.input=="\\begin{array}"){var mask="";symbol=AMgetSymbol(str);str=AMremoveCharsAndBlanks(str,0);if(symbol==null)
  mask="l";else{str=AMremoveCharsAndBlanks(str,symbol.input.length);if(symbol.input!="{")
  mask="l";else do{symbol=AMgetSymbol(str);if(symbol!=null){str=AMremoveCharsAndBlanks(str,symbol.input.length);if(symbol.input!="}")
  mask=mask+symbol.input;}}while(symbol!=null&&symbol.input!=""&&symbol.input!="}");}
  result=AMparseExpr("{"+str,true,true);node=AMcreateMmlNode("mtable",result[0]);mask=mask.replace(/l/g,"left ");mask=mask.replace(/r/g,"right ");mask=mask.replace(/c/g,"center ");node.setAttribute("columnalign",mask);node.setAttribute("displaystyle","false");if(isIE)
  return[node,result[1],null];var lspace=AMcreateElementMathML("mspace");lspace.setAttribute("width","0.167em");var rspace=AMcreateElementMathML("mspace");rspace.setAttribute("width","0.167em");var node1=AMcreateMmlNode("mrow",lspace);node1.appendChild(node);node1.appendChild(rspace);return[node1,result[1],null];}else{result=AMparseExpr("{"+str,true,true);node=AMcreateMmlNode("mtable",result[0]);if(isIE)
  node.setAttribute("columnspacing","0.25em");else
  node.setAttribute("columnspacing","0.167em");node.setAttribute("columnalign","right center left");node.setAttribute("displaystyle","true");node=AMcreateMmlNode("mrow",node);return[node,result[1],null];}
  case TEXT:if(str.charAt(0)=="{")i=str.indexOf("}");else i=0;if(i==-1)
  i=str.length;st=str.slice(1,i);if(st.charAt(0)==" "){node=AMcreateElementMathML("mspace");node.setAttribute("width","0.33em");newFrag.appendChild(node);}
  newFrag.appendChild(AMcreateMmlNode(symbol.tag,document.createTextNode(st)));if(st.charAt(st.length-1)==" "){node=AMcreateElementMathML("mspace");node.setAttribute("width","0.33em");newFrag.appendChild(node);}
  str=AMremoveCharsAndBlanks(str,i+1);return[AMcreateMmlNode("mrow",newFrag),str,null];case UNARY:result=AMparseSexpr(str);if(result[0]==null)return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str];if(typeof symbol.func=="boolean"&&symbol.func){st=str.charAt(0);if(st=="^"||st=="_"||st==","){return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];}else{node=AMcreateMmlNode("mrow",AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)));if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("width","0.167em");node.appendChild(space);}
  node.appendChild(result[0]);return[node,result[1],symbol.tag];}}
  if(symbol.input=="\\sqrt"){if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("height","1.2ex");space.setAttribute("width","0em");node=AMcreateMmlNode(symbol.tag,result[0])
  node.appendChild(space);return[node,result[1],symbol.tag];}else
  return[AMcreateMmlNode(symbol.tag,result[0]),result[1],symbol.tag];}else if(typeof symbol.acc=="boolean"&&symbol.acc){node=AMcreateMmlNode(symbol.tag,result[0]);var output=symbol.output;if(isIE){if(symbol.input=="\\hat")
  output="\u0302";else if(symbol.input=="\\widehat")
  output="\u005E";else if(symbol.input=="\\bar")
  output="\u00AF";else if(symbol.input=="\\grave")
  output="\u0300";else if(symbol.input=="\\tilde")
  output="\u0303";}
  var node1=AMcreateMmlNode("mo",document.createTextNode(output));if(symbol.input=="\\vec"||symbol.input=="\\check")
  node1.setAttribute("maxsize","1.2");if(isIE&&symbol.input=="\\bar")
  node1.setAttribute("maxsize","0.5");if(symbol.input=="\\underbrace"||symbol.input=="\\underline")
  node1.setAttribute("accentunder","true");else
  node1.setAttribute("accent","true");node.appendChild(node1);if(symbol.input=="\\overbrace"||symbol.input=="\\underbrace")
  node.ttype=UNDEROVER;return[node,result[1],symbol.tag];}else{if(!isIE&&typeof symbol.codes!="undefined"){for(i=0;i<result[0].childNodes.length;i++)
  if(result[0].childNodes[i].nodeName=="mi"||result[0].nodeName=="mi"){st=(result[0].nodeName=="mi"?result[0].firstChild.nodeValue:result[0].childNodes[i].firstChild.nodeValue);var newst=[];for(var j=0;j<st.length;j++)
  if(st.charCodeAt(j)>64&&st.charCodeAt(j)<91)newst=newst+
  String.fromCharCode(symbol.codes[st.charCodeAt(j)-65]);else newst=newst+st.charAt(j);if(result[0].nodeName=="mi")
  result[0]=AMcreateElementMathML("mo").appendChild(document.createTextNode(newst));else result[0].replaceChild(AMcreateElementMathML("mo").appendChild(document.createTextNode(newst)),result[0].childNodes[i]);}}
  node=AMcreateMmlNode(symbol.tag,result[0]);node.setAttribute(symbol.atname,symbol.atval);if(symbol.input=="\\scriptstyle"||symbol.input=="\\scriptscriptstyle")
  node.setAttribute("displaystyle","false");return[node,result[1],symbol.tag];}
  case BINARY:result=AMparseSexpr(str);if(result[0]==null)return[AMcreateMmlNode("mo",document.createTextNode(symbol.input)),str,null];result2=AMparseSexpr(result[1]);if(result2[0]==null)return[AMcreateMmlNode("mo",document.createTextNode(symbol.input)),str,null];if(symbol.input=="\\textcolor"||symbol.input=="\\colorbox"){var tclr=str.match(/\{\s*([#\w]+)\s*\}/);str=str.replace(/\{\s*[#\w]+\s*\}/,"");if(tclr!=null){if(IsColorName.test(tclr[1].toLowerCase())){tclr=LaTeXColor[tclr[1].toLowerCase()];}else{tclr=tclr[1];}
  node=AMcreateElementMathML("mstyle");node.setAttribute(symbol.atval,tclr);node.appendChild(result2[0]);return[node,result2[1],symbol.tag];}}
  if(symbol.input=="\\root"||symbol.input=="\\stackrel")newFrag.appendChild(result2[0]);newFrag.appendChild(result[0]);if(symbol.input=="\\frac")newFrag.appendChild(result2[0]);return[AMcreateMmlNode(symbol.tag,newFrag),result2[1],symbol.tag];case INFIX:str=AMremoveCharsAndBlanks(str,symbol.input.length);return[AMcreateMmlNode("mo",document.createTextNode(symbol.output)),str,symbol.tag];default:return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];}}
  function AMparseIexpr(str){var symbol,sym1,sym2,node,result,tag,underover;str=AMremoveCharsAndBlanks(str,0);sym1=AMgetSymbol(str);result=AMparseSexpr(str);node=result[0];str=result[1];tag=result[2];symbol=AMgetSymbol(str);if(symbol.ttype==INFIX){str=AMremoveCharsAndBlanks(str,symbol.input.length);result=AMparseSexpr(str);if(result[0]==null)
  result[0]=AMcreateMmlNode("mo",document.createTextNode("\u25A1"));str=result[1];tag=result[2];if(symbol.input=="_"||symbol.input=="^"){sym2=AMgetSymbol(str);tag=null;underover=((sym1.ttype==UNDEROVER)||(node.ttype==UNDEROVER));if(symbol.input=="_"&&sym2.input=="^"){str=AMremoveCharsAndBlanks(str,sym2.input.length);var res2=AMparseSexpr(str);str=res2[1];tag=res2[2];node=AMcreateMmlNode((underover?"munderover":"msubsup"),node);node.appendChild(result[0]);node.appendChild(res2[0]);}else if(symbol.input=="_"){node=AMcreateMmlNode((underover?"munder":"msub"),node);node.appendChild(result[0]);}else{node=AMcreateMmlNode((underover?"mover":"msup"),node);node.appendChild(result[0]);}
  node=AMcreateMmlNode("mrow",node);}else{node=AMcreateMmlNode(symbol.tag,node);if(symbol.input=="\\atop"||symbol.input=="\\choose")
  node.setAttribute("linethickness","0ex");node.appendChild(result[0]);if(symbol.input=="\\choose")
  node=AMcreateMmlNode("mfenced",node);}}
  return[node,str,tag];}
  function AMparseExpr(str,rightbracket,matrix){var symbol,node,result,i,tag,newFrag=document.createDocumentFragment();do{str=AMremoveCharsAndBlanks(str,0);result=AMparseIexpr(str);node=result[0];str=result[1];tag=result[2];symbol=AMgetSymbol(str);if(node!=undefined){if((tag=="mn"||tag=="mi")&&symbol!=null&&typeof symbol.func=="boolean"&&symbol.func){var space=AMcreateElementMathML("mspace");space.setAttribute("width","0.167em");node=AMcreateMmlNode("mrow",node);node.appendChild(space);}
  newFrag.appendChild(node);}}while((symbol.ttype!=RIGHTBRACKET)&&symbol!=null&&symbol.output!="");tag=null;if(symbol.ttype==RIGHTBRACKET){if(symbol.input=="\\right"){str=AMremoveCharsAndBlanks(str,symbol.input.length);symbol=AMgetSymbol(str);if(symbol!=null&&symbol.input==".")
  symbol.invisible=true;if(symbol!=null)
  tag=symbol.rtag;}
  if(symbol!=null)
  str=AMremoveCharsAndBlanks(str,symbol.input.length);var len=newFrag.childNodes.length;if(matrix&&len>0&&newFrag.childNodes[len-1].nodeName=="mrow"&&len>1&&newFrag.childNodes[len-2].nodeName=="mo"&&newFrag.childNodes[len-2].firstChild.nodeValue=="&"){var pos=[];var m=newFrag.childNodes.length;for(i=0;matrix&&i<m;i=i+2){pos[i]=[];node=newFrag.childNodes[i];for(var j=0;j<node.childNodes.length;j++)
  if(node.childNodes[j].firstChild.nodeValue=="&")
  pos[i][pos[i].length]=j;}
  var row,frag,n,k,table=document.createDocumentFragment();for(i=0;i<m;i=i+2){row=document.createDocumentFragment();frag=document.createDocumentFragment();node=newFrag.firstChild;n=node.childNodes.length;k=0;for(j=0;j<n;j++){if(typeof pos[i][k]!="undefined"&&j==pos[i][k]){node.removeChild(node.firstChild);row.appendChild(AMcreateMmlNode("mtd",frag));k++;}else frag.appendChild(node.firstChild);}
  row.appendChild(AMcreateMmlNode("mtd",frag));if(newFrag.childNodes.length>2){newFrag.removeChild(newFrag.firstChild);newFrag.removeChild(newFrag.firstChild);}
  table.appendChild(AMcreateMmlNode("mtr",row));}
  return[table,str];}
  if(typeof symbol.invisible!="boolean"||!symbol.invisible){node=AMcreateMmlNode("mo",document.createTextNode(symbol.output));newFrag.appendChild(node);}}
  return[newFrag,str,tag];}
  function AMparseMath(str){var result,node=AMcreateElementMathML("mstyle");var cclr=str.match(/\\color\s*\{\s*([#\w]+)\s*\}/);str=str.replace(/\\color\s*\{\s*[#\w]+\s*\}/g,"");if(cclr!=null){if(IsColorName.test(cclr[1].toLowerCase())){cclr=LaTeXColor[cclr[1].toLowerCase()];}else{cclr=cclr[1];}
  node.setAttribute("mathcolor",cclr);}else{if(mathcolor!="")node.setAttribute("mathcolor",mathcolor);};if(mathfontfamily!="")node.setAttribute("fontfamily",mathfontfamily);node.appendChild(AMparseExpr(str.replace(/^\s+/g,""),false,false)[0]);node=AMcreateMmlNode("math",node);if(showasciiformulaonhover)
  node.setAttribute("title",str.replace(/\s+/g," "));if(false){var fnode=AMcreateElementXHTML("font");fnode.setAttribute("face",mathfontfamily);fnode.appendChild(node);return fnode;}
  return node;}
  function AMstrarr2docFrag(arr,linebreaks){var newFrag=document.createDocumentFragment();var expr=false;for(var i=0;i<arr.length;i++){if(expr)newFrag.appendChild(AMparseMath(arr[i]));else{var arri=(linebreaks?arr[i].split("\n\n"):[arr[i]]);newFrag.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(arri[0])));for(var j=1;j<arri.length;j++){newFrag.appendChild(AMcreateElementXHTML("p"));newFrag.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(arri[j])));}}
  expr=!expr;}
  return newFrag;}
  function AMprocessNodeR(n,linebreaks){var mtch,str,arr,frg,i;if(n.childNodes.length==0){if((n.nodeType!=8||linebreaks)&&n.parentNode.nodeName!="form"&&n.parentNode.nodeName!="FORM"&&n.parentNode.nodeName!="textarea"&&n.parentNode.nodeName!="TEXTAREA"&&n.parentNode.nodeName!="pre"&&n.parentNode.nodeName!="PRE"){str=n.nodeValue;if(!(str==null)){str=str.replace(/\r\n\r\n/g,"\n\n");str=str.replace(/\x20+/g," ");str=str.replace(/\s*\r\n/g," ");mtch=(str.indexOf("\$")==-1?false:true);str=str.replace(/([^\\])\$/g,"$1 \$");str=str.replace(/^\$/," \$");arr=str.split(" \$");for(i=0;i<arr.length;i++)
  arr[i]=arr[i].replace(/\\\$/g,"\$");if(arr.length>1||mtch){if(checkForMathML){checkForMathML=false;var nd=AMisMathMLavailable();AMnoMathML=nd!=null;if(AMnoMathML&&notifyIfNoMathML)
  if(alertIfNoMathML)
  alert("To view the ASCIIMathML notation use Internet Explorer 6 +\nMathPlayer (free from www.dessci.com)\nor Firefox/Mozilla/Netscape");else AMbody.insertBefore(nd,AMbody.childNodes[0]);}
  if(!AMnoMathML){frg=AMstrarr2docFrag(arr,n.nodeType==8);var len=frg.childNodes.length;n.parentNode.replaceChild(frg,n);return len-1;}else return 0;}}}else return 0;}else if(n.nodeName!="math"){for(i=0;i<n.childNodes.length;i++)
  i+=AMprocessNodeR(n.childNodes[i],linebreaks);}
  return 0;}
  function AMprocessNode(n,linebreaks,spanclassAM){var frag,st;if(spanclassAM!=null){frag=document.getElementsByTagName("span")
  for(var i=0;i<frag.length;i++)
  if(frag[i].className=="AM")
  AMprocessNodeR(frag[i],linebreaks);}else{try{st=n.innerHTML;}catch(err){}
  if(st==null||st.indexOf("\$")!=-1)
  AMprocessNodeR(n,linebreaks);}
  if(isIE){frag=document.getElementsByTagName('math');for(var i=0;i<frag.length;i++)frag[i].update()}}
  var inAppendix=false;var sectionCntr=0;var IEcommentWarning=true;var biblist=[];var bibcntr=0;var LaTeXCounter=[];LaTeXCounter["definition"]=0;LaTeXCounter["proposition"]=0;LaTeXCounter["lemma"]=0;LaTeXCounter["theorem"]=0;LaTeXCounter["corollary"]=0;LaTeXCounter["example"]=0;LaTeXCounter["exercise"]=0;LaTeXCounter["subsection"]=0;LaTeXCounter["subsubsection"]=0;LaTeXCounter["figure"]=0;LaTeXCounter["equation"]=0;LaTeXCounter["table"]=0;var LaTeXColor=[];LaTeXColor["greenyellow"]="#D9FF4F";LaTeXColor["yellow"]="#FFFF00";LaTeXColor["goldenrod"]="#FFE529";LaTeXColor["dandelion"]="#FFB529";LaTeXColor["apricot"]="#FFAD7A";LaTeXColor["peach"]="#FF804D";LaTeXColor["melon"]="#FF8A80";LaTeXColor["yelloworange"]="#FF9400";LaTeXColor["orange"]="#FF6321";LaTeXColor["burntorange"]="#FF7D00";LaTeXColor["bittersweet"]="#C20300";LaTeXColor["redorange"]="#FF3B21";LaTeXColor["mahogany"]="#A60000";LaTeXColor["maroon"]="#AD0000";LaTeXColor["brickred"]="#B80000";LaTeXColor["red"]="#FF0000";LaTeXColor["orangered"]="#FF0080";LaTeXColor["rubinered"]="#FF00DE";LaTeXColor["wildstrawberry"]="#FF0A9C";LaTeXColor["salmon"]="#FF789E";LaTeXColor["carnationpink"]="#FF5EFF";LaTeXColor["magenta"]="#FF00FF";LaTeXColor["violetred"]="#FF30FF";LaTeXColor["rhodamine"]="#FF2EFF";LaTeXColor["mulberry"]="#A314FA";LaTeXColor["redviolet"]="#9600A8";LaTeXColor["fuchsia"]="#7303EB";LaTeXColor["lavender"]="#FF85FF";LaTeXColor["thistle"]="#E069FF";LaTeXColor["orchid"]="#AD5CFF";LaTeXColor["darkorchid"]="#9933CC";LaTeXColor["purple"]="#8C24FF";LaTeXColor["plum"]="#8000FF";LaTeXColor["violet"]="#361FFF";LaTeXColor["royalpurple"]="#401AFF";LaTeXColor["blueviolet"]="#1A0DF5";LaTeXColor["periwinkle"]="#6E73FF";LaTeXColor["cadetblue"]="#616EC4";LaTeXColor["cornflowerblue"]="#59DEFF";LaTeXColor["midnightblue"]="#007091";LaTeXColor["navyblue"]="#0F75FF";LaTeXColor["royalblue"]="#0080FF";LaTeXColor["blue"]="#0000FF";LaTeXColor["cerulean"]="#0FE3FF";LaTeXColor["cyan"]="#00FFFF";LaTeXColor["processblue"]="#0AFFFF";LaTeXColor["skyblue"]="#61FFE0";LaTeXColor["turquoise"]="#26FFCC";LaTeXColor["tealblue"]="#1FFAA3";LaTeXColor["aquamarine"]="#2EFFB2";LaTeXColor["bluegreen"]="#26FFAB";LaTeXColor["emerald"]="#00FF80";LaTeXColor["junglegreen"]="#03FF7A";LaTeXColor["seagreen"]="#4FFF80";LaTeXColor["green"]="#00FF00";LaTeXColor["forestgreen"]="#00E000";LaTeXColor["pinegreen"]="#00BF29";LaTeXColor["limegreen"]="#80FF00";LaTeXColor["yellowgreen"]="#8FFF42";LaTeXColor["springgreen"]="#BDFF3D";LaTeXColor["olivegreen"]="#009900";LaTeXColor["rawsienna"]="#8C0000";LaTeXColor["sepia"]="#4D0000";LaTeXColor["brown"]="#660000";LaTeXColor["tan"]="#DB9470";LaTeXColor["gray"]="#808080";LaTeXColor["grey"]="#808080";LaTeXColor["black"]="#000000";LaTeXColor["white"]="#FFFFFF";var IsColorName=/^(?:greenyellow|yellow|goldenrod|dandelion|apricot|peach|melon|yelloworange|orange|burntorange|bittersweet|redorange|mahogany|maroon|brickred|red|orangered|rubinered|wildstrawberry|salmon|carnationpink|magenta|violetred|rhodamine|mulberry|redviolet|fuchsia|lavender|thistle|orchid|darkorchid|purple|plum|violet|royalpurple|blueviolet|periwinkle|cadetblue|cornflowerblue|midnightblue|navyblue|royalblue|blue|cerulean|cyan|processblue|skyblue|turquoise|tealblue|aquamarine|bluegreen|emerald|junglegreen|seagreen|green|forestgreen|pinegreen|limegreen|yellowgreen|springgreen|olivegreen|rawsienna|sepia|brown|tan|gray|grey|black|white)$/;var IsCounter=/^(?:definition|proposition|lemma|theorem|corollary|example|exercise|subsection|subsubsection|figure|equation|table)$/;var IsLaTeXElement=/^(?:displayequation|title|author|address|date|abstract|keyword|section|subsection|subsubsection|ref|cite|thebibliography|definition|proposition|lemma|theorem|corollary|example|exercise|itemize|enumerate|enddefinition|endproposition|endlemma|endtheorem|endcorollary|endexample|endexercise|enditemize|endenumerate|LaTeXMathMLlabel|LaTeXMathML|smallskip|medskip|bigskip|quote|quotation|endquote|endquotation|center|endcenter|description|enddescription|inlinemath)$/;var IsTextOnlyArea=/^(?:form|textarea|pre)$/i;var tableid=0;function makeNumberString(cntr){if(sectionCntr>0){if(inAppendix){return"A"+sectionCntr+"."+cntr;}else{return sectionCntr+"."+cntr;}}else{return""+cntr;}};function LaTeXpreProcess(thebody){var TheBody=thebody;if(TheBody.hasChildNodes()){if(!(IsLaTeXElement.test(TheBody.className)))
  {for(var i=0;i<TheBody.childNodes.length;i++){LaTeXpreProcess(TheBody.childNodes[i])}}}
  else{if(TheBody.nodeType==3&&!(IsTextOnlyArea.test(TheBody.parentNode.nodeName)))
  {var str=TheBody.nodeValue;if(!(str==null)){str=str.replace(/\\%/g,"<per>");str=str.replace(/%[^\n]*(?=\n)/g,"");str=str.replace(/%[^\r]*(?=\r)/g,"");str=str.replace(/%[^\n]*$/,"")
  if(isIE&&str.match(/%/g)!=null&&IEcommentWarning){alert("Comments may not have parsed properly.  Try putting in <pre class='LaTeX><div>..</div></pre> structure.");IEcommentWarning=false;}
  str=str.replace(/<per>/g,"%");if(str.match(/XXX[\s\S]*/)!=null){var tmp=str.match(/XXX[\s\S]*/)[0];var tmpstr=tmp.charCodeAt(7)+"::"+tmp.charCodeAt(8)+"::"+tmp.charCodeAt(9)+"::"+tmp.charCodeAt(10)+"::"+tmp.charCodeAt(11)+"::"+tmp.charCodeAt(12)+"::"+tmp.charCodeAt(13);alert(tmpstr);}
  str=str.replace(/([^\\])\\(\s)/g,"$1\u00A0$2");str=str.replace(/\\quad/g,"\u2001");str=str.replace(/\\qquad/g,"\u2001\u2001");str=str.replace(/\\enspace/g,"\u2002");str=str.replace(/\\;/g,"\u2004");str=str.replace(/\\:/g,"\u2005");str=str.replace(/\\,/g,"\u2006");str=str.replace(/\\thinspace/g,"\u200A");str=str.replace(/([^\\])~/g,"$1\u00A0");str=str.replace(/\\~/g,"~");str=str.replace(/\\\[/g," <DEQ> $\\displaystyle{");str=str.replace(/\\\]/g,"}$ <DEQ> ");str=str.replace(/\$\$/g,"${$<DEQ>$}$");str=str.replace(/\\begin\s*\{\s*array\s*\}/g,"\\begin{array}");str=str.replace(/\\end\s*\{\s*array\s*\}/g,"\\end{array}");str=str.replace(/\\begin\s*\{\s*eqnarray\s*\}/g,"  <DEQ>eqno$\\begin{eqnarray}");str=str.replace(/\\end\s*\{\s*eqnarray\s*\}/g,"\\end{eqnarray}$<DEQ>  ");str=str.replace(/\\begin\s*\{\s*eqnarray\*\s*\}/g,"  <DEQ>$\\begin{eqnarray}");str=str.replace(/\\end\s*\{\s*eqnarray\*\s*\}/g,"\\end{eqnarray}$<DEQ>  ");str=str.replace(/\\begin\s*\{\s*displaymath\s*\}/g," <DEQ> $\\displaystyle{");str=str.replace(/\\end\s*\{\s*displaymath\s*\}/g,"}$ <DEQ> ");str=str.replace(/\\begin\s*\{\s*equation\s*\*\s*\}/g," <DEQ> $\\displaystyle{");str=str.replace(/\\end\s*\{\s*equation\s*\*\s*\}/g,"}$ <DEQ> ");str=str.replace(/\\begin\s*\{\s*equation\s*\}/g," <DEQ>eqno$\\displaystyle{");str=str.replace(/\\end\s*\{\s*equation\s*\}/g,"}$ <DEQ> ");str=str.split("<DEQ>");var newFrag=document.createDocumentFragment();for(var i=0;i<str.length;i++){if(i%2){var DEQtable=document.createElement("table");DEQtable.className='displayequation';var DEQtbody=document.createElement("tbody");var DEQtr=document.createElement("tr");var DEQtdeq=document.createElement("td");DEQtdeq.className='eq';str[i]=str[i].replace(/\$\}\$/g,"$\\displaystyle{");str[i]=str[i].replace(/\$\{\$/g,"}");var lbl=str[i].match(/\\label\s*\{\s*(\w+)\s*\}/);var ISeqno=str[i].match(/^eqno/);str[i]=str[i].replace(/^eqno/," ");str[i]=str[i].replace(/\\label\s*\{\s*\w+\s*\}/," ");DEQtdeq.appendChild(document.createTextNode(str[i]));DEQtr.appendChild(DEQtdeq);str[i]=str[i].replace(/\\nonumber/g,"");if(ISeqno!=null||lbl!=null){var DEQtdno=document.createElement("td");DEQtdno.className='eqno';LaTeXCounter["equation"]++;var eqnoString=makeNumberString(LaTeXCounter["equation"]);var DEQanchor=document.createElement("a");if(lbl!=null){DEQanchor.id=lbl[1]};DEQanchor.className="eqno";var anchorSpan=document.createElement("span");anchorSpan.className="eqno";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(eqnoString));DEQanchor.appendChild(anchorSpan);DEQtdno.appendChild(DEQanchor);var DEQspan=document.createElement("span");DEQspan.className="eqno";DEQspan.appendChild(document.createTextNode("("+eqnoString+")"));DEQtdno.appendChild(DEQspan);DEQtr.appendChild(DEQtdno);}
  DEQtbody.appendChild(DEQtr);DEQtable.appendChild(DEQtbody);newFrag.appendChild(DEQtable);}
  else{str[i]=str[i].replace(/\$\}\$/g,"");str[i]=str[i].replace(/\$\{\$/g,"");str[i]=str[i].replace(/\\maketitle/g,"");str[i]=str[i].replace(/\\begin\s*\{\s*document\s*\}/g,"");str[i]=str[i].replace(/\\end\s*\{\s*document\s*\}/g,"");str[i]=str[i].replace(/\\documentclass[^\}]*?\}/g,"");str[i]=str[i].replace(/\\usepackage[^\}]*?\}/g,"");str[i]=str[i].replace(/\\noindent/g,"");str[i]=str[i].replace(/\\notag/g,"");str[i]=str[i].replace(/\\ref\s*\{\s*(\w+)\}/g," \\[ref\\]$1\\[ ");str[i]=str[i].replace(/\\url\s*\{\s*([^\}\n]+)\}/g," \\[url\\]$1\\[ ");str[i]=str[i].replace(/\\href\s*\{\s*([^\}]+)\}\s*\{\s*([^\}]+)\}/g," \\[href\\]$1\\]$2\\[ ");str[i]=str[i].replace(/\\cite\s*\{\s*(\w+)\}/g," \\[cite\\]$1\\[ ");str[i]=str[i].replace(/\\qed/g,"\u220E");str[i]=str[i].replace(/\\endproof/g,"\u220E");str[i]=str[i].replace(/\\proof/g,"\\textbf{Proof: }");str[i]=str[i].replace(/\\n(?=\s)/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\newline/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\linebreak/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\smallskip/g," \\[logicalbreak\\]smallskip\\[ ");str[i]=str[i].replace(/\\medskip/g," \\[logicalbreak\\]medskip\\[ ");str[i]=str[i].replace(/\\bigskip/g," \\[logicalbreak\\]bigskip\\[ ");str[i]=str[i].replace(/[\n\r]+[ \f\n\r\t\v\u2028\u2029]*[\n\r]+/g," \\[logicalbreak\\]LaTeXMathML\\[ ");if(isIE){str[i]=str[i].replace(/\r/g," ");}
  str[i]=str[i].replace(/\\bibitem\s*([^\{]*\{\s*\w*\s*\})/g," \\[bibitem\\]$1\\[ ");str[i]=str[i].replace(/\\bibitem\s*/g," \\[bibitem\\] \\[ ");str[i]=str[i].replace(/\\item\s*\[\s*(\w+)\s*\]/g," \\[alistitem\\]$1\\[ ");str[i]=str[i].replace(/\\item\s*/g," \\[alistitem\\] \\[ ");str[i]=str[i].replace(/\\appendix/g," \\[appendix\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*figure\s*\}([\s\S]+?)\\end\s*\{\s*figure\s*\}/g," \\[figure\\]$1\\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*table\s*\}([\s\S]+?)\\end\s*\{\s*table\s*\}/g," \\[table\\]$1\\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*theorem\s*\}/g," \\[theorem\\]Theorem \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*theorem\s*\}/g," \\[endtheorem\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*definition\s*\}/g," \\[definition\\]Definition \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*definition\s*\}/g," \\[enddefinition\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*lemma\s*\}/g," \\[lemma\\]Lemma \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*lemma\s*\}/g," \\[endlemma\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*corollary\s*\}/g," \\[corollary\\]Corollary \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*corollary\s*\}/g," \\[endcorollary\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*proposition\s*\}/g," \\[proposition\\]Proposition \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*proposition\s*\}/g," \\[endproposition\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*example\s*\}/g," \\[example\\]Example \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*example\s*\}/g," \\[endexample\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*exercise\s*\}/g," \\[exercise\\]Exercise \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*exercise\s*\}/g," \\[endexercise\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*thebibliography\s*\}\s*\{\s*\w+\s*\}/g," \\[thebibliography\\]References \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*thebibliography\s*\}/g," \\[thebibliography\\]References \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*thebibliography\s*\}/g," \\[endthebibliography\\]References \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*proof\s*\}/g," \\[proof\\]Proof: \\[ ");if(isIE){str[i]=str[i].replace(/\\end\s*\{\s*proof\s*\}/g,"\u220E \\[endproof\\] \\[ ");}else{str[i]=str[i].replace(/\\end\s*\{\s*proof\s*\}/g," \\[endproof\\] \\[ ");}
  str[i]=str[i].replace(/\\title\s*\{\s*([^\}]+)\}/g," \\[title\\] \\[$1 \\[endtitle\\] \\[ ");str[i]=str[i].replace(/\\author\s*\{\s*([^\}]+)\}/g," \\[author\\] \\[$1 \\[endauthor\\] \\[ ");str[i]=str[i].replace(/\\address\s*\{\s*([^\}]+)\}/g," \\[address\\] \\[$1 \\[endaddress\\] \\[ ");str[i]=str[i].replace(/\\date\s*\{\s*([^\}]+)\}/g," \\[date\\] \\[$1 \\[enddate\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*keyword\s*\}/g," \\[keyword\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*keyword\s*\}/g," \\[endkeyword\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*abstract\s*\}/g," \\[abstract\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*abstract\s*\}/g," \\[endabstract\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*(?!array|tabular)(\w+)\s*\}/g," \\[$1\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*(?!array|tabular)(\w+)\s*\}/g," \\[end$1\\] \\[ ");var sectionIndex=str[i].search(/\\section\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\section\s*\{/," \\[section\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\section\s*\{\s*[\s\S]+\}/);}
  sectionIndex=str[i].search(/\\subsection\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\subsection\s*\{/," \\[subsection\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\subsection\s*\{\s*[\s\S]+\}/);}
  sectionIndex=str[i].search(/\\subsubsection\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\subsubsection\s*\{/," \\[subsubsection\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\subsubsection\s*\{\s*[\s\S]+\}/);}
  var CatToNextEven="";var strtmp=str[i].split("\\[");for(var j=0;j<strtmp.length;j++){if(j%2){var strtmparray=strtmp[j].split("\\]");switch(strtmparray[0]){case"section":var nodeTmp=document.createElement("H2");nodeTmp.className='section';sectionCntr++;for(var div in LaTeXCounter){LaTeXCounter[div]=0};var nodeAnchor=document.createElement("a");if(inAppendix){nodeAnchor.className='appendixsection';}else{nodeAnchor.className='section';}
  var nodeNumString=makeNumberString("");var anchorSpan=document.createElement("span");anchorSpan.className="section";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='section';nodeSpan.appendChild(document.createTextNode(nodeNumString+" "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"subsection":var nodeTmp=document.createElement("H3");nodeTmp.className='subsection';LaTeXCounter["subsection"]++;LaTeXCounter["subsubsection"]=0;var nodeAnchor=document.createElement("a");nodeAnchor.className='subsection';var nodeNumString=makeNumberString(LaTeXCounter["subsection"]);var anchorSpan=document.createElement("span");anchorSpan.className="subsection";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='subsection';nodeSpan.appendChild(document.createTextNode(nodeNumString+". "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"subsubsection":var nodeTmp=document.createElement("H4");nodeTmp.className='subsubsection';LaTeXCounter["subsubsection"]++;var nodeAnchor=document.createElement("a");nodeAnchor.className='subsubsection';var nodeNumString=makeNumberString(LaTeXCounter["subsection"]+"."+LaTeXCounter["subsubsection"]);var anchorSpan=document.createElement("span");anchorSpan.className="subsubsection";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='subsubsection';nodeSpan.appendChild(document.createTextNode(nodeNumString+". "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"href":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathML';nodeTmp.href=strtmparray[1];nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"url":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathML';nodeTmp.href=strtmparray[1];nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"figure":var nodeTmp=document.createElement("table");nodeTmp.className='figure';var FIGtbody=document.createElement("tbody");var FIGlbl=strtmparray[1].match(/\\label\s*\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\\label\s*\{\w+\}/g,"");var capIndex=strtmparray[1].search(/\\caption\s*\{[\s\S]+\}/);var FIGcap="";if(capIndex>=0){var tmp=strtmparray[1];var delimcnt=0;var capstart=-1;for(var pos=capIndex;pos<tmp.length;pos++){if(tmp.charAt(pos)=="{"){delimcnt++};if(tmp.charAt(pos)=="}"){delimcnt--};if(delimcnt==1&&capstart<0){capstart=pos+1};if(delimcnt==0&&capstart>0){capend=pos-1;FIGcap=tmp.substring(capstart,pos);break}}}
  var FIGtr2=document.createElement("tr");var FIGtd2=document.createElement("td");FIGtd2.className="caption";var FIGanchor=document.createElement("a");FIGanchor.className="figure";if(FIGlbl!=null){FIGanchor.id=FIGlbl[1];}
  LaTeXCounter["figure"]++;var fignmbr=makeNumberString(LaTeXCounter["figure"]);var anchorSpan=document.createElement("span");anchorSpan.className="figure";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(fignmbr));FIGanchor.appendChild(anchorSpan);FIGtd2.appendChild(FIGanchor);var FIGspan=document.createElement("span");FIGspan.className="figure";FIGspan.appendChild(document.createTextNode("Figure "+fignmbr+". "));FIGtd2.appendChild(FIGspan);FIGtd2.appendChild(document.createTextNode(""+FIGcap));FIGtr2.appendChild(FIGtd2);FIGtbody.appendChild(FIGtr2);var IsSpecial=false;var FIGinfo=strtmparray[1].match(/\\includegraphics\s*\{([^\}]+)\}/);if(FIGinfo==null){FIGinfo=strtmparray[1].match(/\\includegraphics\s*\[[^\]]*\]\s*\{\s*([^\}]+)\s*\}/);}
  if(FIGinfo==null){FIGinfo=strtmparray[1].match(/\\special\s*\{\s*([^\}]+)\}/);IsSpecial=true};if(FIGinfo!=null){var FIGtr1=document.createElement("tr");var FIGtd1=document.createElement("td");FIGtd1.className="image";var FIGimg=document.createElement("img");var FIGsrc=FIGinfo[1];FIGimg.src=FIGsrc;FIGimg.alt="Figure "+FIGsrc+" did not load";FIGimg.title="Figure "+fignmbr+". "+FIGcap;FIGimg.id="figure"+fignmbr;FIGtd1.appendChild(FIGimg);FIGtr1.appendChild(FIGtd1);FIGtbody.appendChild(FIGtr1);}
  nodeTmp.appendChild(FIGtbody);newFrag.appendChild(nodeTmp);break;case"table":var nodeTmp=document.createElement("table");if(strtmparray[1].search(/\\centering/)>=0){nodeTmp.className='LaTeXtable centered';nodeTmp.align="center";}else{nodeTmp.className='LaTeXtable';};tableid++;nodeTmp.id="LaTeXtable"+tableid;var TABlbl=strtmparray[1].match(/\\label\s*\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\\label\s*\{\w+\}/g,"");var capIndex=strtmparray[1].search(/\\caption\s*\{[\s\S]+\}/);var TABcap="";if(capIndex>=0){var tmp=strtmparray[1];var delimcnt=0;var capstart=-1;for(var pos=capIndex;pos<tmp.length;pos++){if(tmp.charAt(pos)=="{"){delimcnt++};if(tmp.charAt(pos)=="}"){delimcnt--};if(delimcnt==1&&capstart<0){capstart=pos+1};if(delimcnt==0&&capstart>0){capend=pos-1;TABcap=tmp.substring(capstart,pos);break}}}
  if(TABcap!=""){var TABtbody=document.createElement("tbody");var TABcaption=document.createElement("caption");TABcaption.className="LaTeXtable centered";var TABanchor=document.createElement("a");TABanchor.className="LaTeXtable";if(TABlbl!=null){TABanchor.id=TABlbl[1];}
  LaTeXCounter["table"]++;var tabnmbr=makeNumberString(LaTeXCounter["table"]);var anchorSpan=document.createElement("span");anchorSpan.className="LaTeXtable";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(tabnmbr));TABanchor.appendChild(anchorSpan);TABcaption.appendChild(TABanchor);var TABspan=document.createElement("span");TABspan.className="LaTeXtable";TABspan.appendChild(document.createTextNode("Table "+tabnmbr+". "));TABcaption.appendChild(TABspan);TABcaption.appendChild(document.createTextNode(""+TABcap));nodeTmp.appendChild(TABcaption);}
  var TABinfo=strtmparray[1].match(/\\begin\s*\{\s*tabular\s*\}([\s\S]+)\\end\s*\{\s*tabular\s*\}/);if(TABinfo!=null){var TABtbody=document.createElement('tbody');var TABrow=null;var TABcell=null;var row=0;var col=0;var TABalign=TABinfo[1].match(/^\s*\{([^\}]+)\}/);TABinfo=TABinfo[1].replace(/^\s*\{[^\}]+\}/,"");TABinfo=TABinfo.replace(/\\hline/g,"");TABalign[1]=TABalign[1].replace(/\|/g,"");TABalign[1]=TABalign[1].replace(/\s/g,"");TABinfo=TABinfo.split("\\\\");for(row=0;row<TABinfo.length;row++){TABrow=document.createElement("tr");TABinfo[row]=TABinfo[row].split("&");for(col=0;col<TABinfo[row].length;col++){TABcell=document.createElement("td");switch(TABalign[1].charAt(col)){case"l":TABcell.align="left";break;case"c":TABcell.align="center";break;case"r":TABcell.align="right";break;default:TABcell.align="left";};TABcell.appendChild(document.createTextNode(TABinfo[row][col]));TABrow.appendChild(TABcell);}
  TABtbody.appendChild(TABrow);}
  nodeTmp.appendChild(TABtbody);}
  newFrag.appendChild(nodeTmp);break;case"logicalbreak":var nodeTmp=document.createElement("p");nodeTmp.className=strtmparray[1];nodeTmp.appendChild(document.createTextNode("\u00A0"));newFrag.appendChild(nodeTmp);break;case"appendix":inAppendix=true;sectionCntr=0;break;case"alistitem":var EndDiv=document.createElement("div");EndDiv.className="endlistitem";newFrag.appendChild(EndDiv);var BegDiv=document.createElement("div");BegDiv.className="listitem";if(strtmparray[1]!=" "){var BegSpan=document.createElement("span");BegSpan.className="listitemmarker";var boldBegSpan=document.createElement("b");boldBegSpan.appendChild(document.createTextNode(strtmparray[1]+" "));BegSpan.appendChild(boldBegSpan);BegDiv.appendChild(BegSpan);}
  newFrag.appendChild(BegDiv);break;case"br":newFrag.appendChild(document.createElement("br"));break;case"bibitem":newFrag.appendChild(document.createElement("br"));var nodeTmp=document.createElement("a");nodeTmp.className='bibitem';var nodeSpan=document.createElement("span");nodeSpan.className='bibitem';bibcntr++;var lbl=strtmparray[1].match(/\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\s*\{\s*\w+\s*\}/g,"");strtmparray[1]=strtmparray[1].replace(/^\s*\[/,"");strtmparray[1]=strtmparray[1].replace(/\s*\]$/,"");strtmparray[1]=strtmparray[1].replace(/^\s+|\s+$/g,"");if(lbl==null){biblist[bibcntr]="bibitem"+bibcntr}else{biblist[bibcntr]=lbl[1];};nodeTmp.name=biblist[bibcntr];nodeTmp.id=biblist[bibcntr];if(strtmparray[1]!=""){nodeSpan.appendChild(document.createTextNode(strtmparray[1]));}else{nodeSpan.appendChild(document.createTextNode("["+bibcntr+"]"));}
  nodeTmp.appendChild(nodeSpan);newFrag.appendChild(nodeTmp);break;case"cite":var nodeTmp=document.createElement("a");nodeTmp.className='cite';nodeTmp.name='cite';nodeTmp.href="#"+strtmparray[1];newFrag.appendChild(nodeTmp);break;case"ref":var nodeTmp=document.createElement("a");nodeTmp.className='ref';nodeTmp.name='ref';nodeTmp.href="#"+strtmparray[1];newFrag.appendChild(nodeTmp);break;default:var nodeTmp=document.createElement("div");nodeTmp.className=strtmparray[0];if(IsCounter.test(strtmparray[0])){LaTeXCounter[strtmparray[0]]++;var nodeAnchor=document.createElement("a");nodeAnchor.className=strtmparray[0];var divnum=makeNumberString(LaTeXCounter[strtmparray[0]]);var anchorSpan=document.createElement("span");anchorSpan.className=strtmparray[0];anchorSpan.appendChild(document.createTextNode(divnum));anchorSpan.style.display="none";nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className=strtmparray[0];nodeSpan.appendChild(document.createTextNode(strtmparray[1]+" "+divnum+". "));nodeTmp.appendChild(nodeSpan);}
  if(isIE){if(strtmparray[0]==("thebibliography"||"abstract"||"keyword"||"proof")){var nodeSpan=document.createElement("span");nodeSpan.className=strtmparray[0];nodeSpan.appendChild(document.createTextNode(strtmparray[1]));nodeTmp.appendChild(nodeSpan);}}
  if(strtmparray[0]=="endenumerate"||strtmparray[0]=="enditemize"||strtmparray[0]=="enddescription"){var endDiv=document.createElement("div");endDiv.className="endlistitem";newFrag.appendChild(endDiv);}
  newFrag.appendChild(nodeTmp);if(strtmparray[0]=="enumerate"||strtmparray[0]=="itemize"||strtmparray[0]=="description"){var endDiv=document.createElement("div");endDiv.className="listitem";newFrag.appendChild(endDiv);}}}else{strtmp[j]=strtmp[j].replace(/\\\$/g,"<per>");strtmp[j]=strtmp[j].replace(/\$([^\$]+)\$/g," \\[$1\\[ ");strtmp[j]=strtmp[j].replace(/<per>/g,"\\$");strtmp[j]=strtmp[j].replace(/\\begin\s*\{\s*math\s*\}([\s\S]+?)\\end\s*\{\s*math\s*\}/g," \\[$1\\[ ");var strtmptmp=strtmp[j].split("\\[");for(var jjj=0;jjj<strtmptmp.length;jjj++){if(jjj%2){var nodeTmp=document.createElement("span");nodeTmp.className='inlinemath';nodeTmp.appendChild(document.createTextNode("$"+strtmptmp[jjj]+"$"));newFrag.appendChild(nodeTmp);}else{var TagIndex=strtmptmp[jjj].search(/\\\w+/);var tmpIndex=TagIndex;while(tmpIndex>-1){if(/^\\textcolor/.test(strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length))){strtmptmp[jjj]=strtmptmp[jjj].replace(/\\textcolor\s*\{\s*(\w+)\s*\}\s*/," \\[textcolor\\]$1\\]|");}else{if(/^\\colorbox/.test(strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length))){strtmptmp[jjj]=strtmptmp[jjj].replace(/\\colorbox\s*\{\s*(\w+)\s*\}\s*/," \\[colorbox\\]$1\\]|");}else{strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).replace(/\\\s*(\w+)\s*/," \\[$1\\]|");}}
  TagIndex+=strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).search(/\|/);TagIndex++;strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\]\|/,"\\] ");if(strtmptmp[jjj].charAt(TagIndex)=="{"){strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+strtmptmp[jjj].substring(TagIndex+1,strtmptmp[jjj].length);var delimcnt=1;for(var kk=TagIndex;kk<strtmptmp[jjj].length;kk++){if(strtmptmp[jjj].charAt(kk)=="{"){delimcnt++};if(strtmptmp[jjj].charAt(kk)=="}"){delimcnt--};if(delimcnt==0){break;}}
  strtmptmp[jjj]=strtmptmp[jjj].substring(0,kk)+"\\[ "+strtmptmp[jjj].substring(kk+1,strtmptmp[jjj].length);TagIndex=kk+3;}else{strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+"\\[ "+strtmptmp[jjj].substring(TagIndex+1,strtmptmp[jjj].length);TagIndex=TagIndex+3;}
  if(TagIndex<strtmptmp[jjj].length){tmpIndex=strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).search(/\\\w+/);}
  else{tmpIndex=-1};TagIndex+=tmpIndex;}
  strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\\\s*\\\\/g,"\\\\");strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\\/g," \\[br\\] \\[ ");strtmptmp[jjj]=strtmptmp[jjj].replace(/\\label\s*\{\s*(\w+)\s*\}/g," \\[a\\]$1\\[ ");var strlbls=strtmptmp[jjj].split("\\[");for(var jj=0;jj<strlbls.length;jj++){if(jj%2){var strtmparray=strlbls[jj].split("\\]");switch(strtmparray[0]){case"textcolor":var nodeTmp=document.createElement("span");nodeTmp.className='LaTeXColor';if(IsColorName.test(strtmparray[1].toLowerCase())){nodeTmp.style.color=LaTeXColor[strtmparray[1].toLowerCase()];}else{nodeTmp.style.color=strtmparray[1];};nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"colorbox":var nodeTmp=document.createElement("span");nodeTmp.className='LaTeXColor';if(IsColorName.test(strtmparray[1].toLowerCase())){nodeTmp.style.background=LaTeXColor[strtmparray[1].toLowerCase()];}else{nodeTmp.style.background=strtmparray[1];};nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"br":newFrag.appendChild(document.createElement("br"));break;case"a":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathMLlabel';nodeTmp.id=strtmparray[1];nodeTmp.style.display="none";newFrag.appendChild(nodeTmp);break;default:var nodeTmp=document.createElement("span");nodeTmp.className=strtmparray[0];nodeTmp.appendChild(document.createTextNode(strtmparray[1]))
  newFrag.appendChild(nodeTmp);}}else{newFrag.appendChild(document.createTextNode(strlbls[jj]));}}}}}}}};TheBody.parentNode.replaceChild(newFrag,TheBody);}}}
  return TheBody;}
  function LaTeXDivsAndRefs(thebody){var TheBody=thebody;var EndDivClass=null;var AllDivs=TheBody.getElementsByTagName("div");var lbl2id="";var lblnode=null;for(var i=AllDivs.length-1;i>=0;i--){EndDivClass=AllDivs[i].className.match(/end\w+/);if(EndDivClass!=null){EndDivClass=EndDivClass[0];var DivClass=EndDivClass.substring(3,EndDivClass.length);var EndDivNode=AllDivs[i];break;}}
  while(EndDivClass!=null){var newFrag=document.createDocumentFragment();var RootNode=EndDivNode.parentNode;var ClassCount=1;while(EndDivNode.previousSibling!=null&&ClassCount>0){switch(EndDivNode.previousSibling.className){case EndDivClass:ClassCount++;newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);break;case DivClass:if(EndDivNode.previousSibling.nodeName=="DIV"){ClassCount--;if(lbl2id!=""){EndDivNode.previousSibling.id=lbl2id;lbl2id=""}
  if(ClassCount==0){RootNode=EndDivNode.previousSibling;}else{newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);}};break;case'LaTeXMathMLlabel':lbl2id=EndDivNode.previousSibling.id;EndDivNode.parentNode.removeChild(EndDivNode.previousSibling);break;default:newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);}}
  RootNode.appendChild(newFrag);EndDivNode.parentNode.removeChild(EndDivNode);AllDivs=TheBody.getElementsByTagName("DIV");for(i=AllDivs.length-1;i>=0;i--){EndDivClass=AllDivs[i].className.match(/end\w+/);if(EndDivClass!=null){ClassCount=0;EndDivClass=EndDivClass[0];DivClass=EndDivClass.substring(3,EndDivClass.length);EndDivNode=AllDivs[i];RootNode=EndDivNode.parentNode;break;}}}
  var AllDivs=TheBody.getElementsByTagName("div");var DIV2LI=null;for(var i=0;i<AllDivs.length;i++){if(AllDivs[i].className=="itemize"||AllDivs[i].className=="enumerate"||AllDivs[i].className=="description"){if(AllDivs[i].className=="itemize"){RootNode=document.createElement("UL");}else{RootNode=document.createElement("OL");}
  RootNode.className='LaTeXMathML';if(AllDivs[i].hasChildNodes()){AllDivs[i].removeChild(AllDivs[i].firstChild)};while(AllDivs[i].hasChildNodes()){if(AllDivs[i].firstChild.hasChildNodes()){DIV2LI=document.createElement("LI");while(AllDivs[i].firstChild.hasChildNodes()){DIV2LI.appendChild(AllDivs[i].firstChild.firstChild);}
  if(DIV2LI.firstChild.className=="listitemmarker"){DIV2LI.style.listStyleType="none";}
  RootNode.appendChild(DIV2LI)}
  AllDivs[i].removeChild(AllDivs[i].firstChild);}
  AllDivs[i].appendChild(RootNode);}}
  var AllAnchors=TheBody.getElementsByTagName("a");for(var i=0;i<AllAnchors.length;i++){if(AllAnchors[i].className=="ref"||AllAnchors[i].className=="cite"){var label=AllAnchors[i].href.match(/\#(\w+)/);if(label!=null){var labelNode=document.getElementById(label[1]);if(labelNode!=null){var TheSpans=labelNode.getElementsByTagName("SPAN");if(TheSpans!=null){var refNode=TheSpans[0].cloneNode(true);refNode.style.display="inline"
  refNode.className=AllAnchors[i].className;AllAnchors[i].appendChild(refNode);}}}}}
  return TheBody;}
  var AMbody;var AMnoMathML=false,AMtranslated=false;function translate(spanclassAM){if(!AMtranslated){AMtranslated=true;AMinitSymbols();var LaTeXContainers=[];var AllContainers=document.getElementsByTagName('*');var ExtendName="";for(var k=0,l=0;k<AllContainers.length;k++){ExtendName=" "+AllContainers[k].className+" ";if(ExtendName.match(/\sLaTeX\s/)!=null){LaTeXContainers[l]=AllContainers[k];l++;}};if(LaTeXContainers.length>0){for(var m=0;m<LaTeXContainers.length;m++){AMbody=LaTeXContainers[m];try{AMbody=LaTeXDivsAndRefs(LaTeXpreProcess(AMbody));}catch(err){alert("Unknown Error: Defaulting to Original LaTeXMathML");}
  if(AMbody.tagName=="PRE"){var PreChilds=document.createDocumentFragment();var DivChilds=document.createElement("DIV");while(AMbody.hasChildNodes()){DivChilds.appendChild(AMbody.firstChild);}
  PreChilds.appendChild(DivChilds);AMbody.parentNode.replaceChild(PreChilds,AMbody);AMbody=DivChilds;}
  AMprocessNode(AMbody,false,spanclassAM);}}else{AMbody=document.getElementsByTagName("body")[0];try{AMbody=LaTeXDivsAndRefs(LaTeXpreProcess(AMbody));}catch(err){alert("Unknown Error: Defaulting to Original LaTeXMathML");}
  AMprocessNode(AMbody,false,spanclassAM);}}}
  if(isIE){document.write("<object id=\"mathplayer\" classid=\"clsid:32F66A20-7614-11D4-BD11-00104BD3F987\"></object>");document.write("<?import namespace=\"m\" implementation=\"#mathplayer\"?>");}
  function generic()
  {translate();};if(typeof window.addEventListener!='undefined')
  {window.addEventListener('load',generic,false);}
  else if(typeof document.addEventListener!='undefined')
  {document.addEventListener('load',generic,false);}
  else if(typeof window.attachEvent!='undefined')
  {window.attachEvent('onload',generic);}
  else
  {if(typeof window.onload=='function')
  {var existing=onload;window.onload=function()
  {existing();generic();};}
  else
  {window.onload=generic;}}
  /*]]>*/
  </script>
  <!-- Material Design Icons Extension -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css" media="all" rel="stylesheet" type="text/css">
  
  <!-- Material Design Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
   <!-- Materialize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css">
  <style>
  
  /* Move content so that side-nav doesn't hide it */
  header, main, footer {
    padding-left: 320px; 
  }
  
  @media only screen and (max-width : 992px) {
    header, main, footer {
      padding-left: 0;
    }
  }
  
  @media print {    
  	header, main, footer {
    	padding-left: 0;
    }
  	.side-nav {
  		display: none;
  	}
  	.container {
  		width: 100%;
  	}
  }
  
  .side-nav {
    width: 320px;
    border-top: none;
  }
  
  /* Containers a bit larger than default 70% */
  .container {
    width: 75%;
  }
  
  /* Make nested collapsibles look nice in side-nav */
  .side-nav .collapsible-body {
    padding: 0;
  }
  
  /* Make images' width be slightly smaller than text */
  main .figure {
    width: 90%;
    margin: 0 auto;
  }
  
  main img {
    width: 100%;
  }
  
  /* Make text look prettier */
  p {
    text-align: justify;
  }
  
  /* Make anchors to titles look better by changing margin-top to padding-top */
  /* Reduce title fonts by ~35% each to look less jarring */
  main h1 { margin-top: 0; padding-top: 2.10rem; font-size: 40px; }
  main h2 { margin-top: 0; padding-top: 1.78rem; font-size: 32px; } 
  main h3 { margin-top: 0; padding-top: 1.46rem; font-size: 28px; }
  main h4 { font-size: 22px; }
  
  
  /* Make avatar better */
  .side-nav img.logo, .side-nav img.circle.avatar {
    height: 100px;
    width: 100px;
  }
  
  .side-nav img.logo, .side-nav img.circle.avatar ~ img.circle.avatar {
    margin-right: 32px;
  }
  
  .side-nav a.inline {
    display: inline-block;
  }
  
  
  /* Bottom divider */
  .divider.bottom {
    margin: 0 0 8px 0;
  }
  
  /* Fix navbar collapsible elements padding */
  #TOC > ul > li > a { padding-left: 32px; }
  #TOC > ul > li > ul > li > a { padding-left: 48px; }
  #TOC > ul > li > ul > li > ul li a { padding-left: 64px; }
  
  h1.title {
   text-align: center;
   font-size: 48px;
  }
  
  ul.side-nav li a.title {
    font-weight: 900;
    font-size: 16px;
  }
  
  /* Main title */
  h1.title.first {
    font-size: 44px;
    margin-bottom: 0;
  }
  
  h1.title.second {
    font-size: 36px;
    font-style: italic;
    padding-top: 0;
  }
  
  /* Contaxt icons in the sidebar */
  .userView a.inline-icon {
    display: inline-block;
    height: auto;
    padding: 0;
    margin-left: 16px;
  }
  
  .userView a.inline-icon i {
    font-size: 16px;
    vertical-align: text-bottom;
  }
  
  /* Fix margin of section numbers */
  .toc-section-number {
    margin-right: 8px;
  }
  
  </style>
</head>
<body>
<main>
<div class="container">
<div id="TOC">
<ul>
<li><a href="#abstract">Abstract</a></li>
<li><a href="#acronyms-terminology">Acronyms &amp; Terminology</a></li>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#background-motivation"><span class="toc-section-number">1.1</span> Background &amp; motivation</a><ul>
<li><a href="#ecosystem-services"><span class="toc-section-number">1.1.1</span> Ecosystem services</a></li>
<li><a href="#natural-capital-assessments"><span class="toc-section-number">1.1.2</span> Natural capital assessments</a></li>
<li><a href="#communicating-natural-capital-information"><span class="toc-section-number">1.1.3</span> Communicating natural capital information</a></li>
</ul></li>
<li><a href="#the-natural-capital-project"><span class="toc-section-number">1.2</span> The Natural Capital Project</a></li>
<li><a href="#objectives"><span class="toc-section-number">1.3</span> Objectives</a></li>
<li><a href="#outline"><span class="toc-section-number">1.4</span> Outline</a></li>
</ul></li>
<li><a href="#method"><span class="toc-section-number">2</span> Method</a><ul>
<li><a href="#project-definition-and-scoping"><span class="toc-section-number">2.1</span> Project definition and scoping</a></li>
<li><a href="#background-and-context"><span class="toc-section-number">2.2</span> Background and context</a><ul>
<li><a href="#literature-review"><span class="toc-section-number">2.2.1</span> Literature review</a></li>
<li><a href="#tools-market-study"><span class="toc-section-number">2.2.2</span> Tools market study</a></li>
</ul></li>
<li><a href="#sec:survey"><span class="toc-section-number">2.3</span> Identification and prioritization of display needs</a></li>
<li><a href="#use-cases"><span class="toc-section-number">2.4</span> Use Cases</a><ul>
<li><a href="#prioritization-of-native-forest-restoration-in-puu-waawaa-hawaii"><span class="toc-section-number">2.4.1</span> Prioritization of native forest restoration in Pu‘u Wa‘awa‘a, Hawai‘i</a></li>
<li><a href="#sec:tanacase"><span class="toc-section-number">2.4.2</span> The Upper Tana Nairobi Water Fund</a></li>
</ul></li>
<li><a href="#display-toolbox"><span class="toc-section-number">2.5</span> Display toolbox</a><ul>
<li><a href="#structure"><span class="toc-section-number">2.5.1</span> Structure</a></li>
<li><a href="#sec:criterion"><span class="toc-section-number">2.5.2</span> Suggested solutions</a></li>
</ul></li>
<li><a href="#development-of-a-web-application"><span class="toc-section-number">2.6</span> Development of a web application</a></li>
<li><a href="#master-thesis-workflow"><span class="toc-section-number">2.7</span> Master thesis workflow</a></li>
</ul></li>
<li><a href="#sec:elements"><span class="toc-section-number">3</span> Elements of data visualization</a><ul>
<li><a href="#notions-and-techniques-in-data-visualization"><span class="toc-section-number">3.1</span> Notions and techniques in data visualization</a><ul>
<li><a href="#sec:graphintegrity"><span class="toc-section-number">3.1.1</span> Information visualization and graphical integrity</a></li>
<li><a href="#vocabulary-and-grammar-of-graphics"><span class="toc-section-number">3.1.2</span> Vocabulary and grammar of graphics</a></li>
<li><a href="#modes-of-visualization"><span class="toc-section-number">3.1.3</span> Modes of visualization</a></li>
<li><a href="#sec:disto"><span class="toc-section-number">3.1.4</span> Distortion techniques</a></li>
<li><a href="#sec:interactivefeatures"><span class="toc-section-number">3.1.5</span> Interaction techniques</a></li>
</ul></li>
<li><a href="#sec:colors"><span class="toc-section-number">3.2</span> Graphical best practices and guidelines</a><ul>
<li><a href="#legibility-and-intuitivity"><span class="toc-section-number">3.2.1</span> Legibility and intuitivity</a></li>
<li><a href="#scale-and-ratios"><span class="toc-section-number">3.2.2</span> Scale and ratios</a></li>
<li><a href="#legend"><span class="toc-section-number">3.2.3</span> Legend</a></li>
<li><a href="#colorscheme"><span class="toc-section-number">3.2.4</span> Colorscheme</a></li>
<li><a href="#interactivity"><span class="toc-section-number">3.2.5</span> Interactivity</a></li>
</ul></li>
<li><a href="#overview-of-visualization-tools"><span class="toc-section-number">3.3</span> Overview of visualization tools</a><ul>
<li><a href="#data-analysis-and-visualization-softwares"><span class="toc-section-number">3.3.1</span> Data analysis and visualization softwares</a></li>
<li><a href="#charting-libraries"><span class="toc-section-number">3.3.2</span> Charting libraries</a></li>
</ul></li>
</ul></li>
<li><a href="#sec:UserGuide"><span class="toc-section-number">4</span> Design strategies to display natural capital information</a><ul>
<li><a href="#specific-data-visualization-challenges"><span class="toc-section-number">4.1</span> Specific data visualization challenges</a><ul>
<li><a href="#analysis-of-the-display-needs"><span class="toc-section-number">4.1.1</span> Analysis of the display needs</a></li>
<li><a href="#how-to-read-this-chapter"><span class="toc-section-number">4.1.2</span> How to read this chapter</a></li>
</ul></li>
<li><a href="#multi-dimensional-data"><span class="toc-section-number">4.2</span> Multi-dimensional data</a><ul>
<li><a href="#sec:scatterplots"><span class="toc-section-number">4.2.1</span> Scatterplots</a></li>
<li><a href="#sec:timeseries"><span class="toc-section-number">4.2.2</span> Time-series data: line charts, streamgraphs and more</a></li>
<li><a href="#sec:parcoords"><span class="toc-section-number">4.2.3</span> Parallel coordinates plot</a></li>
<li><a href="#sec:radar"><span class="toc-section-number">4.2.4</span> Radar charts</a></li>
<li><a href="#sec:smallmultiples"><span class="toc-section-number">4.2.5</span> Small Multiples</a></li>
<li><a href="#other-displays"><span class="toc-section-number">4.2.6</span> Other displays</a></li>
<li><a href="#sec:rdim"><span class="toc-section-number">4.2.7</span> Reduce dimensions</a></li>
<li><a href="#sec:multiplelinked"><span class="toc-section-number">4.2.8</span> Multiple linked views</a></li>
</ul></li>
<li><a href="#spatial-data"><span class="toc-section-number">4.3</span> Spatial data</a><ul>
<li><a href="#general-classification-of-maps"><span class="toc-section-number">4.3.1</span> General classification of maps</a></li>
<li><a href="#sec:twowidely"><span class="toc-section-number">4.3.2</span> Two widely used ES maps</a></li>
<li><a href="#sec:hotspot"><span class="toc-section-number">4.3.3</span> Spatial visualization of tradeoffs</a></li>
<li><a href="#sec:beneficiaries"><span class="toc-section-number">4.3.4</span> Relationship between variables</a></li>
</ul></li>
<li><a href="#sec:compare"><span class="toc-section-number">4.4</span> Comparison of multiple spatial runs</a><ul>
<li><a href="#sec:comp_map"><span class="toc-section-number">4.4.1</span> Maps displays</a></li>
<li><a href="#sec:metricsmultrunscat"><span class="toc-section-number">4.4.2</span> Aspatial metrics to summarize results and agreements of categorical maps</a></li>
<li><a href="#sec:metricsmultrunscont"><span class="toc-section-number">4.4.3</span> Aspatial metrics to summarize results and agreements of continuous maps</a></li>
<li><a href="#sec:scale"><span class="toc-section-number">4.4.4</span> Influence of scale in map comparison</a></li>
</ul></li>
<li><a href="#sec:uncertainty"><span class="toc-section-number">4.5</span> Uncertainty</a><ul>
<li><a href="#introduction-to-uncertainty-sensitivity-analysis-visualization"><span class="toc-section-number">4.5.1</span> Introduction to uncertainty &amp; sensitivity analysis visualization</a></li>
<li><a href="#sec:uncert_aspat"><span class="toc-section-number">4.5.2</span> Non-spatial data uncertainty displays</a></li>
<li><a href="#sec:uncert_non_maps"><span class="toc-section-number">4.5.3</span> Spatial data uncertainty metrics</a></li>
<li><a href="#sec:uncert_maps"><span class="toc-section-number">4.5.4</span> Spatial data uncertainty map displays</a></li>
<li><a href="#sec:SA"><span class="toc-section-number">4.5.5</span> Parametric uncertainty: sensitivity analysis displays</a></li>
</ul></li>
<li><a href="#summary"><span class="toc-section-number">4.6</span> Summary</a><ul>
<li><a href="#key-take-aways"><span class="toc-section-number">4.6.1</span> Key take-aways</a></li>
<li><a href="#resources"><span class="toc-section-number">4.6.2</span> Resources</a></li>
<li><a href="#sec:table"><span class="toc-section-number">4.6.3</span> Summary table for specific display needs</a></li>
</ul></li>
</ul></li>
<li><a href="#sec:TheTool"><span class="toc-section-number">5</span> An innovative tool to display natural capital results</a><ul>
<li><a href="#sec:survey_results"><span class="toc-section-number">5.1</span> Motivation and analysis of the need</a><ul>
<li><a href="#survey-results-quantitative-prioritization-of-display-needs"><span class="toc-section-number">5.1.1</span> Survey results: quantitative prioritization of display needs</a></li>
<li><a href="#survey-results-qualitative-analysis-of-comments-and-interviews"><span class="toc-section-number">5.1.2</span> Survey results: Qualitative analysis of comments and interviews</a></li>
<li><a href="#summary-of-the-need-design-question"><span class="toc-section-number">5.1.3</span> Summary of the need: design question</a></li>
</ul></li>
<li><a href="#design"><span class="toc-section-number">5.2</span> Design</a><ul>
<li><a href="#goal"><span class="toc-section-number">5.2.1</span> Goal</a></li>
<li><a href="#use-case-and-design-process"><span class="toc-section-number">5.2.2</span> Use case and design process</a></li>
<li><a href="#tour-of-the-dashboard-and-main-features"><span class="toc-section-number">5.2.3</span> Tour of the dashboard and main features</a></li>
</ul></li>
<li><a href="#implementation"><span class="toc-section-number">5.3</span> Implementation</a><ul>
<li><a href="#tools-and-technology"><span class="toc-section-number">5.3.1</span> Tools and technology</a></li>
<li><a href="#workflow"><span class="toc-section-number">5.3.2</span> Workflow</a></li>
</ul></li>
<li><a href="#sec:fidback"><span class="toc-section-number">5.4</span> Results: prototype, testing, iterations and feedback</a></li>
<li><a href="#sec:nextstepswebapp"><span class="toc-section-number">5.5</span> Next steps</a><ul>
<li><a href="#features-in-alpha-version-remaining-to-be-implemented"><span class="toc-section-number">5.5.1</span> Features in alpha version remaining to be implemented</a></li>
<li><a href="#additonal-features"><span class="toc-section-number">5.5.2</span> Additonal features</a></li>
<li><a href="#design-improvements"><span class="toc-section-number">5.5.3</span> Design improvements</a></li>
<li><a href="#scaling-up"><span class="toc-section-number">5.5.4</span> Scaling up</a></li>
<li><a href="#building-a-generic-tool"><span class="toc-section-number">5.5.5</span> Building a generic tool</a></li>
</ul></li>
</ul></li>
<li><a href="#conclusion-next-steps"><span class="toc-section-number">6</span> Conclusion &amp; Next Steps</a><ul>
<li><a href="#summary-1"><span class="toc-section-number">6.1</span> Summary</a></li>
<li><a href="#concluding-remarks-about-the-display-toolbox-on-standardizing-approaches-to-communicate-natural-capital-results"><span class="toc-section-number">6.2</span> Concluding remarks about the display toolbox: on standardizing approaches to communicate natural capital results</a><ul>
<li><a href="#open-questions-and-identified-areas-of-improvement">Open questions and identified areas of improvement</a></li>
</ul></li>
<li><a href="#concluding-remarks-about-developped-web-application-prototype-and-next-steps"><span class="toc-section-number">6.3</span> Concluding remarks about developped web application prototype and next steps</a></li>
<li><a href="#suggestions-for-the-natural-capital-project"><span class="toc-section-number">6.4</span> Suggestions for the Natural Capital Project</a></li>
<li><a href="#natural-capital-sustainable-management-great-potential-for-impact"><span class="toc-section-number">6.5</span> Natural capital sustainable management: great potential for impact</a></li>
<li><a href="#engaging-a-broader-audience-into-major-decisions"><span class="toc-section-number">6.6</span> Engaging a broader audience into major decisions</a></li>
</ul></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#appendices">Appendices</a></li>
<li><a href="#bibliography">Bibliography</a></li>
</ul>
</div>
<h1 id="abstract" class="unnumbered">Abstract</h1>
<p><strong>EN</strong>: In order to develop approaches to manage environmental assets sustainably and take nature more into account in major decisions, natural capital assessments reveal the specific benefits provided by nature. Effective communication of their results, including clear visualization, is crucial for supporting decision-makers. However, no practical guidance exists to support analysts in synthesizing their results, and visualization tools are scattered. The present work adresses this gap, <em>aiming to facilitate understanding and spread of natural capital assessments, hoping to increase engagement in a field with large opportunities to impact.</em></p>
<p>First, we gather the existing (<em>state-of-the-art?</em>) knowledge on design strategies for displaying complex information through a literature review and surveying analysts in the field. Complex information refers here to the specificities of natural capital data, i.e typically large numbers of maps and aspatial statistics that result from considering multiple objectives, scenarios, and uncertainties.</p>
<p>Secondly, this work scopes the gaps in the field by analyzing and prioritizing the visualization needs, through a survey and interviews. These lead to the development of a toolbox to guide analysts in their task of communicating natural capital information. Furthermore, an innovative tool to display natural capital results, merging knowledge from previous points in the form of a user-friendly, ready-to-use (prototype of a) web application is suggested. In an interactive dashboard combining multiple linked views, this tool allows visualization of tradeoffs between objectives, comparison of scenarios and assessment of uncertainty.<br />
<br />
<strong>FR:</strong> Afin de mieux prendre en compte l’impact de nos choix collectifs sur l’environnement et de développer des méthodes de gestion durable des ressources, on cherche à attribuer au patrimoine naturel une valeur qui traduise les bénéfices que celui-ci procure. Ces analyses du capital naturel produisent des informations complexes et multidimensionnelles reflétant la multiplicité et complexité des services écosystémiques. Afin que les décideurs puissent s’approprier ces résultats, il est important de les communiquer sous une forme facile à appréhender, notamment grâce à des représentations graphiques. Cependant, il n’existe pas à ce jour de d’usages établis pour synthétiser ce type de résultats et il n’est pas évident de choisir l’outil de visualisation adapté à chaque cas.</p>
<p>Ce travail vise à guider l’analyste dans ces choix. Nous décrivons l’état des connaissances sur les techniques de présentation d’informations complexes à partir d’une revue de la littérature, complétée par une enquête auprès d’analystes de services écosystémiques. Dans ce contexte, “informations complexes” désigne le type de données dont l’analyse du capital naturel traite, typiquement un grand nombre de cartes et de statistiques reflétant plusieurs objectifs écosystémiques, scénarios et incertitudes. Il est souvent utile de représenter, outre les résultats eux-mêmes, le niveau d’incertitude qui les affecte et peut rendre l’optimisation des décisions plus ou moins robuste.</p>
<p>Cette vision d’ensemble conduit à l’identification de lacunes. Pour les combler, un outil innovant est proposé. Les acquis des recherches sus-mentionées sont réunis sous la forme d’une application web permettant de visualiser les zones de compromis entre les objectifs, de comparer des scénarios et d’évaluer l’incertitude grâce à une interface intuitive combinant plusieurs perspectives.</p>
<h1 id="acronyms-terminology" class="unnumbered">Acronyms &amp; Terminology</h1>
<p><strong>Important concepts &amp; terminology</strong><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<ul>
<li>Natural capital: Natural capital includes all environmental assets, it is the stock of resources, such a rivers, trees, the atmosphere and all living organisms <span class="citation">(Natural Capital Scotland Ltd 2015)</span>.</li>
<li>ES: Ecosystem services are the benefits natural capital assets provide to humanity <span class="citation">(Cardinale et al. 2012)</span></li>
<li>SDU: spatial decision unit, corresponding to a geometric feature such as polygon, pixel, lines or point. In the context of map comparisons, the word “cell” is used in this work for SDU, to match with the literature on the topic. SDU represent the scale at which a discrete spatial decision/intervention is undertaken. <em>[refs: Ben, optimizer design doc, Kuhnert]</em></li>
<li>LULC: land use/land cover</li>
<li>intervention/activity: an action that can be taken on a spatial decision unit that gets reflected in parameters that feed an ecosystem services model. (<em>In the FWAT context, this typically means changing the LULC to a new row of the biophysical table that has modified values</em>)</li>
<li>portfolio: A set of SDU’s and chosen activities for each SDU, emerging from an optimizer, from RIOS, or a participatory prioritization process. Portfolios get overlayed on LULC’s to run the model</li>
<li>scenarios: storylines that describe possible futures (but are not predictions) <span class="citation">(Verutes et al. 2015)</span> (e.g an LULC scenario corresponds to an LULC map that has been changed based on modeled or user-defined changes to represent plausible futures)</li>
<li>SOW: state of the world (scenario with quantitative definition)</li>
</ul>
<p><strong>Jargon of the field</strong></p>
<ul>
<li>ABM: Agent-Based Modeling (computational modeling of phenomena as dynamical systems of interacting agents)</li>
<li>API: Application Programming Interface</li>
<li>EIA: Environmental Impact Assessment</li>
<li>GIS: Geographical Information Systems</li>
<li>IWS: investments in watershed services (known as waterfund)</li>
<li>MOEA: Multi-objective evolutionary algorithm</li>
<li>MOVA: Multi-objective visual analytics</li>
<li>OGR: OpenGIS Simple Features Reference Implementation</li>
<li>OR: Operational research</li>
<li>PCA: Principal component analysis</li>
<li>PFF: Production possibilities frontier (economical term for tradeoff curve)</li>
<li>RO: Robust optimization</li>
<li>SA: Sensitivity analysis</li>
<li>SLR: Sea Level Rise</li>
<li>SDSS: Spatial decision support systems</li>
<li>UA: uncertainty analysis</li>
</ul>
<p><strong>Softwares and models</strong></p>
<ul>
<li>CV: Coastal Vulnerability (model)</li>
<li>HRA: Habitat Risk Assessment (model)</li>
<li>InVEST: Integrated Valuation of Ecosystem Services and Trade-offs</li>
<li>GDAL: Geospatial Data Abstraction Library</li>
<li>MESH: Mapping Ecosystem Services to Human well-being</li>
<li>RIOS: The Resource Investment Optimization System</li>
<li>SDR: Sediment delivery ratio (a model in InVEST)</li>
<li>VIDEO: Visually Interactive Decision-making and Design using Evolutionary Multi-objective Optimization</li>
</ul>
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<blockquote>
<p><em>“Often the importance of ecosystem services is widely appreciated only upon their loss”</em></p>
<p><br />
<em>Gretchen Daily, in The Value of Nature and the Nature of Value</em></p>
</blockquote>
<h2 id="background-motivation"><span class="header-section-number">1.1</span> Background &amp; motivation</h2>
<h3 id="ecosystem-services"><span class="header-section-number">1.1.1</span> Ecosystem services</h3>
<p>Food, water, fuel, fiber, timber, pollination, purification, medicinal plants, inspirational and recreational landscapes are examples of essential gifts from nature making life possible and worthwhile. These are defined as ecosystem services. They can be tangible or intangible.Some are obvious, some are less. Forests, for example, not only provide a natural carbon storage that helps regulate climate, but also hold soil in place along streams, therefore improving water quality, which benefits for people downstream. Habitats in rivers and along coastlines support populations of fish that provide food, including in areas of chronic food insecurity. Biodiversity stabilize ecosystems <span class="citation">(Cardinale et al. 2012)</span>. Mangroves stabilize shorelines and decrease damage to people and property from storms. Oceans also store carbon.</p>
<p>These services rely on complex interactions of many forms of natural capital; the ecosystems that surround us are essential to our survival and well-being, and are the bedrock of a sustainable economy. Nature and people form the biosphere, caring for the former equates to caring for the latter and vice versa. Increasingly, we can map the most important forests, coastal habitats and other ecosystems and show how they support us. This is crucial in order to prioritize the use of resources and sustainably manage our natural world. In short, nature is at the source of human well-being: people depend on nature.</p>
<p>However, about 60% of the ecosystem services are being degraded<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> or are not used sustainably. Not only depletion of natural capital is a major loss of natural asset, but it harms significantly human well-being <span class="citation">(Percy and Lubchencho 2005)</span>. Furthermore, the relationships between harm to an ecosystem and loss in its services are rarely linear and generally the impacts are multiplied and affect every dependant ecosystem process <span class="citation">(Cardinale et al. 2012)</span>.</p>
<p>As the abundance of natural capital decreases, due to clear and increasing human alteration <span class="citation">(Vitousek et al. 1997)</span>, citizens and scholars are increasingly highlighting the urgency of taking action. To do so, efficient policy design requires a strong (often quantitative) understanding of ecosystem services functioning.</p>
<h3 id="natural-capital-assessments"><span class="header-section-number">1.1.2</span> Natural capital assessments</h3>
<p>The benefits nature provides to people and the economy are difficult to quantify and often not valued in traditional accounting. Natural capital assessments aim to provide information on the matter; they help understand the ecosystem services structures, involving quantitative estimates. Valuating ecosystem services aims to cultivate appreciation for the invisible benefits from nature <span class="citation">(Guerry 2016)</span>, which too often happens only upon their loss <span class="citation">(Daily et al. 2000)</span>.</p>
<div class="figure">
<img src="images/mymy.png" alt="Figure 1: Examples of how a natural capital-based approach can be used to mainstream enviromental information throughout the development planning process, contributing to more effective and efficient development plannign decisions, from (Mandle et al. 2016)" id="fig:mymy" />
<p class="caption">Figure 1: Examples of how a natural capital-based approach can be used to mainstream enviromental information throughout the development planning process, contributing to more effective and efficient development plannign decisions, from <span class="citation">(Mandle et al. 2016)</span></p>
</div>
<p>Because degradation or loss of ecosystem benefits incurs costs, for example for water treatment, erosion control, infrastructure maintenance and disaster relief; they undermine security, prosperity and economic development. Therefore, a thorough understanding of natural capital assets is crucial. Natural capital assessments locate the sources of ecosystem services, provide indications for sustainable management, identify and prioritize conservation activities, help build understanding of synergies and trade-offs between the needs and impacts of different projects or sectors, support policy design, and contribute to climate resilience and adaptation planning. Based on this understanding, enlightened decisions can be taken to secure these assets in a context of social and economic development <span class="citation">(Mandle et al. 2016)</span>. In short, natural capital assessments aim to make it easier for nature to become a primary consideration in all decisions, by revealing the specific benefits it provides <span class="citation">(Guerry 2016)</span>. Natural capital assessments document ecosystem services at different levels, from local ones such as pest control, to regional ones like flood control, to global services such as climate stabilization <span class="citation">(Daily et al. 2000)</span>. They reveal interdependencies between services, critical points and timescales for degradation and recovery.</p>
<p>Natural capital assessments are context-dependent and complex <span class="citation">(Daily et al. 2000)</span>. In short, they generally consist in identifying the different alternatives, quantifying their respective impacts, and valuating their respective consequences. A common measuring unit for this last step of valuation is monetary, but outcomes are not always aggregated into monetary terms <span class="citation">(Daily et al. 2000)</span>. However, an important clarification that must be highlighted when presenting the concept of natural capital, is that it does not aim to be merely putting a dollar tag on nature. On the contrary, the natural capital assessments approaches can be thought of a way to correct capitalist society bias that make decisions based on economical return on investment and often exclude nature in their calculations. Monetary valuation is just one small aspect of natural capital assessment, that helps connect in some contexts of financial planning and comparisons <span class="citation">(Guerry 2016)</span>.</p>
<h3 id="communicating-natural-capital-information"><span class="header-section-number">1.1.3</span> Communicating natural capital information</h3>
<p>So natural capital assessment involve a deep understanding of phenomenas and their interaction, which results from painstaking studies and precise modeling. <em>(bpb &gt; you say this is subjective and also not always true.How would I express that they results from a big effort/lots of work from ES analysts ..?)</em> However, these efforts will do little to achieve their intended goal of informing decisions unless the insights they generate are effectively communicated to provide usable information to decision-makers. It had been shown that judgement often results from fast and automatic processing, generally prompted by visuals <span class="citation">(McMahon et al. 2016)</span>. Therefore, the present work aims to put an emphasis on this last step of process, that is, conveying the results – in particular, strategies for visualization, which are often time neglected in time-limited projects which had focused on the previous steps.</p>
<p>Visualization is the main focus of this work, because it has been proven to be easier for the brain to understand an image than words or numbers <span class="citation">(Cukier 2010)</span>. Because of their abilities to synthesize large amounts of data into effective displays <span class="citation">(Ware 2000)</span>, graphics have been widely used in the literature, and the topic of information visualization widely studied (by Cleveland, Ware, Tufte among others). Visualizations support both data analysis and data presentation. Effective visuals are crucial to achieve the intended goal of informing their audience. The latter is the focus of this work, which assumes that at least some initial results are generated. However, visualizations are not distinctly intended to serve just one purpose, and the same displays may also be of use for exploratory analysis by the analyst, to help build insight, especially to the extent that both an analyst’s own work and their stakeholder engagement are iterative. It has been shown that combining optimization with visualization promotes design innovations and empowers decision makers with a better understanding of systems behaviors (see for example the work of <span class="citation">Kollat and Reed (2007)</span>, <span class="citation">Reed and Minsker (2004)</span>, <span class="citation">Fleming et al. (2005)</span>, <span class="citation">Winer and Bloebaum (2002)</span>.</p>
<p>Mapping, defined by <span class="citation">Englund et al. (2017)</span> as the organization of spatially explicit quantitative information, has proven essential for many assessments of ES <span class="citation">(Troy and Wilson 2006)</span>. <span class="citation">Hauck et al. (2013)</span> showed how the spatial products from mapping - maps - are tremendously helpful to support proper management of ecosystems and ecosystem services. However, he also brings attention to the fact that they should be used carefully. Visualizations of large datasets and complex information is a very effective way to conveying knowledge, but it is also non-trivial, which might explain why this topic is given so much attention in the literature. <em>(bpb: last sentence better?)</em>.</p>
<h2 id="the-natural-capital-project"><span class="header-section-number">1.2</span> The Natural Capital Project</h2>
<blockquote>
<p><em>“The Natural Capital Project strives to improve the well-being of people and nature by integrating the value nature provides to society into all major decisions leading to greater and more targeted natural capital investments.”</em></p>
</blockquote>
<p>This work was done within the framework of the Natural Capital Project, at Stanford Woods Institute for the Environment. The Natural Capital Project (shortened NatCap) aims to account for nature’s contributions to society, so that decision-makers worldwide can take into account the value of ecosystem services, leading to wiser and more sustainable choices and better outcomes for people and nature. Founded in 2005, the Natural Capital Project gathers NGOs and academics, namely it is a partnership of four parties: the World Wild Fund (WWF), The Nature Conservancy (TNC), University of Minnesota and Stanford University <span class="citation">(Project n.d.)</span>.</p>
<p>NatCap’s work falls in three types of activities: “advance science of ecosystem services, create user-friendly approaches and tools and build and tell success stories” <span class="citation">(Wolny 2016)</span>. NatCap develops tools meant to assess nature’s contribution to society. All software developed at NatCap is open-source, to make the science accessible and useful in real decisions. The main one is InVEST which gathers several models tackling various ecosystem services such as water yield, sediment retention, carbon storage, wind energy, habitat quality and crop pollination. <span class="citation">Nemec and Raudsepp-Hearne (2013)</span> refers to InVEST as “possibly been the most widely used GIS software tool for mapping ecosystem services”. InVEST and related tools help users explore, map and value these ecosystem services and translate the change in ecosystem to its corresponding change in ecosystem services and to the impacts and benefits to people. Other software includes RIOS, used for targeting cost-effective investments for watershed services; OPAL, which quantifies the impacts of development and the value of offsetting them with protection and restoration; and the Python library PyGeoprocessing which implements GIS operations on which InVEST is based. For further details and examples of applications, <span class="citation">Ruckelshaus et al. (2015)</span> gives a good overview of NatCap’s projects.</p>
<p>The ecosystem service assessment strategy NatCap follows can be summarized in 6 steps, with repeated iterations throughout the process <span class="citation">(Wolny 2016)</span>. First, define the partnership, roles and objectives. Secondly, compile the data. Thirdly, generate baselines and scenarios. In fourth, assess the corresponding outcomes. Then, synthesize the results. Last, but not least, inform decisions by communicating solutions. These two last steps correspond to the focus of this work.</p>
<div class="figure">
<img src="images/natcapapproach.png" alt="Figure 2: Natural Capital Approach (Verutes et al. 2015)" id="fig:approach" />
<p class="caption">Figure 2: Natural Capital Approach <span class="citation">(Verutes et al. 2015)</span></p>
</div>
<p>The present work integrates in the context of NatCap’s approach; the suggested tool (chapter ) applies to a undergoing project and supports communication of its results. It is a prototype to a generic tool that could be incorporated in InVEST or MESH outputs and reports. This is aligned to the developement plan for InVEST 4.0, as one of the three long-term goals is to integrate reporting as part of the InVEST workflow (as mentioned by Richard Sharp at the InVEST webinar on Nov 29th 2016).</p>
<h2 id="objectives"><span class="header-section-number">1.3</span> Objectives</h2>
<p>Developing visuals that communicate the complexities of climate science is admittedly difficult, even with existing visual tools and expertise. A preliminary part of this work consisted in identifying the specific challenges related to displaying ES results. ES information consists in varied, large, multi-dimensional datasets, typically large numbers of results that come from considering multiple objectives, scenarios, and uncertainties. These can be categorical or continuous, spatial or aspatial. The main tasks that these displays aim to support include scenario analysis, multi-objective comparisons, expression of uncertainty. Some cases may require combinations of these tasks.</p>
<p>Overall, this work aims to empower analysts and decision-makers with <strong>easy approaches to clear ES visualizations and summaries</strong>: effective solutions to synthesize and communicate spatial, multi-dimensional outputs of multiple runs for multiple ES models. It gathers an overview of existing display tools and builds upon these to improve natural capital visualizations. The first objective of this work is to identify the challenges and the needs for an efficient communication of results. In a second phase, the aim is to suggest powerful and innovative solutions to address these points. That is, support the ES analysts and scientists by orienting them to (1) the range of display options available, and when they are suitable and (2) to the range of implementations of these display options, pointing to streamlined implementations when possible, or providing template scripts to help ease the workflow of creating visualizations. An informative and practical guidance document gathers recommendations on best practice for ES analysts. Lastly, a framework for implementation of the proposed solutions could be developed, providing a tailored visualization interface suitable to the common issues identified previously.</p>
<h2 id="outline"><span class="header-section-number">1.4</span> Outline</h2>
<p>This master thesis presents approaches to displaying natural capital information, with specific examples of use cases in Kenya and Hawaii. Section 2 describes the adopted methodology, presents the use cases on which the work was based and detail the corresponding workflow. Section 3 provides the context and background knowledge on the basic principles of data visualization, and also briefly addresses the question of which tools to use. Section 4 gathers the existing knowledge on design strategies for displaying complex information, by summarizing an extended literature review that was conducted to explore the design strategies to displaying multi-dimensional, multi-objective, spatial and uncertain data. It suggests solutions for each identified display need, providing examples and tools. Table  summarizes the most common visualization needs and links them to suggested solutions. Next, a new tool was build, implementing some of suggested solutions. Its design and implementation are discussed in section 5. Finally, section 6 provides a summary of this work, along with a discussion about future steps.</p>
<h1 id="method"><span class="header-section-number">2</span> Method</h1>
<blockquote>
<p><em>“Improving communication in the IPCC reports is by no means an easy task”<br />
<span class="citation">(McMahon et al. 2016)</span></em></p>
</blockquote>
<h2 id="project-definition-and-scoping"><span class="header-section-number">2.1</span> Project definition and scoping</h2>
<p>Within the initial framework of the project on environmental modeling and data analysis, several potential directions were considered. Possible directions of work targeted handling spatial interdependence in the models or assessing the value of detailed data in improving optimization outputs and modeled impacts. However, an extended exploration of the needs was conducted to understand where this work could bring the most useful contribution. Analyzing the need is indeed crucial to a good project definition. This preliminary step was achieved during the first month and the annual gathering of NatCap has been a great occasion to identify the areas of needs, it resulted in defining the project around the topic of display tools for ecosystem services. The question of how to synthesize and communicate spatial and multi-dimensional outputs of multiple runs for multiple ES models would be addressed. The goal being to define easy approaches to clear ES visualizations and summaries.</p>
<h2 id="background-and-context"><span class="header-section-number">2.2</span> Background and context</h2>
<h3 id="literature-review"><span class="header-section-number">2.2.1</span> Literature review</h3>
<p>The first steps to approaching the question of displaying natural capital information were to explore the context, learn notions of data visualization in general and understand the state-of-the art. Background knowledge was built gathering from the literature. It turned out this literature review could help answer partly the need for a useful guidance document on ES visualization, by putting together the various approaches and main strategies for displaying ES information.</p>
<h3 id="tools-market-study"><span class="header-section-number">2.2.2</span> Tools market study</h3>
<p>Meanwhile, in computational data visualization, the resulting display highly depends on the choice of tool. And it turned out that the available data visualization tools were numerous, varied, overlapping. An exploration of these softwares and libraries attempted to guide with more clarity towards the choice of an adapted tool. To conduct such a comparison, some of these tools were learned and used.</p>
<h2 id="sec:survey"><span class="header-section-number">2.3</span> Identification and prioritization of display needs</h2>
<p>In order to identify the communication needs of ecosystem services analysts and to understand how well existing needs are met, a survey was crafted, in collaboration with a small team of analysts.</p>
<p>First, based on typical example cases and interviews of professionals in the field of ecosystem services, based at the Natural Capital Project, some display needs were identified. Then this list was refined and completed thanks to the inputs of the broader team. Next, these needs were gathered and organized in a survey document sent out to a broader community of professionals in the field, including scientists, ecologists, hydrologist, economists, analysts and researchers working within the Natural Capital Project. The survey questions can be found in figure . A total of 14 answers were collected, where participants assessed, for each identified need, its usefulness, but also commented on their current implementation and the usefulness of improving the current displays. The two tiers were separated as such: one just to assess “demand” or importance of different types of visualization needs (columns D-E-F in green). The second tier gathered details of current approaches for meeting these needs (column G-H-I), to help better assess gaps that can be filled.</p>
<p>The survey was roughly grouped according to 6 thematic issues (eg, portfolio or scenario descriptions, ES model results, beneficiaries), recognizing in practice there are not clear boundaries. 30 different display tasks were listed; they were phrased purposively avoiding specifying the actual visualization in order to elicit needs and current approaches in an unbiased way. It was circulated as a google sheet so that respondents may add rows for needs that would have not been pre-identified.</p>
<p>The 14 respondents were all professionals in the field of ecosystem services, engaging in both academic and applied work. They rated the usefulness of each display tasks<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> both in terms of (1) the need for this type of display in general and (2) the need for an improved implementation to these displays. The former will serve as a basis to point relevant needs for the user guidance to displaying natural capital information (Chapter ). The latter will allow to identify the areas where better implementations and solutions are required, prioritize between the needs, and will guide the development of a display tool (Chapter ).</p>
<div class="figure">
<img src="images/survey.png" alt="Figure 3: Extract of the survey: Gathering NatCappers’ visualizations needs and tools" id="fig:survey" style="width:100.0%" />
<p class="caption">Figure 3: Extract of the survey: Gathering NatCappers’ visualizations needs and tools</p>
</div>
<h2 id="use-cases"><span class="header-section-number">2.4</span> Use Cases</h2>
<p>The present work have found applications, and based its trials on several on-going projects at the Natural Capital Project.</p>
<h3 id="prioritization-of-native-forest-restoration-in-puu-waawaa-hawaii"><span class="header-section-number">2.4.1</span> Prioritization of native forest restoration in Pu‘u Wa‘awa‘a, Hawai‘i</h3>
<h4 id="a-spatial-multi-objective-approach-to-watershed-conservation" class="unnumbered"><em>A spatial multi-objective approach to watershed conservation</em></h4>
<p>The study aimed to develop a method to analyze the tradeoffs relative to effective watershed restoration planning, applied to the case of a watershed in Hawai‘i: Pu‘u Wa‘awa‘a located in the North Kona region of Kekaha. The paper further informs on prioritization of conservation spending, under different climate scenarios, to include possible climate change. It focuses on groundwater recharge and landscape flammability and details management costs.</p>
<p>In the context of this work, this project’s display tasks were (1) to display the land cover maps corresponding to each scenario, (2) to assess the impact of the proposed restoration scenarios for both objectives of maximazing groundwater and minimizing landscape flammability, and (3) to show spatial prioritization for each objective and the two combined, and the associated costs.</p>
<p>The static visualizations aimed to inform about the impact of restoration (land cover scenarios) on two ES objectives (water, flammability) both independently and then simultaneously while considering several climate scenarios. The resulting constructed maps can be found in appendices , , , .</p>
<h3 id="sec:tanacase"><span class="header-section-number">2.4.2</span> The Upper Tana Nairobi Water Fund</h3>
<h4 id="improving-water-for-millions-in-kenya" class="unnumbered"><em>Improving Water for Millions in Kenya</em></h4>
<p>The Tana River supplies 95% of the water for a total of 9 million people living in Nairobi and surroundings, feeds one of the country’s most important agricultural areas and provides half of the country’s hydropower output. In the past decades, many forests and wetlands have been converted to agriculture, therefore decreasing the natural landscape capacity to store runoff water and retain sediments and soil in place. Today, one of the outcome of increased sedimentation is that 60% of Nairobi’s residents do not have access to a reliable water supply. To solve this problem, the Upper Tana-Nairobi Water Fund was created. The Natural Capital Project analyses the landscape to find out where and what would be the most efficient actions to undertake. In the context of this work, this project’s display tasks were to compare scenarios resulting from a mutli-objective optimization, accounting for uncertainty.</p>
<h2 id="display-toolbox"><span class="header-section-number">2.5</span> Display toolbox</h2>
<h3 id="structure"><span class="header-section-number">2.5.1</span> Structure</h3>
<p>The display needs were organized per theme, in the most logical way that could be found, despite the many overlaps. Once these questions were organized, the aim consisted in answering each effectively. However, the approach of selecting a “best” solution for each display need quickly turned out to be irrelevant as each display need is very specific and context dependent. The alternative was to build an organized toolbox suggesting several strategies for each cases, where the analyst could take inspiration and adapt its solution to fit his or her needs.</p>
<p>The document aimed to be explored and skimmed through, with fast referencing (dynamic links in the pdf document) to related topics and displays. The summarizing table (todo) links the display needs ES analyst can encounter with the suggested solutions.</p>
<h3 id="sec:criterion"><span class="header-section-number">2.5.2</span> Suggested solutions</h3>
<p>Strong of the knowledge from the literature review, and the current state of existing visualizations, display solutions were suggested. For the tasks where no satisfying solutions could be found, new ones were developed, or adapted from solutions existing in neighboring fields in the literature.</p>
<p>It is a rather subjective task to assess the quality of suggested solutions. To increase objectivity, several criteria were considered, specifically the imperatives for visualization, defined by <span class="citation">(Stephens et al. 2012)</span> in the context of ensemble predicitons (figure ), and the criteria of clarity and completeness detailed by <span class="citation">Allen et al. (2012)</span>, in appendix .</p>
<div class="figure">
<img src="images/criterias.png" alt="Figure 4: Imperatives for visualization, defined by (Stephens et al. 2012) in the context of ensemble predicitons: richness, saliency, and robustness." id="fig:crit1" style="width:40.0%" />
<p class="caption">Figure 4: Imperatives for visualization, defined by <span class="citation">(Stephens et al. 2012)</span> in the context of ensemble predicitons: richness, saliency, and robustness.</p>
</div>
<h2 id="development-of-a-web-application"><span class="header-section-number">2.6</span> Development of a web application</h2>
<p>Building on the knowledge from the previous chapters, and attempting to partially fill the gaps identified where improved visualizations would be useful, a prototype of a web application was developped. This was done in the context of the multi-objective optimization for the Tana waterfund (detailed in ). Details about the implementation method and choices can be found in chapter .</p>
<h2 id="master-thesis-workflow"><span class="header-section-number">2.7</span> Master thesis workflow</h2>

<h1 id="sec:elements"><span class="header-section-number">3</span> Elements of data visualization</h1>
<blockquote>
<p><em>“Excellence in statistical graphics consists of complex ideas communicated with clarity, precision and efficiency.”</em></p>
<p><em>Edward Tufte</em></p>
</blockquote>
<p>This chapter aims to lay out the context and basics of data visualization, to have the background knowledge to further investigate specific display strategies. First, a brief overview of some general notions in data visualization is given to familiarize with the context, along with guidelines for successful implementation. Finally, an overview of the multiple visualization tools supports choice of the most adapted software or library for each application.</p>
<h2 id="notions-and-techniques-in-data-visualization"><span class="header-section-number">3.1</span> Notions and techniques in data visualization</h2>
<h3 id="sec:graphintegrity"><span class="header-section-number">3.1.1</span> Information visualization and graphical integrity</h3>
<p>Information visualization, or visual communication, consists in transforming complex and abstract data into an accessible and concrete form, that a human brain can perceive with as little as possible cognitive effort. It consists simply in encoding data into visual objects, such as lines or points <span class="citation">(Tufte 1983)</span>. The goal of a visualization is to effectively convey information <span class="citation">(Kelleher and Wagener 2011)</span>.</p>
<p>In order to achieve this aim honestly, graphical integrity considerations must be kept in mind throughout the process of building visualizations. It has been shown that graphs can clearly be misleading because of design choices <span class="citation">(Allen et al. 2012)</span>. Graphical integrity consists in accurate representations of data, avoiding distortions or misleading designs. To this end, data must be shown in its context, well-known units and clear labeling should be used to avoid ambiguity, true proportions must be kept in representing numbers <span class="citation">(Tufte 1983)</span>. In the context of ES, graphical integrity could be interpreted as showing uncertainties and all scenarios; hiding some may be considered dishonest <span class="citation">(McMahon et al. 2016)</span>. These considerations apply especially in the choice of the scale: it is important to normalize it, and use the same scale on comparable figures, to avoid biasing comparisons.</p>
<h3 id="vocabulary-and-grammar-of-graphics"><span class="header-section-number">3.1.2</span> Vocabulary and grammar of graphics</h3>
<p>Graphs, charts, diagrams and plots, despite ambiguous nuances, are all defined as representations of data, these words will be used synonymously in this work. A graph consists in at least one dataset translated into a set of mappings (i.e visual encodings), forming layers that are statistically transformed according to the scale, the coordinate system and the facet specification. Refer to <span class="citation">Wickham (2008)</span> for precisions about grammar of graphics.</p>
<p>Spatial data is handled with specific tools, so called geographical information systems (GIS) which link geographic (e.g maps) and descriptive informations. Data is organized is different layers, associated based on their geography. Spatial data can be stored in two types: raster, which is a collection of pixels referenced with coordinates, and vector, which corresponds to a set of point, lines and polygons. Different projections and coordinate systems are of great importance when dealing with spatial data: the round shape of the earth different from the flat projections of the maps means that distortion cannot be avoided. These projections conserve either the shape, or the area for example but cannot conserve all measures <span class="citation">(Medeiros 2016)</span>.</p>
<h3 id="modes-of-visualization"><span class="header-section-number">3.1.3</span> Modes of visualization</h3>
<p>Required for printed format, <strong>static presentations</strong> are essential. Plus, in the context of inter-organizational projects, there is almost always a need to summarize results in static reports.</p>
<p><strong>Dynamic user-interactive visualizations</strong> gives the greatest flexibility to the user who is given options to test and visualize results while having some control on the display. In many cases, user interactivity enhances the user’s implication and satisfaction <span class="citation">(Teo et al. 2003)</span>. Dynamic displays offers many options to tailored and multi-dimensional visualizations. Section  will detail some of the main features of interest.</p>
<p><strong>Dynamic storytelling</strong> is the in-between between the two previous visualization modes, is is dynamic but not fully interactive. The viewer is guided through the visualization, either by a presenter, or step-by-step through the storyline, he therefore has less flexibility to “play around” with the variables, but it can result in easier delivery of main message. Especially useful during presentations, but also on webpages, the dynamic storytelling allows the flexibility and multi-dimensional displays options of dynamic visualizations, while keeping control on the selected options, i.e walking the user through the visualization to lead to the envisioned goal.</p>
<h3 id="sec:disto"><span class="header-section-number">3.1.4</span> Distortion techniques</h3>
<p>When displaying large datasets, combining considerations about different scales can become very tricky. As noted earlier (), graphical integrity requires to present the context of the dataset. However, when attempting to show local variations, displaying two scales at once is a notable challenge. Some distortion techniques have been developed in order to view precisely local details in their global context. They allows a greater space to the display of a focused zone, while still embedding its surrounding context. Generally, linear or hyperbolic geometry supports the smooth connection of the focus area and the background, that have different scales <span class="citation">(Leung and Apperley 1994)</span>. Distortion techniques include:</p>
<ul>
<li><strong>bifocal display</strong> (or lens) corresponds simply to a linear transformation (in one or two directions) <span class="citation">(Apperley et al. 1982 and <span class="citation">Leung and Apperley (1994)</span>)</span>.</li>
<li><strong>polyfocal lens</strong> is similar to bifocal lens, but using a more complex hyperbolic (or polynomial) transformation function <span class="citation">(Leung and Apperley 1994)</span>.</li>
<li><strong>fisheye view</strong>, originally called <em>Focus + Context</em> technique <span class="citation">(Lamping et al. 1995)</span>, <span class="citation">(Furnas 1986)</span> uses a continuous magnification function (that also transforms the boundaries). Tough this term has been used with different definitions, it is broadly used and very intuitive.</li>
<li>there are other options among which can be mentioned the <strong>perspective wall</strong> <span class="citation">(Mackinlay et al. 1991)</span>, that simulates the perspective effect or the <strong>hyperbolic tree</strong> that extends the fisheye view using hyperbolic plane mapped onto a circular display region <span class="citation">(Lamping et al. 1995)</span>.</li>
</ul>
<h3 id="sec:interactivefeatures"><span class="header-section-number">3.1.5</span> Interaction techniques</h3>
<p>A few interactive features of interest include <span class="citation">(Wilhelm et al. 1995)</span>:</p>
<ul>
<li><strong>Scaling</strong> which is simply zooming in and out but is powerful in the sense that it allows the user to both global view of the whole dataset and precise details on smaller fluctuations, therefore removing the need for a distorded view. Some scaling options also combine distortion techniques (see section ) to both zoom in and keep the background context in the surroundings.</li>
<li><strong>Identification</strong> (also called pointing) allows access to detailed information of a subset of the graph by clicking on it.</li>
<li><strong>Generalized selection</strong> extracts every point that is similar to the user’s selection for an overview of subsets. The similarity rules are defined according to the case.</li>
<li><strong>Brushing</strong> consists in selecting a subset of data, that is then highlighted. Also, brushing can be used to remove unwanted data, when a specific threshold is required <span class="citation">(Kollat and Reed 2007)</span>. Brushing can be done with a slider, or with direct selection on the plot <span class="citation">(Ward 1994)</span>.</li>
<li>In a context where the displays consists in several views (different plots), <strong>linking</strong> adds value to brushing, it is the dynamic update of the other graphs displayed, to undergo the corresponding «brushed» selection <span class="citation">(Buja et al. 1996)</span>.</li>
</ul>
<h2 id="sec:colors"><span class="header-section-number">3.2</span> Graphical best practices and guidelines</h2>
<p>What makes a good visualization? Keeping in mind the goal which is to effectively convey information, i.e to gain insight on the data, an efficient visualization reduces the cognitive effort of understanding the graph, in order to bring the observer’s attention on the actual facts. Some may seem trivial, nevertheless the guidelines summarized in the following paragraphs are essential to achieving the intended purpose. As described by Tufte (1983) in his classic text, graphical displays should: “’<em>show the data, induce the viewer to think about the substance rather than about methodology, graphic design, the technology of graphic production or something else, avoid distorting what the data has to say, present many numbers in a small space, make large data sets coherent, encourage the eye to compare different pieces of data, reveal the data at several levels of detail, from a broad overview to the fine structure, serve a reasonably clear purpose: description, exploration, tabulation or decoration, be closely integrated with the statistical and verbal descriptions of a data set. »</em>. In the context of maps, <span class="citation">Buckley (2012)</span> states five major maps design principles, namely legibility, visual contrast (for which the choice of an appropriate colorscheme is essential) figure-ground organization, hierarchical organization, and balance (see <span class="citation">(Buckley 2012)</span> for further details and guidance specific to maps).</p>
<p>Best practices seem to be summarized by three main points. An efficient display should be self-explanatory, tailored to the audience and most importantly convey the key message. Moreover a good visualization is highly dependent on the task, the type of display and other design choices are very specific to the dataset considered.</p>
<h3 id="legibility-and-intuitivity"><span class="header-section-number">3.2.1</span> Legibility and intuitivity</h3>
<p>Simplicity is key to an effective display. Tufte advocates to minimize the design complexity, to maximize the content reasoning time. Redundancy complicates vainly and should be avoided. For example, the data ink ratio (i.e the ratio of ink used to display data over the total ink of the figure) should be minimized as far as possible <span class="citation">(Tufte 1983)</span>. Additionally, <span class="citation">(Kelleher and Wagener 2011)</span> argues to maintain axis ranges across subplots for easier comparison, connect sequential data (e.g disconnection for missing data in time series plots) and express density in overlapping points (e.g with color gradient in scatterplots). Moreover, appropriate encoding of objects and attributes lead to intuitive plots <span class="citation">(Cleveland and McGill 1984)</span>.</p>
<h3 id="scale-and-ratios"><span class="header-section-number">3.2.2</span> Scale and ratios</h3>
<p>The success of a visualization is contingent upon the careful selection of appropriate scales and aspect ratios. There is always trade-offs between showing the zero, or zooming on fluctuations. Dynamic features and distortion techniques allow to overcome some of this difficult choices, but are not always possible. Making the right choice between displaying patterns or details is crucial <span class="citation">(Kosslyn and Chabris 1992)</span>. Meaningful axis ranges, data transformations (e.g log scale) and aggregation level (e.g temporal aggregation by averaging over a larger time step for long time-series) are essential too <span class="citation">(Kelleher and Wagener 2011)</span></p>
<h3 id="legend"><span class="header-section-number">3.2.3</span> Legend</h3>
<p>For the graph to be self-explanatory, a clear labeling must be included. If opting for a legend, it should be ordered by some properties of data, never alphabetically because a space to express something about the data would be wasted <span class="citation">(Tufte 1983)</span>. Creating logical groups assist the understanding. For color codes, it is advised to display adjacent to each other in the legend the colors that are adjacent in the corresponding map <span class="citation">(Brewer 2004)</span>.</p>
<h3 id="colorscheme"><span class="header-section-number">3.2.4</span> Colorscheme</h3>
<p>The careful choice of the color scheme is not be neglected <span class="citation">(Kelleher and Wagener 2011)</span>. Sequential color scheme ought to be chosen when the underlying data shows ranked differences; diverging scheme when dealing with negative and positive differences around a mean or a neutral value; and a categorical scheme for discrete values (see figure  and recommendations of <a href="https://tilemill-project.github.io/tilemill/docs/guides/tips-for-color/">the tilemill project</a>. Moreover, many sources suggests to use only a few colors (about 6), while choosing them distinct, and striving for color harmony. Cultural conventions and intuitive tints facilitate fast perception. Colorblind and printing safe schemes are prudent. Also, the color scale should be normalized, considering which datapoints should appear in different categories. Websites like <a href="http://colorbrewer2.org/">Colorbrewer</a>, <a href="http://colrd.com/palette/">Colrdl</a> or <a href="https://color.adobe.com">Adobe Kuler</a> provide good color palettes, based on color theory.</p>

<h3 id="interactivity"><span class="header-section-number">3.2.5</span> Interactivity</h3>
<p>The success of an interactive display results from the appropriate interface complexity for a certain user motivation <span class="citation">(Roth and M. 2008)</span>. In the field of interactive maps, <span class="citation">(Roth and M. 2008)</span> examines when cartographic interaction positively supports work.Interactivity is not always beneficial to the graphs, but relevant for users who wish to customize the communicated information to their particular interests, also relevant to overcome some display problematics. Another point that interactivity helps achieving is enhancing the user’s involvment with the map, by offering a sense of control over the experience.</p>
<h2 id="overview-of-visualization-tools"><span class="header-section-number">3.3</span> Overview of visualization tools</h2>
<p>A few important things to consider when chosing a tool are the features supported (user interactivity, spatial data, 3D, web), and also the price, speed, scalability, robustness, customizability and user adoption. Then, it is often a trade-off between customizability and ease of use. The softwares are usually easier to manipulate, and the results are aesthetic, but if the user is willing to code, custom scripts offer the most flexibility in design, and various charting libraries allow to tailor the figure to specific needs. This section does not pretend to be exhaustive but attempts to give an overview of the available data visualization tools, as of 2016. Emphasis will be given on spatial data as it constitutes an essential part of natural capital informations.</p>
<div class="figure">
<img src="images/toolz.png" alt="Figure 5: Overview of some existing visualization tools" id="fig:boooo" />
<p class="caption">Figure 5: Overview of some existing visualization tools</p>
</div>
<h3 id="data-analysis-and-visualization-softwares"><span class="header-section-number">3.3.1</span> Data analysis and visualization softwares</h3>
<p>As we enter the information age, data visualization softwares, usually combining some analytics features, thrive. Some of the main visualization software are <strong>Tableau</strong>, <strong>Spotfire</strong>, <strong>Qlickview</strong> and <strong>MS BI Stack</strong>. Dynamic visualization has historically been supported by softwares like <strong>Xmdv Tool</strong> and <strong>OpenDX</strong> (both open source) and is recently proposed by a myriad of new softwares, as visual data analytics is becoming very trendy.</p>
<p>In terms of maps, some of these softwares support spatial data (namely Tableau, Spotfire and OpenDX). Moreover, GIS softwares are designed to build maps from any data and to perform spatial data analysis. The two most used ones: <strong>ArcGIS</strong> and <strong>QGIS</strong>. The former integrates in its desktop version several applications, namely ArcMap to build maps, ArcCatalog for data management, ArcToolbox for geoprocessing, and also ArcScene, ArcGlobe, and ArcGIS Pro. QGIS (formerly Quantum GIS) is the corresponding open-source software. According to synthesis of users’ forums, it seems that ArcGIS seems to have more functionalities, especially when dealing with rasters and better support tools, and QGIS a steeper learning curve. However, they are really comparable. To combine spatial data and dynamic displays, some softwares such as <strong>InstantAtlas</strong> provide interactive mapping services. <a href="http://geoawesomeness.com/top-19-online-geovisualization-tools-apis-libraries-beautiful-maps/">More details and examples of geovisualization tools are presented by</a> <span class="citation">Buczkowski (2016)</span> and include Carto, the Mapzen API, Maps4news and even the sotware Tableau mentioned above.</p>
<h3 id="charting-libraries"><span class="header-section-number">3.3.2</span> Charting libraries</h3>
<p>Charts and maps can also be coded, allowing greater flexibility. Sorted by programming languages, some of the main plotting and mapping libraries are listed below. On the spatial data side, these options are better than GIS softwares for exploratory data analysis <span class="citation">(Hügel 2015)</span>.</p>
<h4 id="javascript"><span class="header-section-number">3.3.2.1</span> Javascript</h4>
<p>Javascript is, without a doubt, the go-to language for fancy - and definately for interactive - data visualization, considering the multiple charting libraries written in this language. The one that stands out is <strong>D3.js</strong> (or just D3 for Data-Driven Documents). Formerly Protovis, it produces dynamic, interactive and very customizable web visualizations. In the same vein, Processing, Anychart, FusionCharts, Dygraphs, Highchart, Zingchart, Three (3D)… Several tools build upon D3, the library <strong>Dc.js</strong> adds crossfiltering functionalities, such as brushing and linking, Raw provides a user interface to build D3 typical examples without having to code <span class="citation">(Caviglia and al 2013)</span>. Also <strong>Plotly</strong> API libraries that build on D3.js not only for javascript but also with versions for python, Matlab and R.</p>
<p>About spatial data, <strong>Leaflet</strong> is probably the most adopted mapping library. <strong>Mapbox</strong> supports similar functionalities with the Mapbox GL library. Other mapping libraries include ModestMap (from the makers of Mapbox) and Highmaps.</p>
<h4 id="r"><span class="header-section-number">3.3.2.2</span> R</h4>
<p>R plotting packages <strong>ggplot</strong> and <strong>ggplot2</strong> are very efficient for static visualizations. The map package built on top of the latter, <strong>ggmap</strong> combines spatial information from GoogleMaps, OpenStreetMap with the grammar of graphics of ggplot2 <span class="citation">(Kahle and Wickham 2013)</span>. The interactive version of ggplot2 would be <strong>ggvis</strong>, however its dynamic functionalities are quite limited. A powerful package for interactive (web) visualizations is <strong>Shiny</strong>. R spatial packages include <strong>sp</strong>, <strong>raster</strong>, <strong>maptools</strong> and <strong>rasterVis</strong>.<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> Also, as mentioned above, Plotly has an R version too, converting ggplot2 charts to interactive ones. Another way to connect to the multiple javascript charting libraries is to use the package rCharts.</p>
<p>The OpenMORDM visualization toolkit <span class="citation">(Hadka et al. 2015)</span> is a dynamic visualization platform built from R Shiny. It allows to explore, gain insight on the data, and make static plots, with a focus on deep uncertainty and robustness visualizations.</p>
<h4 id="python"><span class="header-section-number">3.3.2.3</span> Python</h4>
<p><strong>Matplotlib</strong> is the main Python graphing library. It contains a toolkit for plotting 2D data on maps: <strong>basemap</strong><a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>. Also, <strong>geopandas</strong> extends the data analysis library Pandas to spatial data, using also Fiona for file access, Shapely and Descartes for geometric operations, PySal for spatial analysis, and of couse Matplotlib for plotting <span class="citation">(Hügel 2015)</span>. Interactive plots are based on <strong>Bokeh</strong> which imitates D3, or, as mentioned previously, Plotly.</p>
<h1 id="sec:UserGuide"><span class="header-section-number">4</span> Design strategies to display natural capital information</h1>
<p>This chapter gathers learnings from an extended literature review on static and dynamic approaches to displaying complex data and existing strategies in use. The literature review explored the design strategies to express and display multi-dimensional, spatial, multi-objective, uncertain data and combinations of these. This focus corresponds to the specific challenges faced while communicating natural capital information. The variety of mapping and synthesizing approaches in the field of ES leads to difficult choices of methods for the analysts <span class="citation">(Englund et al. 2017)</span>. So this practical toolbox aims to put together the various options, hopefully providing a clearer vision on the variety of options.</p>
<h2 id="specific-data-visualization-challenges"><span class="header-section-number">4.1</span> Specific data visualization challenges</h2>
<h3 id="analysis-of-the-display-needs"><span class="header-section-number">4.1.1</span> Analysis of the display needs</h3>
<p>The display tasks gathered in the survey (detailed in section ) appeared to be right on point as the average scores, in terms of general usefulness, were all higher than 3.5, 84% were higher than 4.0 and 47% higher than 4.5. These results confirms the relevance of these display tasks, all perceived as useful by the survey respondents.</p>
<h3 id="how-to-read-this-chapter"><span class="header-section-number">4.1.2</span> How to read this chapter</h3>
<p>This document is intended to support and guide analysts in their task of communicating natural capital information. It is a toolbox, structured around four main themes: displaying multi-dimensional data, spatial data, comparing multiple versions of spatial data and expressing uncertainty. It aims to suggest display solutions for each of the display tasks previously identified. Each proposed display is explained, discussed (pros and cons) and illustrated with relevant use cases and/or examples. These solutions were selected based on several criterion (see section ). However, when it comes to data visualization and clarity, some subjectivity cannot be avoided. Also, data visualization is really a case-by-case and efficient displays really depends on the underlying data and information to convey. This user guidance aims to serve as a basis and an inspiration to the analyst, suggesting several options to be used and adapted to each case. Tailoring the displays is essential. For example, the suggested displays have different degrees of complexity and the analyst should pick a complexity level according to :</p>
<ul>
<li>the audience targeted: <em>Who is the display intended for ? What is their level of knowledge about the project and their familiarity with scientific visualizations ?</em></li>
<li>the time at disposition: <em>Should this convey just the key results or go in depth about the analysis ?</em></li>
<li>the document type: <em>Static, dynamic, interactive ?</em></li>
<li>the presentation type: <em>Should this be self explanatory or will it be presented by the analyst ?</em></li>
</ul>
<p>The reader is expected to skim through the suggested displays. Fast referencing allows to jump between sections in this interactive document; the web visualizations listed have embedded links. For a quick answer to a specific display need, table  summarizes the relevant options for the main display tasks, and links to appropriate tools.<br />
<br />
An important preliminary note: plots and graphs are not always necessary. Sometimes, the full data table is the best visualization. For example, in the case of an mid-project intermediary report for a meeting with experts on the project, it is likely that plots will lead to questions digging in details, where showing the full dataset and how solution were selected and compared to each other is necessary.</p>
<h2 id="multi-dimensional-data"><span class="header-section-number">4.2</span> Multi-dimensional data</h2>
<p>In the context of ES, multi-dimensionality arises often from multi-objective problems such as cases where multiple services are considered and their trade-offs are to be explored, but also from multiple scenarios, due for example to uncertainty. Visual decision support tools are very relevant in field of multi-objective optimization problems<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>, as well as for scenario comparison. For multi-objective optimization under uncertainty, the number of scenario considered can be very large. In the typical cases, there is no unique optimal solution, but a collection of Pareto optimal ones <span class="citation">(Hadka et al. 2015)</span>, i.e solutions where improving the result towards one objective result a decrease in performance with regards to another objective <span class="citation">(Pareto 1896)</span>. Efficient visualizations empower the user with the ability to navigate through thousands of potential solutions, compare them and understand trade-offs, leading to performant decision-making.</p>
<p>Multi-dimensional data visualization has been given considerable attention, as computational capacities have been increasing and the amount of produced data exploding. Multi-dimensional data exploration has taken several directions, based on a geometric projection techniques, to which distortion and interaction techniques (discussed in sections  and ) can be added to further improve these visualizations <span class="citation">(Keim 2000)</span>. The curse of multi-dimensionality, as explained by <span class="citation">Allen et al. (2012)</span> is that graphical displays become less informative as the dimensions and complexity of data sets increase. However, he argues in favor of detailed graphs showing more data and revealing more information.</p>
<h3 id="sec:scatterplots"><span class="header-section-number">4.2.1</span> Scatterplots</h3>
<p>The classic scatterplot displays data with two to three dimensions, using cartesian coordinates and two or three axes. In a <strong>3D scatterplot</strong> (figure a) solutions are represented as points in the space. Additional dimensions can be represented by changing attributes (color, shape, size, orientation, etc), however concerns about clarity and risk of overwhelming the plot may occur. Interactivity allows the user to perform selections of one or multiple solution point(s).</p>
<p>A <strong>Scatter plot matrix</strong> combines the small multiple strategy with the classic scatterplot; abbreviated SPLOM, it displays relationships between every pair of variables.</p>
<p>In the context of multi-objective optimization, to understand trade-offs and synergies between several objectives under many scenarios, scatterplots are a great option. The commonly used <strong>trade-off curve</strong> is a scatterplot displaying objective scores, with an axis per objective, and a datapoint per scenario (see for example figures  and c). A third objective can be displayed by adding a colorscale or size-scale. Also, 3D scatterplots are often used for up to four objectives (e.g in figure  or the VIDEO software of <span class="citation">Kollat and Reed (2007)</span>). Over 4 objectives, small multiples of trade-off curves are very relevant.</p>
<div class="figure">
<img src="images/todo_img.png" alt="Figure 6: Several options to display multiple variables with scatterplots: (a) Two axis scatterplot (Vogl et al. 2014), (b) Shape-coded scatterplot (examples..?) ——— waiting on Example from bpb : small mutiple scatterplots trade off curves + shape coded or color coded trade off curves ———- Trade-offs curves example: see also figure ." id="fig:yyyytodo" />
<p class="caption">Figure 6: Several options to display multiple variables with scatterplots: (a) Two axis scatterplot <span class="citation">(Vogl et al. 2014)</span>, (b) Shape-coded scatterplot (examples..?) <strong>——— waiting on Example from bpb : small mutiple scatterplots trade off curves + shape coded or color coded trade off curves ———-</strong> Trade-offs curves example: see also figure .</p>
</div>
<h3 id="sec:timeseries"><span class="header-section-number">4.2.2</span> Time-series data: line charts, streamgraphs and more</h3>
<p>For data including several independent variables, and a dependent one, <strong>line charts</strong> is a version of a scatterplot (see ) where points are ordered (on the x-axis), and joined with segments. Line charts (also refered to as run charts for time-series data, or index charts when interactive) highlight relative changes, these are a good options when comparing the independant variables. <strong>Streamgraphs</strong> (figure :{fig:line_img}b), also called stacked graphs, sums visually the time-series values around a central axis by stacking area charts on top of each other <span class="citation">(Jeffrey Heer 2010)</span>. These work only for positive values, and provide general view of the data, but are not effective for visualizing details, also they are more efficient in interactive form than static <span class="citation">(Ribecca n.d.)</span>. In the case of very large timeseries datasets, <strong>horizon graphs</strong> (figure :{fig:line_img}a)is a very space-effective option, despite a certain amount of learning time. Horizon graphs consists in filled line charts, where negative values are mirrored (and colored typically in red) to appear on the upper side, and then the chart divided into bands that are overlayed using transparency effects to limit the space required for peaks. Thus the space used is divided by four thanks to these two transformations <span class="citation">(Jeffrey Heer 2009)</span>. When the goal is to compare monthly values over the years and the different year, a fairly recent display solution has been suggested: <strong>temporal maps</strong> as shown in figure :{fig:line_img}d <span class="citation">(R. 2014)</span>. An extension of this concept, for very high-dimensional datasets, is <strong>pixel-oriented visualization</strong> which consists in using each pixel to display one data value in highly structured arrangements <span class="citation">(Keim 2000)</span>. Other strategies extend these plots, for example through comprehensive plotting, multi-variate metrics can be visualized (figure c). Spatial metrics can also be visualized through histograms comparing main summary statistics in different scenarios (e.g the percentage of land areas covered by each 3 category is displayed for 3 drivers, and 4 scenarios using small multiples histograms in figure 4 of the work of <span class="citation">Villamor et al. (2014)</span>)<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>.</p>
<div class="figure">
<img src="images/horizon_etc.png" alt="Figure 7: Illustrations of concepts of (a) horizon graphs (Jeffrey Heer 2009), (b) streamgraph (Vallandingham n.d.), (c) line graph (Sun et al. 2014) and (d) temporal map (R. 2014). (c) is an example of comprehensive plotting for a case of a 4-dimensions dataset plotted with four 3-dimensions figures to display 4*3^3 data points. This is one of the 4 figures, where Sun et al. (2014) displays results of one of the 4 metrics as several line plots (for several variables, here one per market level), and varying parameters (here 3 parameters with 3 possible values each resulting in 3^3 data points per market level, per figure. This is one of four figures" id="fig:line_img" style="width:100.0%" />
<p class="caption">Figure 7: Illustrations of concepts of (a) horizon graphs <span class="citation">(Jeffrey Heer 2009)</span>, (b) streamgraph <span class="citation">(Vallandingham n.d.)</span>, (c) line graph <span class="citation">(Sun et al. 2014)</span> and (d) temporal map <span class="citation">(R. 2014)</span>. (c) is an example of comprehensive plotting for a case of a 4-dimensions dataset plotted with four 3-dimensions figures to display 4*3^3 data points. This is one of the 4 figures, where <span class="citation">Sun et al. (2014)</span> displays results of one of the 4 metrics as several line plots (for several variables, here one per market level), and varying parameters (here 3 parameters with 3 possible values each resulting in <span class="LaTeX">$3^3$</span> data points per market level, per figure. This is one of four figures</p>
</div>
<h3 id="sec:parcoords"><span class="header-section-number">4.2.3</span> Parallel coordinates plot</h3>
<p>Parallel coordinates plots (figure b) are very effective to display different solutions in a multi-objective context and visualize trade-offs and synergies between objectives under several scenarios. The number of scenarios is then nearly unlimited, and so is the number of objectives, to the limit that the horizontal axis fit the page. Scenarios are represented as lines, distinguished by varying colors, which intersect horizontal axis representing the objectives. Patterns are clearly visible <span class="citation">(Achtert et al. 2013)</span>. The vertical direction of preferred solution must be clearly indicated to assist interpretation.</p>
<p>Tradeoffs are illustrated by crossing lines. However, one limitation is that each axis having at most two neighboring axis, only N-1 relationships of <span class="LaTeX">$\binom{N}{2}$</span> combinations for an N-dimensional dataset can be visualized at once. This can be overcome by re-ordering the axis, possibly with an interactive tool, or by upgrading to a 3D parallel coordinate plot where the axis are still in parallel, but some appear closer <span class="citation">(Achtert et al. 2013)</span>, although this solution result in a much harder interpretation, which may explain why it is not widely used.</p>
<p>Combining parallel coordinates with interactive features offers interesting options to explore the data, for example brushing allows to extract trends over subsets, <span class="citation">(Andrienko and Andrienko 2001)</span> recommends linking to other graphics. To constrast alternative options and explore the effects of trade-offs, 3D scatter plot and parallel coordinates plot are recommended by <span class="citation">Hadka et al. (2015)</span>, as shown in figure . The equivalent of parallel coordinates plot for categorical data is the alluvial plot; it is also useful to discretize the data into subsets when the dataset is too large for the lines to be distinguished, <span class="citation">Trindade (2017)</span> provides more details. Several tools and packages exist to make both parallel and alluvial plots<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a>.</p>
<div class="figure">
<img src="http://ars.els-cdn.com/content/image/1-s2.0-S1364815215300190-gr3.jpg" alt="Figure 8: Four objectives visualization with (a) 3D scatterplot and colors and (b) parallel coordinate plot, achieved with the OpenMORDM open-source R library (Hadka et al. 2015)" id="fig:hadka" />
<p class="caption">Figure 8: Four objectives visualization with (a) 3D scatterplot and colors and (b) parallel coordinate plot, achieved with the OpenMORDM open-source R library <span class="citation">(Hadka et al. 2015)</span></p>
</div>
<h3 id="sec:radar"><span class="header-section-number">4.2.4</span> Radar charts</h3>
<p>The radar chart, as shown in figure , is the version of parallel coordinates plot in polar coordinates. It has also been refered to as spider chart<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>, web chart, star chart, polar chart, or Kiviat diagram. It can be an interesting way to visualize trade-offs. However, they tend to become cluttered and complicated if with many variables, making comparisons very difficult <span class="citation">(Ribecca n.d.)</span><a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a></p>
<div class="figure">
<img src="images/radaar.png" alt="Figure 9: (a) Radar chart, in the context of a NatCap project in Kamehameha schools, Hawaii. (b) Small multiples strategy applied to radar charts by Arkema et al. (2015). The multiples correspond here to the 9 considered regions" id="fig:coastal_sm" />
<p class="caption">Figure 9: (a) Radar chart, in the context of a NatCap project in Kamehameha schools, Hawaii. (b) Small multiples strategy applied to radar charts by <span class="citation">Arkema et al. (2015)</span>. The multiples correspond here to the 9 considered regions</p>
</div>
<h3 id="sec:smallmultiples"><span class="header-section-number">4.2.5</span> Small Multiples</h3>
<p>An effective alternative to coercing all the data in a single plot (risking overplotting) is displaying small multiples. The concept is to replicate the same simple graph structure (in terms of axis, shape and scale), for many datasets, ordered logically. The cognitive process of understanding the graph is undertaken only once, and the understanding then is replicated while scanning all other multiples. This strategy is very efficient in many cases for comparison. Referred by Edward Tufte as “multivariate and data bountiful”, they enforces comparisons of alternatives, differences and changes <span class="citation">(Tufte 1983)</span>. This displaying startegy has also been called trellis chart, lattice chart, grid chart, or panel chart. It can be applied to many types of graphs, or maps. Other examples of the small multiple strategy and variants of it can be found in figures a, b, a.</p>
<h3 id="other-displays"><span class="header-section-number">4.2.6</span> Other displays</h3>
<p>Other statistical distributed data displays more specific to some data types include <strong>Stem-and-Leaf Plots</strong>, which is a variant of horizontal histogram painting a frequency distribution with numbers classified forming the histogram-like bars; and <strong>Q-Q Plots</strong> that compare probability distributions by graphing their quantiles where values lining up will reflect linear correlation <span class="citation">(Jeffrey Heer 2010)</span>.</p>
<p>More display techniques have been explored, but are not widely used. To mention just a few, in the 1990’s, were developed the <strong>prosections views</strong> <span class="citation">(Furnas and Bujat 1994)</span> that build view of high-dimensional objects through projection (in one or two dimensions), followed by section (i.e intersection of subspaces). Also, the <strong>Hyperslice</strong> <span class="citation">(Wijk 1993)</span> attempts to represents multi-dimensional function as a matrix of orthogonal two-dimensional plans.</p>
<h3 id="sec:rdim"><span class="header-section-number">4.2.7</span> Reduce dimensions</h3>
<p>Another approach to reduce cognitive complexity of multi-dimensional data, is to reduce the dimensions in some coherent way. For example, the <strong>principal components analysis</strong> (PCA) can be conducted to reduce the number of variables by combining the correlated ones <span class="citation">(Hotelling 1933)</span>. Similarly, the <strong>choice modeler approach</strong> aims to evaluate multiple decision variants, in a very large decision space. The concept is to identify criteria that do not influence the output (here, the decision option ranking), and remove these dimensions, to simplify without loosing correctness <span class="citation">(Jankowski et al. 2008)</span>.</p>
<p>In the same vein, multiple dimensions can be summarized by creating an <strong>aggregated metric</strong>, e.g an indication of a lake recreation value would combine variables such as water quality, lake size, boat options (work of Ryan Noe)</p>
<h3 id="sec:multiplelinked"><span class="header-section-number">4.2.8</span> Multiple linked views</h3>
<p>Several options to display multi-variate data were discussed. However they all realistically apply to a limited number of variables. As dimensions of the data increase, it is often interesting to show several linked graphs of the same dataset to convey the complex information. This solution gives different perspectives to the viewer. In the case of a static display, the graphs are connected by matching color coding or other corresponding parameters, as in figures , a, b and c.</p>
<div class="figure">
<img src="images/arkemaa.png" alt="Figure 10: Examples of combining static plots: (a) the bar plots display the area of habitat in each risk category (low, medium, high) per planning region (1 to 9), by Arkema et al. (2014). (b) Dense figure using a story-telling approach to present scenarios. It combines bar plots, maps and the small multiples approach. This figure is self-explanatory, and by including a few sentences, it replaces a lot of text (Arkema et al. 2015)" id="fig:arkemaa" style="width:100.0%" />
<p class="caption">Figure 10: Examples of combining static plots: (a) the bar plots display the area of habitat in each risk category (low, medium, high) per planning region (1 to 9), by <span class="citation">Arkema et al. (2014)</span>. (b) Dense figure using a story-telling approach to present scenarios. It combines bar plots, maps and the small multiples approach. This figure is self-explanatory, and by including a few sentences, it replaces a lot of text <span class="citation">(Arkema et al. 2015)</span></p>
</div>
<p>Furthermore, dynamic displays allow improvement by adding brushing and linking features (see ), examples of interactive dashboards with multiple linked views include <em>(click on the title to be re-direct to the online version)</em>:</p>
<ul>
<li><a href="https://phawthorne.github.io/mc-vis/">The Middle Cedar visualization</a> (figure )</li>
<li><a href="http://nascience.us/roi/public/">The Conservation ROI Dashboard</a> (figure )</li>
<li><a href="http://vulpes.sefs.uw.edu/ttapp/hra-dash.php">Habitat Risk Assessment Dashboard</a>. This interactive web application displays user’s InVEST output workspace, and was developped in R and Javascript.</li>
<li><a href="http://vulpes.sefs.uw.edu/ttapp/cv-dash.php">Coastal Vulnerability Dashboard</a></li>
</ul>
<h2 id="spatial-data"><span class="header-section-number">4.3</span> Spatial data</h2>
<h3 id="general-classification-of-maps"><span class="header-section-number">4.3.1</span> General classification of maps</h3>

<h4 id="choropleth-maps-and-proportional-symbol-maps"><span class="header-section-number">4.3.1.1</span> Choropleth maps and proportional symbol maps</h4>
<p>choropleth maps are very effective and widely used to display a continuous or categorical spatial variable aggregated by regions. The variable of interest is expressed by coloring (or using patterns on) these geographical areas. Particular attention needs to be given to the choice of patterns (see section ). Furthermore, it is necessary to normalize<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a> raw data values may be necessary to ensure graphical integrity <span class="citation">(Jeffrey Heer 2010)</span>. However, the main drawback is that larger areas appear emphasised <span class="citation">(Ribecca n.d.)</span>.</p>
<p>Another solution for continuous spatial data aggregated by regions is the graduated symbol map (or proportional symbol map, also called bubble map <span class="citation">(Ribecca n.d.)</span>) that overlays symbols to the base map. In this case, the underlying area does not affect the perception of the variable considered <span class="citation">(Jeffrey Heer 2010)</span>. These two approaches can also be combined, allowing to express more than one variable.</p>
<h4 id="heatmaps-isopleths-and-dot-density-maps"><span class="header-section-number">4.3.1.2</span> Heatmaps, isopleths and dot density maps</h4>
<p>Displaying density of occurence, and identifying clusters can be achieved with heatmaps and hotspot maps. The heatmap can be understood as the continuous version of the choropleth map, whithout aggregation of the data. It visualizes a scalar function over a geographical area <span class="citation">(Ken Brodlie and Lopes 2012)</span>. Similarly, in the dot distribution map (or dot density map), the density of dots represents the intensity of the variable.</p>
<h4 id="contour-maps"><span class="header-section-number">4.3.1.3</span> Contour maps</h4>
<p>Also know by contour maps, or isarithmic maps, isopleth maps they display variable with contour lines (isopleths) joining the points where the variable has a constant value. For example in the field of ecology, isoflors are isopleths connecting areas of comparable biological diversity <span class="citation">(Specht 1981)</span>. Color fills may be used to enhance the map pattern. Contouring can also be used to highlight areas on a map, as in figure b), which combines informations about two independant variables, overlaying two types of maps.</p>
<h4 id="cartograms"><span class="header-section-number">4.3.1.4</span> Cartograms</h4>
<p>Cartogram also illustrate data aggregated over regions. The variable to be expressed is substituted to the geographical distance or area. The regions are in the same locations with respect to each other, but their geometry is distorted proportionally to the variable of interest <span class="citation">(Jeffrey Heer 2010)</span></p>
<div class="figure">
<img src="images/carto.png" alt="Figure 11: Cartogram displaying population (variable) per country (regions of aggregation) (Hennig 2011)" id="fig:carto" style="width:70.0%" />
<p class="caption">Figure 11: Cartogram displaying population (variable) per country (regions of aggregation) <span class="citation">(Hennig 2011)</span></p>
</div>
<h4 id="flow-maps"><span class="header-section-number">4.3.1.5</span> Flow maps</h4>
<p>A flow map illustrates movement in space and/or in time. The intensity of a flow is represented by the thickness of the line depicting it <span class="citation">(Ribecca n.d.)</span>. Flow maps are typically used to visualize migrations of animals, but could also be applied to pollution load transfer, or groundwater recharge from a region ot another.</p>
<div class="figure">
<img src="images/Minard.png" alt="Figure 12: Minard’s Napoleon’s March figurative map. This epic example of flow map, drawn up by M. Minard in 1869, depicts the successive losses in men of the French army in the Russian campaign of 1812-1813. It figures multi-variate data, including 6 dimensions that are the army size, its direction, its location in (x,y) coordinates, the dates and the temperature in the lower part of the display. The best statisctical graphic ever drawn according to Edward Tufte is an example of displaying complexity with clarity. Its great strength reside in its capacity to encode many variables. This example reminds also that successful and effective visualization are very specific to the dataset and message, and its beauty resides in the fact that it is very tailored to the story to be conveyed, here: the numerous deaths of soldiers. The text translates to: The numbers of men present are represented by the width of the colored zones at a scale of one millimeter for every ten thousand men; they are further written accros the zones. The red designates the men who enter into Russia, the black those who leave it. The information which has served to draw up the map has been extracted from the works of M. M. Thiers of Ségur, of Fezensac, of Chambray and the unpublished diary of Jacob, the pharmacist of the army since october 28th. In order to better judge with the eye the diminution of the army, I have assumed that the troops of Prince Jérôme and the Marshal Davoush who had been detached at Minsk and Mokilow and have rejoined around Orcha and Vitebsk had always marched with the army." id="fig:minard" />
<p class="caption">Figure 12: Minard’s Napoleon’s March figurative map. This epic example of flow map, drawn up by M. Minard in 1869, depicts the successive losses in men of the French army in the Russian campaign of 1812-1813. It figures multi-variate data, including 6 dimensions that are the army size, its direction, its location in (x,y) coordinates, the dates and the temperature in the lower part of the display. <em>“The best statisctical graphic ever drawn”</em> according to Edward Tufte is an example of displaying complexity with clarity. Its great strength reside in its capacity to encode many variables. This example reminds also that successful and effective visualization are very specific to the dataset and message, and its beauty resides in the fact that it is very tailored to the story to be conveyed, here: the numerous deaths of soldiers. The text translates to: <em>The numbers of men present are represented by the width of the colored zones at a scale of one millimeter for every ten thousand men; they are further written accros the zones. The red designates the men who enter into Russia, the black those who leave it. The information which has served to draw up the map has been extracted from the works of M. M. Thiers of Ségur, of Fezensac, of Chambray and the unpublished diary of Jacob, the pharmacist of the army since october 28th. In order to better judge with the eye the diminution of the army, I have assumed that the troops of Prince Jérôme and the Marshal Davoush who had been detached at Minsk and Mokilow and have rejoined around Orcha and Vitebsk had always marched with the army.</em></p>
</div>
<h3 id="sec:twowidely"><span class="header-section-number">4.3.2</span> Two widely used ES maps</h3>
<p>Two types of choropleth maps are very often used:</p>
<h4 id="sec:portfolios"><span class="header-section-number">4.3.2.1</span> Portfolios</h4>
<p>Landcover maps, also called LULC for land use/land cover, represent the full landscape with its corresponding land uses. A portfolio is a landcover map which correspond to a subset of the full landscape: the set of chosen activities for each SDU. When displaying portfolios, highest care must be given to symbology, see recommendations in section . Landcover colors chemes can be very tricky, depending on the number of classes and the arrangement. A good example is given by figure b.</p>
<div class="figure">
<img src="images/portfolio_lulc.png" alt="Figure 13: Portofolio and landcover maps: (a) a portfolio map of the Nathpa Jhakri catchment (Vogl et al. 2014) and (b) a many-classes LULC colorscheme (Stacie Wolny)" id="fig:lulc" />
<p class="caption">Figure 13: Portofolio and landcover maps: (a) a portfolio map of the Nathpa Jhakri catchment <span class="citation">(Vogl et al. 2014)</span> and (b) a many-classes LULC colorscheme (Stacie Wolny)</p>
</div>
<h4 id="sec:objs"><span class="header-section-number">4.3.2.2</span> Objective score maps</h4>
<p>Objective score maps are choropleths displaying a continuous variable: the objective score for each SDU. These are widely used to visualized ES model outputs. Often, the objective score maps of different ES objectives are combined in a single one summarizing the overall scores (e.g in the combined figures in appendice ).</p>
<p>Objective score maps can display either absolute scores, or the change in score relative to a baseline, in which case they are also refered to as marginal value maps. Examples of marginal objective score maps can be found in appendices  and .</p>
<h3 id="sec:hotspot"><span class="header-section-number">4.3.3</span> Spatial visualization of tradeoffs</h3>
<p>In the context of optimization, ES analysts often have to figure out where, on a landscape, do activities produce co-benefits, and where are they in conflict ? That is: where does an intervention move multiple ES metrics (objectives) in the same direction i.e where are the <em>win-wins</em>? And on the other hand, where in space is a given intervention or scenario contribute to some metrics at the expense of others?</p>
<h4 id="hotspot-map" class="unnumbered">Hotspot map</h4>
<p>In the case of only 2 scenarios or only 2 objectives, one could show change maps, or side by side maps, i.e techniques used to compare 2 maps, detailed in . For more objectives, hotspot maps (figure a) can display location of synergies/tradeoffs of intervention/scenario on multiple ES metrics. The idea of the hotspot map is to select the areas of highest score, for each objective, and find areas of overlaps. For example, as shown in figure a, the top 20% of each service are selected, the selection are then added to construct the hotspot map. The categorical version of a hotspot map details priority/conflicts zones for each objective, as in figure b. This one is less intuitive, but more detailed: one can see precisely which objectives are in conflict.</p>
<div class="figure">
<img src="images/hotspots.png" alt="Figure 14: (a) Hotspot map in Myanmar for 3 objectives (Wolny, 2016) and (b) Categorical version of a hotspot map: Priority and conflicts areas, in the case of 3 objectives: biodiversity (BD), water quality (WQ) and profit. Thanks to this map, the decison-maker can decide where to intervene on the landscape, depending on which objective(s) (s)he prioritzes (Bryant and Hawthorne n.d.)" id="fig:Stacie20" />
<p class="caption">Figure 14: (a) Hotspot map in Myanmar for 3 objectives (Wolny, 2016) and (b) Categorical version of a hotspot map: Priority and conflicts areas, in the case of 3 objectives: biodiversity (BD), water quality (WQ) and profit. Thanks to this map, the decison-maker can decide where to intervene on the landscape, depending on which objective(s) (s)he prioritzes <span class="citation">(Bryant and Hawthorne n.d.)</span></p>
</div>
<p>A remaining subquestion is about the intensity of tradeoffs and synergies in space: where are tradeoffs more or less stark? An extension of figure b could be envisioned, varying transparency to represent intensity.</p>
<p>Another strategy consists in combining trade-offs curves with small multiples of objective score maps. On trade-offs curves (see section ), each point corresponds to a portfolio: displaying these together adds great value and helps understanding. Examples of strategies to display together the trade-offs curve and the corresponding maps are presented in figures c and .</p>
<h3 id="sec:beneficiaries"><span class="header-section-number">4.3.4</span> Relationship between variables</h3>
<p>Expressing relationship between independant or correlated variables is often needed when dealing with several topics and metrics. For example, it is very relevant in the context of displaying the beneficiaries of a project. The survey (see ) highlighted growing interest in this topic (details about survey results in section ). However, this tasks appears to be very context specific. Typically, the displays would aim to quantify and show the beneficaries impact, possibly by subgroups, and often their location in space. It is also often of interest to contrast beneficiary distribution in space with service distribution in space. For example, figure b highlights the relationship between people dependency on forests and the location of KBAs.</p>
<h4 id="relationship-between-independant-variables"><span class="header-section-number">4.3.4.1</span> Relationship between independant variables</h4>
<p>Two variables can be expressed at one by combining two maps in one. Figure a shows only the resulting map, while figure b displays side by side the two input map and the one combining these, a more self-explanatory but also space-consuming approach.</p>
<div class="figure">
<img src="images/combine_my.png" alt="Figure 15: Combining two maps by multiplying them: (a) Combining ES maps with population maps to show people’s dependency to ES (Mandle et al. 2016). This map results from the multiplication of (1) an objective score map for sediment retention, and (2) a map of the number of people who use surface water for drinking, as provided by the national census (b) the first map displays the number of villages located downstream from regions affected by the flood, the second one indicates how much the natural vegetation contributes to reducing flood risk. The third map results from the multiplication of the two others, and therefore displays the flood risk reduction provided by natural vegetation that benefits the most villages downstream. Displaying these 3 maps on the same page within eyespan facilitates understanding (here, there are squeezed for purposes of space efficiency, but are originally displayed side by side by Mandle et al. (2016))" id="fig:mycombine" />
<p class="caption">Figure 15: Combining two maps by multiplying them: (a) Combining ES maps with population maps to show people’s dependency to ES <span class="citation">(Mandle et al. 2016)</span>. This map results from the multiplication of (1) an objective score map for sediment retention, and (2) a map of the number of people who use surface water for drinking, as provided by the national census (b) the first map displays the number of villages located downstream from regions affected by the flood, the second one indicates how much the natural vegetation contributes to reducing flood risk. The third map results from the multiplication of the two others, and therefore displays the flood risk reduction provided by natural vegetation that benefits the most villages downstream. Displaying these 3 maps on the same page within eyespan facilitates understanding (here, there are squeezed for purposes of space efficiency, but are originally displayed side by side by <span class="citation">Mandle et al. (2016)</span>)</p>
</div>
<h4 id="spatial-correlation"><span class="header-section-number">4.3.4.2</span> Spatial correlation</h4>
<p>Spatial correlation can be expressed by displaying correlation statistics computed for corresponding pixels (as in figure a) or by overlaying different maps (as in figure b)</p>
<div class="figure">
<img src="images/spatial_correl.png" alt="Figure 16: Expressing spatial correlation (a) through displaying spatial correlation coefficients, between two variables. Here, an each ES and the landscape ecological risk (LER) (Gong et al. 2016) (b) Overlaying variables: combining informations about biodiversity (contour maps in red showing the key biodiversity areas) and about ES benefits (choropleth map with green gradient), overlayed on a relief map (Mandle et al. 2016)" id="fig:myanmar_biodiv-ppl" />
<p class="caption">Figure 16: Expressing spatial correlation (a) through displaying spatial correlation coefficients, between two variables. Here, an each ES and the landscape ecological risk (LER) <span class="citation">(Gong et al. 2016)</span> (b) Overlaying variables: combining informations about biodiversity (contour maps in red showing the key biodiversity areas) and about ES benefits (choropleth map with green gradient), overlayed on a relief map <span class="citation">(Mandle et al. 2016)</span></p>
</div>
<h4 id="interactive-maps"><span class="header-section-number">4.3.4.3</span> Interactive maps</h4>
<p>Interactive maps allow to overlay multiple layers corresponding to multiple variables, allowing to explore relationship between different variables/layers. Good examples include:</p>
<ul>
<li><a href="http://www.myanmarnaturalcapital.org/en">Myanmar Natural Capital: a storytelling approach for a project involving multiple ecosystem services</a>. The tools used here are D3.js, leaflet, openStreetMaps, Google Maps and photoshop.</li>
<li><a href="http://coastalresilience.org/tools/apps/#apps_id%7Cassess-risk%7C1">The Nature Conservancy also developed a visualization platform, gathering a suite of web applications based on maps</a>, aiming to convey and/or simplify ecological concepts, assess risk, identifiy and compare different solutions and scenarios. For example, <a href="http://maps.coastalresilience.org/gulfmex/">the coastal resilience in the Gulf of Mexico.</a></li>
<li><a href="http://www.geointerest.frih.org/NatCap/">The Mapping portal for the Belize project by Gregg Verutes, developped with Mapbox, and OpenStreetMap</a></li>
<li><a href="http://marineapps.naturalcapitalproject.org/bahamas/">Similarly, a map web viewer for coastal hazard model results in the Bahamas, by Gregg Verutes</a></li>
<li></li>
</ul>
<h2 id="sec:compare"><span class="header-section-number">4.4</span> Comparison of multiple spatial runs</h2>
<p>Runs refers here to different versions of a spatially explicit variable; this section is about comparing multiple maps expressing the same variable - while comparison of maps expressing different variables was treated in sections  and . This multiplicity of outputs may correspond to multiple objectives, various scenarios or varying parameters values (i.e sensitivity analysis, this case is further described in section ). Summarizing these multiples spatial model outputs is necessary in applications such as:</p>
<ul>
<li>portfolios comparisons, to understand trends in agreement and disagreement on recommended action, in contexts of land use change planning, optimization.</li>
<li>comparison of ES model outputs such as objective scores at pixel or polygon level, to understand similarity and differences between maps of several ES objectives under one scenario, or the maps of same objective under several scenarios. Many maps are often generated under many combinations of scenarios or parametric uncertainty. Relevant examples also include comparing objective score maps associated with many points on an optimization frontier.</li>
</ul>
<p>Comparison and summaries of maps can be achieved either by visualizing spatially through maps () or through quantitative indices and metrics synthetizing the results aspatially ( for categorical data summary indices,  for continuous data).</p>
<h4 id="map-comparison-tools" class="unnumbered">Map comparison tools</h4>
<p>Automated comparison of maps can be achieved with softwares like the Map Comparison Kit<a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a> <span class="citation">(Visser and De Nijs 2006)</span>. An algorithm called Mapcurves, implemented in R and Matlab, provides a goodness-of-fit measure based on spatial overlap. TerrSet software also provdes GIS analysis features, including multiple map comparison and a variety of spatial statistics <span class="citation">(ClarkLabs 2015)</span>.</p>
<h3 id="sec:comp_map"><span class="header-section-number">4.4.1</span> Maps displays</h3>
<h4 id="sec:comp_map_2"><span class="header-section-number">4.4.1.1</span> Between two maps</h4>
<h4 id="interactive-switching-between-maps" class="unnumbered">Interactive switching between maps</h4>
<p>For the examination of (dis)agreement between two maps, analysts often like to flip back and forth between the two. This is easy to do in GIS softwares and is a convenient solution for the data exploration purposes. Nevertheless, this method is not always suited for communication purposes. Plus, this interactive solution doesn’t apply to static documents.</p>
<h4 id="side-by-side-maps" class="unnumbered">Side by side maps</h4>
<p>Show the two maps next to each other. This is not the most space effective option, but allow an intuitive understanding and faciltiates comparison. The two maps must be within eyespan (careful to page breaks).</p>
<h4 id="change-map" class="unnumbered">Change map</h4>
<p>Substracting one map to the other (generally corresponding to the baseline scenario) results in a change map. Typically change maps uses diverging colorscheme, two colors representing respectively increase and decrease, and the intensity gradient reflects the amount of change. Suited for scenario comparison with a baseline scenario, or how two future scenarios differ from each other; an example can be found in additional figure b.</p>
<h4 id="sec:comp_map_many"><span class="header-section-number">4.4.1.2</span> Between many maps</h4>
<p>The problem complicates when comparing many runs. In the context of multiple continuous ES model outputs, such as objective score maps for several ES services, a hotspot map can be constructed (detailed in section )</p>
<h4 id="maps-matrix-small-multiple-strategy" class="unnumbered">Maps matrix (small multiple strategy)</h4>
<p>When the number of maps to compare is low enough to fit in a page, with a reasonable resolution, the small multiple approach (see section ) is relevant, as in figure a.</p>
<h4 id="footprint-map" class="unnumbered">Footprint map</h4>
<p>To express the agreement on doing an (any) activity across portfolios, footprint maps show which areas are consistently selected. Pixels are assigned a binary value (1 if the pixel was selected in the portfolio for any intervention, 0 otherwise), and these binary values are added up across the cell stack (i.e the corresponding cells in each map). The resulting map shows which areas are consistently selected.</p>
<p>To express agreement about an activity across portfolios, footprint maps can also be done for a specific category (1 is assigned is the pixel was selected in this category).</p>
<h4 id="modal-portfolio-and-frequency-map" class="unnumbered">Modal portfolio and frequency map</h4>
<p>For categorical data, the frequency map approach would display the most assigned category to each area across runs, with additionally a measure of how often this category was assigned <span class="citation">(Bryant et al. n.d.)</span>. In the context of portfolios, this is called the modal portfolio, displaying the most often chosen activity for each spatial unit<a href="#fn13" class="footnoteRef" id="fnref13"><sup>13</sup></a>. The comparison part is held by the frequency map, which express how often was the activity chosen. Precisely, the frequency map is usually constructed as such: for each spatial unit, number of portfolios where the modal value is chosen divided by total number of portfolios. These two maps complements each other: the former is about summarizing when the latter hold indications on comparison. They can be overlayed or displayed side by side, as in .</p>
<div class="figure">
<img src="images/RIOS.png" alt="Figure 17: Example for a set of 57 runs, over a subwatershed, modified from Bryant et al. (n.d.). In the frequency map (b), the prevalence of dark green indicates that most activities are quite robust." id="fig:RIOS" />
<p class="caption">Figure 17: Example for a set of 57 runs, over a subwatershed, modified from <span class="citation">Bryant et al. (n.d.)</span>. In the frequency map (b), the prevalence of dark green indicates that most activities are quite robust.</p>
</div>
<h4 id="categorical-map-diversity-indices" class="unnumbered">Categorical map diversity indices</h4>
<p>An alternative to frequency maps, to summarize the categorical variance accross many runs is the <strong>shannon diversity index</strong>, for each pixel: <span class="LaTeX">$SDI = - \sum_{i=1}^{R} p_{i} \ln(p_{i})$</span>, with <span class="LaTeX">$\textrm{p}_{i}$</span> the proportion of cells assigned to category i, and <span class="LaTeX">$R$</span> the total number of categories. Here is how to interprete the SDI: when evenly distributed, <span class="LaTeX">$SDI = \ln(R)$</span>, and as it approaches <span class="LaTeX">$0$</span>, proportions in each category vary more. Hence, SDI reflects the relative abundance of each category across the pixel stack. So, the smaller the SDI, the most confident one can be about the pixel’s most chosen category. Other diversity indices can also be substituted, such as the Evenness index, see the work of <span class="citation">Kitsiou and Karydis (2000)</span> for details and the Inverse Distance Weighted interpolation method that she uses to map the results, if not all points have an index value.</p>
<p>The <strong>fuzzy set approach</strong> <span class="citation">(Hagen 2003)</span> assesses the similarity of several categorical maps, resulting in a fuzzy set comparison map where each cell displays a degree of similarity and an overall value for similarity, so-called <span class="LaTeX">$\kappa$</span>-Fuzzy as it extends the Kappa index including fuzziness of category and of location.</p>
<p>Similarly, a <strong>coefficient of unlikeability</strong> measure variability in categorical data by considering how often, not how much, observations differ <span class="citation">(Kader and Perry 2007)</span>. Calculated for each cell. It should be interpreted as such: the coefficient is high if different interventions were chosen (i.e low agreement), and low if the same intervention tended to be chosen (high agreement). So it reflects (the inverse of) agreement across maps.</p>
<h4 id="variant-invariant-method" class="unnumbered">Variant-invariant method</h4>
<p>In the same vein, the <strong>variant-invariant method</strong> aims to distinguish the invariant regions, that is the areas where the category assigned is consistently the same (see <span class="citation">Brown et al. (2005)</span>).</p>
<h4 id="spaghetti-plots" class="unnumbered">Spaghetti plots</h4>
<p>Visualizing flow data, <strong>spaghetti plots</strong> (figure a) express consistency between runs. Widely used in meteorology, the consistency of the runs is expressed by how tightly clustered they appear. Spaghetti plots may be translated to continuous spatial data by using the isocontour of each run, which is useful when concerned about a specific threshold.</p>
<h4 id="d-plots-overlaying-maps" class="unnumbered">3D plots overlaying maps</h4>
<p>For continuous data, <strong>3D plots overlaying maps</strong> (figure b) have been used to highlight structural differences across maps. However, this solution seems limited to relatively small regions, and clearly distinguishable distributions of the variables expressed through color and height of the histogram.</p>
<div class="figure">
<img src="images/spag3D.png" alt="Figure 18: (a) Spaghetti plots displaying ensemble data sets [Potter, 2009]. The spaghetti plot is the isocontour of each run. If the runs agree (Fig. left), it will result in a coherent bundle. Slight disagrements induce divergence from the main bundle (Fig. right). (b) 3D histograms, organized according the geographical layout; extract from figure 8 of Huang et al. (2013)" id="fig:spag3D" />
<p class="caption">Figure 18: (a) Spaghetti plots displaying ensemble data sets [Potter, 2009]. The spaghetti plot is the isocontour of each run. If the runs agree (Fig. left), it will result in a coherent bundle. Slight disagrements induce divergence from the main bundle (Fig. right). (b) 3D histograms, organized according the geographical layout; extract from figure 8 of <span class="citation">Huang et al. (2013)</span></p>
</div>
<h4 id="interactive-map-comparisons" class="unnumbered">Interactive map comparisons</h4>
<p>Animation is of great interest in this context. Dynamic visualizations are very suited for displaying multiple spatial outputs, there are increasingly used to display results in the field of ABMs<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a>, encountering similar type of outputs <span class="citation">(Lee et al. 2015)</span>.<br />
<br />
Visual comparisons of maps is efficient and not too intense cognitively for human perception. However, it fails to rank quantitatively the results, nor is adapted to an important number of maps. Screening through hundreds of maps produced is not a viable option. Therefore, other solutions must be considered. In particular, a variety of statistics can be used to summarize results and agreement over maps of the same area.</p>
<h3 id="sec:metricsmultrunscat"><span class="header-section-number">4.4.2</span> Aspatial metrics to summarize results and agreements of categorical maps</h3>
<p>Non-spatial statistics, such as quantitative indices exist …</p>
<h4 id="sec:comp_stat_cat_2"><span class="header-section-number">4.4.2.1</span> Between two maps</h4>
<p>There are different types of categorical (i.e discrete attributes) map consistency measures <span class="citation">(Kuhnert et al. 2005)</span>:</p>
<h4 id="total-per-categories" class="unnumbered">Total per categories</h4>
<p>The coarsest approach would be to compare the total numbers of cells[^3back] assigned to each category, neglecting any spatial patterns. This gives a very general quantitative overview of the total per categories, that can be delivered as tabular data. (All the other, finer approaches detailed below imply a cell-by-cell comparison.) [^3back]: <em>Vocabulary note: Following <span class="citation">Kuhnert et al. (2005)</span>, in this section, “cell” corresponds to the regional unit at which data is aggregated, it can be a region, a pixel, an HRU, a state…</em></p>
<h4 id="percent-agreement" class="unnumbered">Percent agreement</h4>
<p>A basic cell-by-cell comparison method measures simply the overall agreement (or percent agreement) by calculating the portion of cells that agree between two maps:<br />
(Cell-by-cell level of agreement) = (Number of direct matched cells between 2 maps) / (Total number of cells in map)</p>
<h4 id="kappa-index-of-agreement" class="unnumbered">Kappa index of agreement</h4>
<p>KIA or Cohen’s <span class="LaTeX">$\kappa$</span> is a widely used statistic measuring concordance between categorical items. This technique has proven efficient for cell-by-cell comparisons of spatial data <span class="citation">(Manson 2005)</span>, as long as patterns and locations of changes are not involved <span class="citation">(Kuhnert et al. 2005)</span>. It is more robust than a percent agreement because it takes into account the agreement occuring by chance. <span class="LaTeX">$\kappa = \frac{\textrm{p}_{0}-\textrm{p}_\textrm{e}}{1-\textrm{p}_\textrm{e}}$</span> with <span class="LaTeX">$\textrm{p}_{0}$</span> being the proportion of units agreeing, and <span class="LaTeX">$\textrm{p}_\textrm{e}$</span> the proportion of units expected to agree by chance (i.e the hypothetical probability of chance agreement). Complete agreement results in <span class="LaTeX">$\kappa = 1$</span> <span class="citation">(Cohen 1960)</span>.</p>
<p>However, <span class="citation">Pontius (2000)</span>, after pusblishin his work about <span class="LaTeX">$\kappa$</span> ended up reconsidering his positions and advocating against the use of this index because of several flaws, mainly the irrelevance of the randomness baseline in many applications, and the fact that it’s the ratio is difficult to interprete and overly complicated, as only the numerator actually matters <span class="citation">(Pontius and Millones 2011)</span>. Instead, he suggests to use quantity disagreement and allocation disagreement measures (see next point).</p>
<h4 id="quantity-location-fit" class="unnumbered">Quantity &amp; location fit</h4>
<p>A more precise version of the <span class="LaTeX">$\kappa$</span> approach explained above consists in analyzing 2 metrics, measuring respectively the quantity disagreement and allocation disagreement. These are more helpful to understand both components of disagreement than with a single statistic of agreement. <span class="citation">(Pontius and Millones 2011)</span>. For example:</p>
<ul>
<li>The <strong>quantity fit</strong> informs on the number of cells that changed from one category to another, offering an overall comparison on the quantity of each category: <span class="LaTeX">$$Quantity \ fit = 1 - \frac{1}{N}\sum \left |  \textrm{a}_\textrm{1i} - \textrm{a}_\textrm{2i} \right |$$</span> where <span class="LaTeX">$\textrm{a}_\textrm{ki}$</span> is the number of cells assigned to category <span class="LaTeX">$i$</span>, in map <span class="LaTeX">$k$</span> with <span class="LaTeX">$k \subseteq (1,2)$</span>, <span class="LaTeX">$N$</span> the total number of cells in map and <span class="LaTeX">$C$</span> means all categories <span class="citation">(Kuhnert et al. 2005)</span>.</li>
<li>The <strong>location fit</strong> informs on the number of cells that kept the category but changed location from one map to another: <span class="LaTeX">$Quantity \ fit = (Location \ fit) \ - \ (Cell-by-cell\  level\  of\  agreement)$</span> Another possible way of measuring the location disagrement is the <strong>distance between the locations of matching cells</strong> in the maps can also be calculated <span class="citation">(Kuhnert et al. 2005)</span>. An overall measure of distance between two discrete maps expresses the amount of agreement or the goodness of fit <span class="citation">(Seppelt and Voinov 2003)</span> and <span class="citation">(Costanza 1989)</span>.</li>
</ul>
<h4 id="jaccard-index" class="unnumbered">Jaccard index</h4>
<p>Other indices comparing agreement accross categorical datasets exist. However, very few to no applications in comparing maps has been found. The Jaccard index, also known as Tanimoto index, is computed as the ratio of the intersection of the two sets over their union: <span class="LaTeX">$$Jaccard\ index = \frac{Map1 \cap Map2}{Map1 \cup Map2}$$</span> <span class="citation">(Van Rijsbergen 1979)</span>. Simple to understand, it ranges from 0 to 1, increasing with increasing similarity between the sets. The <strong>Sørensen-Dice coefficient</strong> is a slightly different version of the Jaccard index. Also called the Dice similarity coefficient , or F1 score, it is calculated as such: <span class="LaTeX">$$Sorensen-Dice\ index={\frac {2|Map1\cap Map2|}{|Map1|+|Map2|}}$$</span> More similarity measures for categorical data have been explored by Lourenco <span class="citation">(Lourenco et al. 2004)</span>.</p>
<h4 id="taking-into-account-shifted-similar-patterns" class="unnumbered">Taking into account shifted similar patterns…</h4>
<p>The <strong>moving window algorithm</strong> further accounts for landscape patterns by considering neighboring cells in addition to the cell-to-cell comparison. It has been develop to answer the following problem: computing solely the number of cell-to-cell matches is not reliable in all circumstances, as if there is a matching cell right near by, it will not be taken into account (e.g if we compare two chessboards shifted by one well, the number of cell-to-cell matches is null although there is evident similarity not to be ignored) <span class="citation">(Kuhnert et al. 2005)</span>. The <strong>hierarchical fuzzy pattern matching</strong> uses a different strategy to address the same concern, instead of moving a “window”, it varies the zoom. It avoids drawbacks of a cell-by-cell comparison by aggregating the regional unit considered in patches, and conducting comparisons at different scales <span class="citation">(Power et al. 2001)</span>.</p>
<h4 id="sec:comp_stat_cat_many"><span class="header-section-number">4.4.2.2</span> Between many maps</h4>
<p>When comparing a large number of maps, aggregation often is necessary to communicate results <span class="citation">(Brown et al. 2005)</span>. Some of the metrics detailed above that calculate correlation between two maps may be extended to many maps comparison <span class="citation">(Seppelt and Voinov 2003)</span>, like the total per categories approach:</p>
<h4 id="total-per-categories-1" class="unnumbered">Total per categories</h4>
<p>Calculating the total numbers of pixels assigned to each category (as in previous section) resulting in a table, with categories in comuns and runs in rows, which works if there are not too many runs. If there are, one may display a simple table linking categories with summary statistics indicating some measure of the mean and the variance (e.g average and extrema or standard deviation), as exemplified in the table below<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a>. However, this measure only account for the overall amount of each category, and not for spatial distribution.</p>
<table>
<caption>Made-up example to illustrate the <em>total per categories</em> approach</caption>
<thead>
<tr class="header">
<th>Land cover</th>
<th>Grass</th>
<th>Forest</th>
<th>Barren</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Average pixels [min;max]</td>
<td>121 [110;143]</td>
<td>204 [158;226]</td>
<td>25 [14;50]</td>
</tr>
<tr class="even">
<td>Average percentage ± standard deviation</td>
<td>35% ± 2%</td>
<td>58% ± 3%</td>
<td>7% ± 3%</td>
</tr>
</tbody>
</table>
<h4 id="pixel-stack-methods" class="unnumbered">Pixel stack methods</h4>
<p>Finer methods imply to make calculations for each cell, in all the considered maps (as in, superposing all maps, and making calculation for the column of corresponding cells). For raster data, this technique of <em>column of cells</em> is referred to as pixel stack, raster stack, cell stacks, z-profile or vector of values. To summarize agreement between runs in a single number, the measures suggested in  can be aggregated. For example, the average SDI would give an indication of the consistency of the runs. However, these overall average do not give any indications on spatial patterns.</p>
<h4 id="comparison-of-landscape-metrics" class="unnumbered">Comparison of landscape metrics</h4>
<p>Some spatial metrics allow to spatial patterns. They allow tabular comparisons of some runs (the indices are calculated for each run) They include Area-weighted mean shape index, centrality indices, contagion index… <span class="citation">(Lee et al. 2015)</span>. Some are more specific landscape metrics, such as the average core area, which is the proportion of production land per land cover category <span class="citation">(Parker and Meretsky 2004)</span>, and the average patch perimeter-area ratio (PA-1) <span class="citation">(Ritters et al. 1995)</span>. Landscape statistics measuring sprawl and frangmentation include landscape shape index (LSI), aggregation index (AI) contiguity index (CI) and centrality index (CTI). Together, they allow for comparison of landscape, spatial patterns of change and overall spread <span class="citation">(Sun et al. 2014)</span>. More details on landscape metrics can be found in section 4.16 of <span class="citation">Lee et al. (2015)</span>, among other references previously stated.</p>
<h3 id="sec:metricsmultrunscont"><span class="header-section-number">4.4.3</span> Aspatial metrics to summarize results and agreements of continuous maps</h3>
<p>A handy strategy if to <strong>discretize the continuous data</strong>, by sorting the dataset into categories corresponding to ranges of values. This allow to use all the metrics discussed above (section ) for comparison. However, the arbitrary classification will impact the results. For a reliable metric, it is therefore necessary to do several different classication (i.e discretize the dataset with different limits/size of categories). This approach, in the fields of statistics and image processing, has been refered to as bining, defined as grouping continuous values into bins <span class="citation">(Wikipedia 2016)</span>.</p>
<h4 id="sec:comp_stat_cont_2"><span class="header-section-number">4.4.3.1</span> Between 2 maps</h4>
<h4 id="aggregation-of-cells-values-sum-or-mean" class="unnumbered">Aggregation of cell’s values: sum or mean</h4>
<p>Each map can be summarized with a value aggregating cell’s values. For example, for an objective score map, the overall objective score of the map is the sum of the pixel’s scores. The average could also be used to aggregate. Once each map has an aggregated “summary value”, these can be substracted to reflect the numerical difference in ES between 2 scenarios.</p>
<h4 id="statistical-tests-to-summarize-variance-todo---unsure---made-up---like-average-of-difference-between-corresponding-pixels-normalized" class="unnumbered">Statistical tests to summarize variance ? <em>(todo - unsure - made-up - like average of difference between corresponding pixels, normalized ?)</em></h4>
<p>Disagreement between two maps can be summarized by their variance, i.e the normalized average of corresponding cell’s squared difference: <span class="LaTeX">$$\sum_{cells} (v_1 - v_2)^2$$</span> where <span class="LaTeX">$v_1, v_2$</span> would be the same cell’s value in <span class="LaTeX">$Map_1, Map_2$</span>, possibly weighted by the relative importance of the cell (for example, the population if displaying results related to beneficiaries). <em>(bpb - todo - unsure - made-up -couldn’t find literature)</em>. This is just an idea, however, references to a least squares method have been found in litterature, refering to it as a conventional approach, which would be to compute the least square on the plotted points (Pontius, 2008).</p>
<h4 id="correlation-coefficients" class="unnumbered">Correlation coefficients</h4>
<p>Statistical indices like the Bivariate Moran’s I or LISA (Local indicators of spatial association) aim to measure spatial autocorrelation between 2 variables in a same location <span class="citation">(Matkan et al. 2013)</span>, which can correspond to two runs of the same variable. The field of spatial statistics digs more into these metrics.</p>
<p>Other non-spatial correlation coefficients also exist. An example is the <strong>Pearson linear correlation</strong>: <span class="LaTeX">$$\rho _{X,Y}={\frac {\operatorname {cov} (X,Y)}{\sigma _{X}\sigma _{Y}}}$$</span> It ranges from -1 (negative linar correlation) to +1 (positive linear correlation), and 0 corresponds to maps not correlated, or its variant, the reflective correlation.</p>
<h4 id="sec:comp_stat_cont_many"><span class="header-section-number">4.4.3.2</span> Between many maps</h4>
<p>Besides discretizing the data and then using methods from , the solution would be an aggregation of aggregated map values. As mentioned above, each map can be summarized with a value aggregating cell’s values. For example, for an objective score map, the overall objective score of the map is the sum of the pixel’s scores. A second aggregation can follow: for example, the mean of these overall objective scores will give an indication of average total objective score of scenarios. (This could be interesting when comparing different subsets of runs). (bpb: is this super unclear? refers to agreement value plotted in webapp!)</p>
<p>Measures of dispersion (<em>e.g ? todo - bpb</em>) are also interesting in this context, especially when comparing across two <em>populations</em> of maps (e.g one set generated under the assumption of a climate change scenario, another set under a different assumption).</p>
<h3 id="sec:scale"><span class="header-section-number">4.4.4</span> Influence of scale in map comparison</h3>
<p>(<em>bpb, lacking info for this section</em>) Questions of interests in the context of natural capital : Consistency of spatial patterns in pixel data, at coarser resolution</p>
<p>The question of scale was briefly noted when mentioning the hierarchical fuzzy pattern matching algorithm. Pontius explores the influence of resolution in map comparison <span class="citation">(Pontius et al. 2008)</span>, by conducting comparisons at multiple scales. He notes that the format of the data (the resolution considered) impacts tremedously the results which sometimes are more due to this format, than the underlying mandscape patterns. <em>todo point out to good references in geostatistics, dealing with scale effects</em></p>
<h2 id="sec:uncertainty"><span class="header-section-number">4.5</span> Uncertainty</h2>
<blockquote>
<p><em>“Finding ways to accurately and effectively represent uncertainty is one of the most important challenges in data visualization today. And it’s important to know that visualizing uncertainty in general is extremely difficult to do.”<br />
<span class="citation">(Torres 2016)</span></em></p>
</blockquote>
<h3 id="introduction-to-uncertainty-sensitivity-analysis-visualization"><span class="header-section-number">4.5.1</span> Introduction to uncertainty &amp; sensitivity analysis visualization</h3>
<p>It is often of interest to analysts to consider how input uncertainty and model structure affect the precision and robustness of findings. Uncertainty may arise from modeling choices, parameters (see in particular section ) or predicted variables (e.g future climate conditions). The inclusion of uncertainty estimates improves decision making <span class="citation">(Reichert and Borsuk 2005)</span> and <span class="citation">(Beven 2006)</span>. Because ecosystem services depends on unique landscape characteristics, each case is unique and different procedures can be specifically chosen to generate summaries of robustness and sensitivity <span class="citation">(Ligmann-Zielinska et al. 2014)</span>. However, uncertainty is often just ignored in the representation, because it is challenging to visualize <span class="citation">(Torres 2016)</span>. Conveying both statistical and data uncertainties is nevertheless essential to an exhaustive communication of results.</p>
<div class="figure">
<img src="images/UA_SA-lig14.png" alt="Figure 19: Uncertainty analysis and sensitivity analysis useless figure? bpb (Ligmann-Zielinska et al. 2014)" id="fig:SAoo" />
<p class="caption">Figure 19: Uncertainty analysis and sensitivity analysis <em>useless figure? bpb</em> <span class="citation">(Ligmann-Zielinska et al. 2014)</span></p>
</div>
<p>Closely related concepts must be distinguished: uncertainty analysis (UA) aims to explore the variability of the results; whereas sensitivity analysis (SA) explores the factors responsible for such variability. Robustness is considered when conducting uncertainty analysis; defined as “the ability of a system to resist change without adapting its initial stable configuration” <span class="citation">(Wieland and Marcus Wallenburg 2012)</span>, it can be understood as insensitivity to changes <span class="citation">(Maier et al. 2016)</span> or also a function of performance under many states of the world. In the context of decision making, a decision is qualified robust if not vulnerable to changes, i.e if it leads to the desired outcomes under different states of the world. However, the concept of robustness is somehow vague, and cover several interpretations overlapping with UA and SA. For example, assessing the robustness of many runs resulting from uncertain inputs or model assumptions can be considered as a sensitivity analysis <span class="citation">(Pianosi et al. 2016)</span>.</p>
<p>In the context of this study, the state-of-the art research will limit to scalar data, leaving aside data types that are rarely encountered in the context of natural capital information such as 3D datasets, that are further explored by <span class="citation">(Ken Brodlie and Lopes 2012)</span>.</p>
<h3 id="sec:uncert_aspat"><span class="header-section-number">4.5.2</span> Non-spatial data uncertainty displays</h3>
<p>Not only does uncertainty adds a dimension to the visualization, it is especially complex because it depends directly on the data itself, and also because uncertainty propagates, i.e if the data is transformed to be visualized, its underlying uncertainty propagates, not necessarly in a trivial way <span class="citation">(Carlos D. Correa and Ma 2009)</span>. Uncertainty can be presented in different ways : as a function of the data, (as a PDF, as a multi-value data), as bounded data…</p>
<p>For one dimensional scalar data, uncertainty can be represented with <strong>error bars</strong> <span class="citation">(Ehlschlaeger et al. 1997)</span>. <strong>Box plots</strong> are also common to express variability by showing the quartiles. An extension of these are the <strong>violin plots</strong>, additionally displaying the probability density (kernel density estimation) of the data at each value <span class="citation">(Hintze and Nelson 1998)</span>.</p>
<p><strong>Contouring</strong> by displaying around the mean an indication of the spread, or the standard deviation, allow to visualize the range among which the variable can locate <span class="citation">(Ken Brodlie and Lopes 2012)</span>. This is common for time-series datasets.</p>
<h3 id="sec:uncert_non_maps"><span class="header-section-number">4.5.3</span> Spatial data uncertainty metrics</h3>
<p>Many ES analysts came ot the conclusion that uncertainty seems best understood in an aspatial manner, as spatial representations can often be difficult to digest. Visualizing uncertainty has generally been handled via tabular representations or in a narrative format (according to survey answers). In this context, summary metrics are necessary.</p>
<p>In general for uncertainty analysis, two statistics are very relevant to display: a measure of central tendency, such as the mean, and an indicator of dispersion, for example the variance <span class="citation">(Ligmann-Zielinska et al. 2014)</span>, but also extrema (minimum and maximum), and standard deviation; these measures of range are the most relevant when dealing with deep uncertainty (see also <span class="citation">Hadka et al. (2015)</span>).</p>
<p>There are also specific measures for robustness, based on the amount of times, accross many runs in different states of the world, leading to desired solutions, i.e the cases where all criterias are met. Robustness measures of two types: <strong>regret and satisficing measures</strong>. The former seek to minimize expected loss, that is differences from an ideal solution due to deep uncertainties; the latter seek to maximize the good solutions <span class="citation">(Hadka et al. 2015)</span>. Robustness of an output is contingent upon the consistency between multiple runs leading to this output, under varying conditions. Therefore, spatial metrics measuring agreement between multiple runs, as detailed in sections  and  can be used for assessing robustness, and will not be repeated here, to avoid redundancy. Furthermore, there is an approach specific to robustness in the context of decision making. Methods based on the <strong>breakeven point</strong> inquire about the magnitude of change that would result in changing the decision. The breakeven ratio is defined as the prioritization score of the best choice over the prioritization score of the second best choice. This metric applied to spatial data result in prioritization score breakeven maps, which are efficient displays of how much the prioritization score of the chosen category would need to be reduced before switching to the second best category <span class="citation">(Bryant et al. n.d.)</span></p>
<h3 id="sec:uncert_maps"><span class="header-section-number">4.5.4</span> Spatial data uncertainty map displays</h3>
<p>The most common static visualization techniques for spatial data uncertainty include:</p>
<h4 id="juxtaposition-of-an-uncertainty-map" class="unnumbered">Juxtaposition of an uncertainty map</h4>
<p>That is adding a separate similar figure to represent uncertainty, alongside the representation of the data.</p>
<h4 id="overlaying-an-uncertainty-variable" class="unnumbered">Overlaying an uncertainty variable</h4>
<p>Overlaying a visualization of uncertainty on top of the main one. <span class="citation">(Bingham and Haines 2006)</span> overlays a contour map of an error field on top of a heatmap of the mean value of a multivalue dataset, but it is not so straightforward. Integrating additional geometrical objects, such as labels, volume rendered thickness, or error bars may express uncertainty <span class="citation">(Griethe and Schumann 2006)</span>. Circular glyphs and ribbons have been designed, in the context of weather forecast ensemble data, to visualize uncertainty <span class="citation">(Sanyal et al. 2010)</span>.</p>
<h4 id="modifying-the-displayed-variable-to-account-for-uncertainty" class="unnumbered">Modifying the displayed variable to account for uncertainty</h4>
<p>Varying the value of a free graphical variable, such as a property of the color palet used to visualize the main data can also express uncertainty. The first option is <strong>“blurring”</strong>: the focus is adapted proportionally to the level of uncertainty, this can be done through one of these parameters : contour crispness (« fuzzyness »), fill clarity, fod or resolution <span class="citation">(Maceachren 1992)</span>. Formally, blurring is defined as removing spatial high frequency details <span class="citation">(Russ 1995)</span>. <strong>Saturation</strong> is the second option, uncertainty is expressed by paleness, also referred to as whiteness <span class="citation">(Hengl 2003)</span>. More options include texture and edge crispness variations, overall all these solutions are more intuitive but less precise <span class="citation">(Griethe and Schumann 2006)</span>.</p>
<div class="figure">
<img src="images/uncert.png" alt="Figure 20: Examples of uncertainty displays for a spatial variable: (a) blurring by Maceachren (1992) (b) whiteness by Hengl (2003)" id="fig:uncert" style="width:40.0%" />
<p class="caption">Figure 20: Examples of uncertainty displays for a spatial variable: (a) blurring by <span class="citation">Maceachren (1992)</span> (b) whiteness by <span class="citation">Hengl (2003)</span></p>
</div>
<h4 id="agreement-maps" class="unnumbered">Agreement maps</h4>
<p>Techniques for comparison of multiple spatial runs, such as frequency maps or spaguetti plots, can be applied in the context of uncertainty. See section .</p>
<h4 id="interactive-options" class="unnumbered">Interactive options</h4>
<p>In dynamic visualization, uncertainty representation can be more easily achieved. A swap button can allow the user to visualize successively the main data and its associated uncertainty on the same background map, allowing easier interpretation, with the possibility of going back and forth. This method is referred to as <strong>toggling</strong> <span class="citation">(Aerts et al. 2003)</span>. Other interactive options include the <strong>clickable map</strong>, where uncertainty information displays upon click <span class="citation">(Wel et al. 1998)</span>. There has also been attempts to express imprecision dynamically adressing human senses via vibrations proportional to the level of uncertainty <span class="citation">(Brown 2004)</span>, or smooth animation of sequence of different realizations of a model <span class="citation">(Ehlschlaeger et al. 1997)</span>. There have even been attempts to display uncertainty by adding another dimension via sounds <span class="citation">(S.K. Lodha and Sheehan 1996)</span><span class="citation">(Fisher 1994)</span>. Another solution to convey accuracy is probabilistic animation : the uncertain points appear and disapear according to their accuracy, i.e the probability domain is sampled over time <span class="citation">(Lundstrom et al. 2007)</span>.</p>
<h4 id="maps-of-uncertainty-metrics-per-pixel-stack" class="unnumbered">Maps of uncertainty metrics per pixel stack</h4>
<p>Another strategy is to combine uncertainty metrics with maps, by displaying statistics calculated across cell stacks (a cell-wise function applied to each element of the map stack). For example, a map could show measures of dispersion like standard deviation or extremum, or measure of robustness such as the amount of time the cell has value in a certain range (for continuous data) or is assigned to a specific category (for categorical data). This approach has been considered, with the example of the Shannon diversity index, in section .</p>
<p><br />
  The techniques described above were mainly developed for continuous data, but can be adapted to categorical data. However specific techniques for categorical spatial data exist. In the context of landcovers, prioritization score maps express the effiency of a landcover/activity with regards to an objective <span class="citation">(Bryant et al. n.d.)</span></p>
<h3 id="sec:SA"><span class="header-section-number">4.5.5</span> Parametric uncertainty: sensitivity analysis displays</h3>
<p>Sensitivity analysis aims to understand the influence of the inputs, and their uncertainty, on the outputs and their uncertainties of a model <span class="citation">(Pianosi et al. 2016)</span>. To visualize the input/output relationship, a common and direct way is a <strong>scatterplot</strong> (for each input parameter, with input parameter considered on x-axis and the output on y-axis), the relationship is explicitly revealed, especially in the case of strctured dependencies. This corresponds to the so-called O(F)AT (one factor at a time) method <span class="citation">(Hamby 1994)</span>, e.g <span class="citation">(Murphy et al. 2004)</span>. However, with a high number of inputs, scatterplots can become cumbersome. Then, partial derivative of the output by one factor can be displayed to assess the impact of small perturbations; however it explores only locally the input space around a baseline. Other metrics such as the percentage of output change per percentage of input change, or sensitivity indices are also used. More details can be found in <span class="citation">(Hamby 1994)</span>.</p>
<p><strong>Line plots</strong> express sensitivity analysis by showing the impact of change in an input parameter the output variable: the most horizontal the line is, the less sensitivity to the considered parameter. <strong>Spiderplots</strong><a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a> are an upgrade of the line plot, to combine several factors. They display the total impact of factors, and highlight their relative importance. Additionally they include limit values and impact on output of each input, and also the amount of change in input leading to breakeven point. However, the amount of factors displayed is limited (to about 7 according to <span class="citation">Eschenbach (1992)</span>). These are 2D plots, with percentage of change from baseline on x-axis, and output values on y-axis, and several lines corresponding to each input.</p>
<p>Variance decomposition is another approach to sensitivity analysis; then <strong>pie charts</strong> displaying variance partitions are a good alternative <span class="citation">(Lee et al. 2015)</span>. By opposition to trying to display the impact of each inputs, variance-based method focus on finding the most influencing factors. The output variance is decomposed into parts corresponding to the contribution of each input, therefore displaying its impact on total variance <span class="citation">(Homma and Saltelli 1996)</span>. Pie charts are widely used mostly because they are easy to build and understand. They are effective for small datasets (less than 6 segments of notably different sizes), and if segments are ordered according to size <span class="citation">(Todd 2016)</span>. Because only effective on small datasets, and inadequate for comparisons (between several pie charts), partisans of high density space-effective displays, like Tufte, argue against these charts.</p>
<p><strong>Tornado diagrams</strong> are also used to visualize the total impact of factors, and highlight their relative importance <span class="citation">(Eschenbach 1992)</span>. They are horizontal bar charts corresponding to each input, plotted on the axis of output values. <span class="citation">Pianosi et al. (2016)</span> gathers examples of helpful visualization tools for global SA (see her Appendix A).</p>
<p><strong>Radial convergence diagrams</strong> arrange input parameters in logical groups around a circle, and express, for each input its influence on output, and interactions with other input prameters. The size of inner circle of each input is proportional to its direct influence. The size of the outer circle (ring) reflects its total influence (including interactions). The interactions are reflected by the lines connecting the input parameters, the lines’ width reflects the extent of the interaction <span class="citation">(Pianosi et al. 2016)</span>.</p>
<p><strong>Pattern plots</strong> are similar to temporal maps (section ) for sensitivity analysis. A color scale reflects the output sensitivity for each pair of inputs. On figure e, the input parameters are listed vertically, and the study sites horizontally. Here, the study sites are listed according to another parameter (climate conditions), therefore facilitating visual understanding of trends <span class="citation">(Pianosi et al. 2016)</span></p>
<div class="figure">
<img src="images/SA_overall.png" alt="Figure 21: Examples of plots to express sensitivity analysis (a) Line plot shows the impact of change in an input parameter (ETo) on the output variable (water yield) (Vogl et al. 2014). (b) Spiderplot (ref todo) (c) Tornado diagram (ref todo) (d) Expressing sensitivity analysis through variance decomposition, with box plots and pie charts by Ligmann-Zielinska et al. (2014). (e) Radial convergence diagram, displaying Sobol sensitivity results for 30 parameters grouped in 10 categories, from Butler et al. (2014). (f) Pattern plot, evaluating sensitivity for 12 watersheds and 14 parameters, using the Sobol sensitivy index over a 38-year period, by Werkhoven et al. (2008). See also Pianosi et al. (2016), Appendix A." id="fig:SA" />
<p class="caption">Figure 21: Examples of plots to express sensitivity analysis (a) Line plot shows the impact of change in an input parameter (ETo) on the output variable (water yield) <span class="citation">(Vogl et al. 2014)</span>. (b) Spiderplot (ref todo) (c) Tornado diagram (ref todo) (d) Expressing sensitivity analysis through variance decomposition, with box plots and pie charts by <span class="citation">Ligmann-Zielinska et al. (2014)</span>. (e) Radial convergence diagram, displaying Sobol sensitivity results for 30 parameters grouped in 10 categories, from <span class="citation">Butler et al. (2014)</span>. (f) Pattern plot, evaluating sensitivity for 12 watersheds and 14 parameters, using the Sobol sensitivy index over a 38-year period, by <span class="citation">Werkhoven et al. (2008)</span>. See also <span class="citation">Pianosi et al. (2016)</span>, Appendix A.</p>
</div>
<p>This section focused on visualization, but there are many ways to conduct a sensitivity analysis, using landscape comparison metrics described in section , or through the Wilcoxon signed rank test assessing significance of mean differences (see@Sun14). Furthermore, sensitivity analysis packages exist in multiple programming languages (e.g SAlib for python, sensitivity for R).</p>
<h2 id="summary"><span class="header-section-number">4.6</span> Summary</h2>
<h3 id="key-take-aways"><span class="header-section-number">4.6.1</span> Key take-aways</h3>
<p>With no pretention of being exhaustive, this chapter gathers strategies to display complex data in the context of ecosystem services model outputs. It took inspirations from the current data visualizations in different fields, such as agent-based modeling and ensemble data sets.</p>
<p>Overall, combining multiple linked displays seems to be necessary as complexity and number of dimensions increase, as argues <span class="citation">K. Potter et al. (2009)</span> in the context of gaining insight on distribution of spatio-temporal simulation results, as well as the associated uncertainty. Arranging many views is also relevant to facilitate comparisons <span class="citation">(Buja et al. 1996)</span>. Some of the most successful visualizations currently used combine interactive features and multiple linked views to deliver broad information in an organized an straight-forward way, as exemplified by The Middle Cedar Visualization, in figure , <span class="citation">(Hawthorne 2016)</span>.</p>
<p>The examples, guidelines and suggestions gathered above aim to support creation of effective visualizations. Nevertheless, the main thing to keep in mind is that graphs are here to support conveying the data’s message; i.e visualizations should always be tailored to the specific need and dataset. The final visualization needs to be adapted to fit the document type and format, the audience adressed and will also depend on the functionalities of the charting tool used.</p>
<p>On the whole, each visualization is very <strong>context specific</strong>, therefore there is no perfect solution adapted to every case.</p>
<h3 id="resources"><span class="header-section-number">4.6.2</span> Resources</h3>
<h4 id="examples-and-inspiration"><span class="header-section-number">4.6.2.1</span> Examples and inspiration</h4>
<ul>
<li><a href="http://msp.naturalcapitalproject.org/msp_concierge_master/">The Gallery of the Marine Planning Concierge Tool</a></li>
<li><a href="http://flowingdata.com/">Flowing data: Data visualization ideas in blog format</a></li>
<li><a href="http://preview.weather.gov/edd/">Weather forecast: the NWS enhanced Data Display</a></li>
</ul>
<div class="figure">
<img src="images/addl.png" alt="Figure 22: Additional examples (a) To compare 3 ES metrics between 4 scenarios, Arkema et al. (2015) combines small multiples of objective score maps, with summary statistics and bar plots. (b) Change map displaying the amount of additional sediment export (in percentage) comparing a future scenario with the current baseline one (Mandle et al. 2016). (c) On a static display, Nelson et al. (2008)’s strategy consists in displaying only the extreme points of the trade-off curve. (d) Change in services for all scenarios and iterations relative to current management Arkema et al. (2015)" id="fig:addl" />
<p class="caption">Figure 22: Additional examples (a) To compare 3 ES metrics between 4 scenarios, <span class="citation">Arkema et al. (2015)</span> combines small multiples of objective score maps, with summary statistics and bar plots. (b) Change map displaying the amount of additional sediment export (in percentage) comparing a future scenario with the current baseline one <span class="citation">(Mandle et al. 2016)</span>. (c) On a static display, <span class="citation">Nelson et al. (2008)</span>’s strategy consists in displaying only the extreme points of the trade-off curve. (d) Change in services for all scenarios and iterations relative to current management <span class="citation">Arkema et al. (2015)</span></p>
</div>
<div class="figure">
<img src="images/peter.png" alt="Figure 23: The Middle Cedar visualization is an interactive webapp, developed by Hawthorne (2016), who combined a scatterplot, a map, a pie chart and summary statistics in a single dashboard. It allows users to click on each point of the trade-off curve, and the corresponding land cover map will be displayed. Additionally, summary metrics and a pie chart provide information relative to the scenario chosen upon click(Hawthorne 2016)" id="fig:Peter" style="width:70.0%" />
<p class="caption">Figure 23: <a href="https://phawthorne.github.io/mc-vis/">The Middle Cedar visualization</a> is an interactive webapp, developed by <span class="citation">Hawthorne (2016)</span>, who combined a scatterplot, a map, a pie chart and summary statistics in a single dashboard. It allows users to click on each point of the trade-off curve, and the corresponding land cover map will be displayed. Additionally, summary metrics and a pie chart provide information relative to the scenario chosen upon click<span class="citation">(Hawthorne 2016)</span></p>
</div>
<div class="figure">
<img src="images/consdash.png" alt="Figure 24: Extract of the Conservation ROI Dashboard, gathering and comparing ROI projects accross the US" id="fig:ConservationROIDashboard" />
<p class="caption">Figure 24: Extract of the <a href="http://nascience.us/roi/public/">Conservation ROI Dashboard</a>, gathering and comparing ROI projects accross the US</p>
</div>

<h4 id="useful-tools"><span class="header-section-number">4.6.2.2</span> Useful tools</h4>
<p>Color palette pickers, to help choose a color theme:</p>
<ul>
<li><a href="http://colorbrewer2.org/">Colorbrewer</a>, with an emphasis on maps and colorblind-friendly schemes</li>
<li><a href="http://colrd.com/palette/">Colrd</a>, collaborative more designer-oriented website</li>
<li><a href="https://color.adobe.com">Adobe Kuler</a></li>
</ul>
<p>Parallel coordinates plots resources:</p>
<ul>
<li><a href="https://reed.cee.cornell.edu/parallel-axis/">Ready-to-use parallel coordinates graph for multi dimensional data</a></li>
<li><a href="http://syntagmatic.github.io/parallel-coordinates/">Code to build a parallel coordinates plot in javascript with D3.js</a></li>
<li><a href="https://waterprogramming.wordpress.com/2016/09/12/easy-vectorized-parallel-plots-for-multiple-data-sets/">Explanations to build a parallel coordinates plot in Python</a></li>
<li><a href="https://github.com/OpenMORDM">R package for Multi-objective Robust Decision Making, including parallel coordinates plot and 3D scatterplot (linked together)</a></li>
<li><a href="https://cran.r-project.org/web/packages/alluvial/vignettes/alluvial.html">To make alluvial (categorical version of parallel coordinates) plot: R package <em>alluvial</em></a></li>
</ul>
<p>Analysis of spatial data with Python:</p>
<ul>
<li><a href="https://pypi.python.org/pypi/pygeoprocessing">PyGeoprocessing: geoprocessing routines for GIS</a></li>
<li><a href="http://sensitivecities.com/so-youd-like-to-make-a-map-using-python-EN.html#.WCJPDvkrJhE">A well written blogpost about maps in Python</a></li>
<li><a href="http://www.datadependence.com/2016/06/creating-map-visualisations-in-python/">and another one on the same topic</a></li>
<li><a href="http://matplotlib.org/basemap/users/examples.html">Basemap examples</a>.</li>
</ul>
<p>Analysis of spatial data with R:</p>
<ul>
<li><a href="https://cran.r-project.org/web/views/Spatial.html">overview of analysis of spatial data</a></li>
<li><a href="https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf">Illustration of the <em>ggmap</em> package</a></li>
<li><a href="https://cran.r-project.org/web/packages/raster/vignettes/Raster.pdf">Introduction to the <em>raster</em> package</a></li>
<li><a href="https://oscarperpinan.github.io/rastervis/">Introduction to the <em>RasterVis</em> package, built on top of <em>raster</em> package</a></li>
</ul>
<p>Other geovisualization platforms:</p>
<ul>
<li><a href="http://geoawesomeness.com/top-19-online-geovisualization-tools-apis-libraries-beautiful-maps/">A list of 19 online geovisualization tools</a></li>
<li><a href="https://www.mapbox.com/">Mapbox (API and libraries)</a></li>
<li><a href="https://carto.com/">Carto (web platform)</a></li>
<li><a href="http://leafletjs.com/">Leaflet (JavaScript library)</a></li>
<li><a href="https://mapzen.com/">Mapzen (API)</a></li>
</ul>
<p>Sensitivity analysis:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/sensitivity/index.html">with R: <em>sensitivity</em> package</a></li>
<li><a href="https://github.com/SALib/SALib">with Python: <em>SAlib</em> library</a></li>
</ul>
<p>Layout and design:</p>
<ul>
<li><a href="http://www.sumopaint.com/home/">Image editor and layour tool online</a>, a free alternative to Photoshop</li>
</ul>

<h3 id="sec:table"><span class="header-section-number">4.6.3</span> Summary table for specific display needs</h3>

<h1 id="sec:TheTool"><span class="header-section-number">5</span> An innovative tool to display natural capital results</h1>
<p><em>Chapter 5 still draft to do !</em></p>
<h2 id="sec:survey_results"><span class="header-section-number">5.1</span> Motivation and analysis of the need</h2>
<p>While exploring the design strategies to display natural capital assessments results, in the previous chapter, several areas of improvements and gaps were brought to light. Ecosystem services analysts also stated their display strategies needs in the context of the conducted survey. As detailed in , the respondents assessed for each listed display task: its usefulness in general, and the need for an improved implementation with a score from 0 to 5; 5 meaning very useful.</p>
<h3 id="survey-results-quantitative-prioritization-of-display-needs"><span class="header-section-number">5.1.1</span> Survey results: quantitative prioritization of display needs</h3>
<p>Method (A): A rough assessment of the most important needs consists in selecting the needs that received <strong>average scores strictly above 4, both in terms of general usefulness and need for implementation</strong>. The selection results in 8 display needs, belonging to 5 of the 6 different categories.</p>
<p>Method (B): Another approach is to define the most important needs as the ones which received <strong>the most 5s in terms of need for implementation</strong>, i.e the display needs for which many analysts really need a new solution. Selecting the top 10% of the display needs, ranked by the number of 5s received results in 9 display needs, among which 7 overlapped with the previous selection.</p>
<p>The 7 display needs selected through both the top average scores (A), and the maximum of top scores in term of implementation need (B) are considered to be the priority. The present tool aims to answers these display needs, namely:</p>
<ol style="list-style-type: decimal">
<li>Compare many portfolios [both “pairwise” selecting pairs to look at, and also summarizing multiple]</li>
<li>Understand similarity and differences between many pixel-based maps</li>
<li>Location of synergies of intervention/scenario on multiple ES metrics</li>
<li>Location of tradeoffs of intervention/scenario on multiple ES metrics</li>
<li>Understand trade-offs and synergies between &gt; 3 objectives under small number of scenarios</li>
<li>Characterize uncertainty in spatial model output - derived from multiple runs</li>
<li>Show/quantify beneficiaries impact by subgroups</li>
</ol>
<h3 id="survey-results-qualitative-analysis-of-comments-and-interviews"><span class="header-section-number">5.1.2</span> Survey results: Qualitative analysis of comments and interviews</h3>
<p>Additionally to the scores, respondents were allowed to provide comments, and interviews were conducted on specific use cases, which resulted in important information.<br />
</p>
<p>The interest in an interactive tool was repeatedly expressed, allowing to display and compare portfolios, objective score maps, and also to compare results upon update of ES metrics weights.</p>
<blockquote>
<p><em>“Static maps often do not suit communication needs, and I could really use a ready way to build interactive maps.”</em> Rob</p>
<p><em>“With synergies and tradeoffs it would be amazing to be able to dynamically adjust the weights of ES metrics so that decision makers can visualize the effect of marginal changes in their (or their constituents) values”</em> Ryan</p>
<p>About objective score maps: <em>“we are finding better uptake through use of interactive, user-friendly interfaces”</em> Eric</p>
</blockquote>
<p>Several opportunities for improvements were underlined in the topics of uncertainty and beneficiaries. Although it was noted that the demand for detailed information about uncertainty rarely arises from the stakeholders, several respondents suggested to create this demand, as they considered important and interesting to display the results’ underlying uncertainty.</p>
<h3 id="summary-of-the-need-design-question"><span class="header-section-number">5.1.3</span> Summary of the need: design question</h3>
<p>These results lead to following design question, that the suggested tool aims to begin adressing. <strong><em>How can we compare many scenarios (via their portfolios and other relevant maps), identify the locations of synergies or trade-offs between several ES objective, and have an indication of the effect of uncertainty?</em></strong></p>
<h2 id="design"><span class="header-section-number">5.2</span> Design</h2>
<h3 id="goal"><span class="header-section-number">5.2.1</span> Goal</h3>
<p>The web application allows visualization of tradeoffs between objectives, comparison of scenarios and assessment of uncertainty in an interactive dashboard with multiple linked views. Users can select one or a subset of solutions and all plots will update dynamically to match selection.</p>
<p>In between communication and exploratory purposes, this tool aims to be first introduced by the analyst who has generated the results. Then, the audience such as stakeholders, once familiarized with the functionning of the tool, can further explore the dataset, refering to the onIine tool. It is not fully self-explanatory, but the interpretation is supported by multiple help buttons providing information on the data structure.</p>
<h3 id="use-case-and-design-process"><span class="header-section-number">5.2.2</span> Use case and design process</h3>
<p>The proposed tool takes the form of a dashboard, combining multiple linked plots (see ) which allow to explore interactively the results. Design choices are based on the knowledge of chapters  and . The design of the tool has been refined, specifically for the Upper Tana Waterfund use case, described in . The goal here is to optimize which interventions to undertake in the Upper Tana basin, in order to improve water quality and quantity supplying Nairobi. Three ES objectives are being acted upon:</p>
<ul>
<li>maximize annual water yield (AWY),</li>
<li>minimize sediment reaching streams (SDE)</li>
<li>minimize soil loss for agricultural productivity (SDL)</li>
</ul>
<p>About 800 scenarios were generated, arising from parametric uncertainty (4 parameters with 2 to 4 possible values) and 15 combinations of objectives weights.</p>
<p>The design process is iterative. Dataset specifications and additional features were considered throughout the process. Several version of design documents and templates led to the current proposed one.</p>
<h3 id="tour-of-the-dashboard-and-main-features"><span class="header-section-number">5.2.3</span> Tour of the dashboard and main features</h3>
<p><em>A screenshot of the web app needed here? (todo)</em><br />
<br />
<strong><a href="https://charlottegiseleweil.github.io/webviz_natcap/">Link to the tool prototype online</a></strong></p>
<p>The dashboard consists of mutiple linked views of the dataset. Brushing and linking options (defined in ) allow to connect the different plots: upon selection of a subset of solutions in any of the views, all the others update automatically to display results of this selection. The visualization includes five main elements:</p>
<h4 id="parallel-coordinates-plot" class="unnumbered">Parallel coordinates plot</h4>
<p>Parallel coordinates plot displays the tradeoffs between the ES objectives (vertical axis), for each scenario (represented as lines). The values plotted correspond to the overall aggregated objective score, for the scenario considered (i.e the sum of all pixels’ scores for this objective, across the raster). Features include:</p>
<ul>
<li>Select a subset of solution : by brushing on any axis</li>
<li>Flip axis direction: upon double clicking on their name.</li>
<li>Re-order axis: by dragging them.</li>
</ul>
<h4 id="sliders" class="unnumbered">Sliders</h4>
<p>Sliders control the parameters corresponding to the different scenarios generated. The varying parameters are (1) relative objective weights and (2) model input parameters subject to uncertainty. Varying these parameters led to the generation of the scenarios: the models were runned with different combinations of objective weights and parametric uncertainty values.</p>
<ol style="list-style-type: decimal">
<li>The objective weights corresponds to the importance given to each ES objective, in each run, they sum to 100% In this case, 15 combinations of objective weights were considered<a href="#fn17" class="footnoteRef" id="fnref17"><sup>17</sup></a>.</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Several model input parameters are subject to uncertainty. To account for this, the model is run for several possible values of each uncertain parameter. In this case, the uncertain model input parameters are :</li>
</ol>
<ul>
<li>the seasonality factor, Z is an empirical constant used to calculate the AWY in the <a href="http://data.naturalcapitalproject.org/nightly-build/invest-users-guide/html/reservoirhydropowerproduction.html#summary">InVEST annual water yield model</a>. It captures the local precipitation pattern and additional hydrogeological characteristics. No unit.</li>
<li>the soil erodibility value, K is used to calculate the amount of annual soil loss in the <a href="http://data.naturalcapitalproject.org/nightly-build/invest-users-guide/html/sdr.html#summary">sediment retention InVEST model</a>. It measures the susceptibility of soil particles to detach and transport by rainfall and runoff. Unit is <span class="LaTeX">$ton*ha*hr/(MJ*ha*mm)$</span>.</li>
<li>A binary spatial parameter, relative to the chosen biophysical table. Terrestrial InVEST models generally require a “biophysical table” that maps values for various parameters to each land cover class. This toggle switches between between the default “biophysical table” constructed for Tana, and one with alternate parameter settings. It can be thought of more generally as an example of a binary input variable that can be explored dynamically. For example, in another case, it could toggle between incorporation of climate change impacts.</li>
<li>The budget level: this is not itself an uncertain parameter but rather a choice in the optimization. Currently three levels chosen for illustrative purposes (12.5, 25 and 37.5 M USD, presented in Kenyan Shillings at an exchange rate of 50 KSh:USD)</li>
</ul>
<h4 id="scatterplots" class="unnumbered">Scatterplots</h4>
<p>Tradeoff curves display the tradeoffs between each pair of ES objectives. Each plotted point corresponds to a scenario.</p>
<p>The colorscale provides additional information about which value of some uncertain input parameters were used: the orange (respectively blue) points correspond to scenarios generated under the spatial scenario A (respectively B). The color gradient gives an indication of the budget level (a lighter color is a smaller budget). Moreover, lines can be plotted, conecting the dots generated under the same combination of uncertain input parameters values.</p>
<h4 id="dataset-table" class="unnumbered">Dataset table</h4>
<p>The full dataset table can be viewed. It is also linked to the other views: the dataset shrinks to match the selection when a subset of scenarios is chosen (upon brush on the parallel coordinates plot, or a slide over a sub-range of the sliders for example). Upon click on a specific row, this solution is highlighted in all plots (corresponding point in scatterplots, and line in parallel coordinates plot) and the maps corresponding to this scenario are displayed.</p>
<h4 id="maps" class="unnumbered">Maps</h4>
<p>Maps provide an essential view of spatial results. The maps can be calculated from 3 distinct selection cases :</p>
<ul>
<li>for all scenarios: these map show results summarizing all scenarios, they are displayed initially when no selection had occurred.</li>
<li>for a subset of scenarios: these map show results summarizing the scenarios selected through the other views. This situation occurs when the button <em>Calculate map for selection</em> is clicked.</li>
<li>for a single scenario: these maps displays the results corresponding to a specific solution; this occurs upon clicking on the corresponding scenario row in the data table.</li>
</ul>
<p>In total 6 types of maps can be displayed :</p>
<ul>
<li>Current land cover map shows the context. Any categorical map (such as a portfolio) may be overlayed on top.</li>
<li>Portfolio maps display the modal portfolio (for each pixel, the most frequently selected intervention across scenarios selected, see ). For the case of a single scenario display, it shows the corresponding portfolio.</li>
<li>Footprint maps show the areas selected consistenly for interventions, across several scenario. For the case of a single scenario display, it is just the overall footprint of its portfolio.</li>
<li>Agreement maps displays the frequency map of the modal portfolio, expressing consistency between runs (see ). It is not relevant for the case of a single scenario display.</li>
<li>Absolute objective score maps, for each ES objective, display the local objective scores averaged (<em>averaged or summed bpb?</em>) over the selected scenarios.</li>
<li>Marginal objective score maps corresponds to the change in objective score between the current situation and the scenario considered. Therefore they are calculated as the difference between the absolute objective score map of the scenario, and the absolute objective score map of the baseline (current situation).</li>
</ul>
<p>Map control buttons allow to pick the map to be displayed among the 10 possible (the two latter exist for each of the 3 objectives). The legend, as well as corresponding map summary statistics are computed and update automatically. The map window is enhanced with zooming abilities.</p>
<h2 id="implementation"><span class="header-section-number">5.3</span> Implementation</h2>
<h3 id="tools-and-technology"><span class="header-section-number">5.3.1</span> Tools and technology</h3>
<p>To support interactivity and facilitate diffusion, the form of a web application was chosen. The powerful data visualization library <a href="https://d3js.org/">D3.js</a> was used, along with other javascript libraries including <a href="https://dc-js.github.io/dc.js/">Dc.js</a> allowing the crossfiltering features i.e. to connect the data between the different views to support brushing and linking, and <a href="https://www.npmjs.com/package/geotiff">Geotiffs.js</a> to read the rasters.</p>
<p>The input dataset was generated by B. Bryant using InVEST and R <em>(some details on wokflow bpb?)</em>.</p>
<p>Data cleaning and pre-treatment for the specific purpose of the visualization were done in Python, using Pandas library mostly. Webdeveloppment was conducted in Html, Javascript and CSS. The online page is powered by the github pages server. (<em>bpb: remove, obvious?</em>)</p>
<h4 id="raster-on-the-fly-computation-challenge" class="unnumbered">Raster on-the-fly computation challenge</h4>
<p>One of the major innovations of this tool is to support maps on-the-fly computation, so that the user can compute summary maps for a specific selection. In the examples inspiring the development of this tool, this feature had not been found. For example <span class="citation">Hawthorne (2016)</span> pre-loads all maps so that no calculations on the server are needed; compared to his tool, this one also scales up, the amount of loaded maps being an order of magnitude 2 times bigger (from tens to thousands).</p>
<p>Currently, raster on the fly computation has been tested and works well for a small number of maps. The computational speed depends on the number of maps selected, rough orders of magnitude appears to be (for a maps of size of about 150Ko):</p>
<ul>
<li>&lt;10 maps: instantaneous</li>
<li>dozens of maps: &lt;1min</li>
<li>hundreds maps: few minutes</li>
</ul>
<p>Computation capacities could be improved via the use of webworkers, allowing parallel execution of calculations, or webGL. However, this topic is beyond the scope of the present work.</p>
<h3 id="workflow"><span class="header-section-number">5.3.2</span> Workflow</h3>
<p><em>needed?</em></p>
<h2 id="sec:fidback"><span class="header-section-number">5.4</span> Results: prototype, testing, iterations and feedback</h2>
<p><a href="https://charlottegiseleweil.github.io/webviz_natcap/">The prototype can be found online: https://charlottegiseleweil.github.io/webviz_natcap/</a></p>
<p>Several iterations of the prototype where presented to audiences engaging with ecosystem services work to gather feedback.</p>
<p>Feedback on a first version noted the important of putting in context, leading to the enrichment of the help buttons with detailed explanations on both the concept and features. Aditionnally, and introductory page presenting the project in its broader context and the workflow leading to the presented results was added. It displays the 3 watersheds involved in the Tana Waterfund projects and offers an overview.</p>
<p>Feedbacks recurringly noted the <strong>engaging</strong> aspect of this tool, underlining the enthusiasm steming from the interactive features. It was suggested that such as tool would improve the stakeholder’s engagement and interest in the project.</p>
<p><em>Todo</em> Waiting on (fwat) results * Aditionnally, a brief survey was conducted on sample users testing the tool. Four questions were asked:</p>
<ul>
<li>Do you think this type of tool is useful in general ?</li>
<li>Would you use (an improved version of) this tool ?</li>
<li>What would you change in the design concept ?</li>
<li>What do you think is its major asset ? its main area of improvement ?</li>
</ul>
<h2 id="sec:nextstepswebapp"><span class="header-section-number">5.5</span> Next steps</h2>
<h3 id="features-in-alpha-version-remaining-to-be-implemented"><span class="header-section-number">5.5.1</span> Features in alpha version remaining to be implemented</h3>
<ul>
<li>Summary statistics for all map cases</li>
<li>Tailored legend for all map cases</li>
<li><em>Calculate map for selection</em> raster computation for all map cases</li>
</ul>
<h3 id="additonal-features"><span class="header-section-number">5.5.2</span> Additonal features</h3>
<ul>
<li>Chart (pie chart or bar chart) summarizing composition of portfolios</li>
<li>Interactive legend, allowing user to choose colorscheme and legend range</li>
<li>Objective score maps, not only for each ES objective, but also for their weighted combination</li>
<li>Additional map features (besides zooming: add overlay rivers, protected areas etc…)</li>
</ul>
<h3 id="design-improvements"><span class="header-section-number">5.5.3</span> Design improvements</h3>
<ul>
<li>Colorcoding of objectives names to facilitate understanding</li>
<li>Allow to choose the opacity of overlayed maps</li>
</ul>
<h3 id="scaling-up"><span class="header-section-number">5.5.4</span> Scaling up</h3>
<ul>
<li>Server architecture: host the data on a separate server (data engineering considerations)</li>
<li>Raster on-the-fly computation solution (e.g webworkers)</li>
</ul>
<h3 id="building-a-generic-tool"><span class="header-section-number">5.5.5</span> Building a generic tool</h3>
<ul>
<li>Tailored versions for the 4 watersheds in the Tana basin and explanation page</li>
<li>Automatic inclusion of columns names from dataset</li>
<li>Overall adaptation of the tool to allow any similarly formatted dataset as input</li>
</ul>
<h1 id="conclusion-next-steps"><span class="header-section-number">6</span> Conclusion &amp; Next Steps</h1>
<p><em>Chapter 6 still draft to do !</em></p>
<h2 id="summary-1"><span class="header-section-number">6.1</span> Summary</h2>
<p><em>Needed?</em></p>
<h2 id="concluding-remarks-about-the-display-toolbox-on-standardizing-approaches-to-communicate-natural-capital-results"><span class="header-section-number">6.2</span> Concluding remarks about the display toolbox: on standardizing approaches to communicate natural capital results</h2>
<p>As the community is longing for a standardized method to quantify and map ES (<span class="citation">Englund et al. (2017)</span>, <span class="citation">Crossman et al. (2013)</span>, <span class="citation">Martínez-Harms and Balvanera (2012)</span>) (in terms of scale, types of ES…), number of strategies are being developed on the visualization front. Interactive tools are being more and more used and created, as tools to develop them are becoming more and more accessible.</p>
<p>Similarly to <span class="citation">Englund et al. (2017)</span>, it is found to be difficult to generalize one best method. Rather, best practices were suggested in a display “toolbox” (chapters  and ). Approaches are very context dependent. The tools and types of display must be chosen according to the aim, intended audience, analyst skills, data availability, time frame and other factors.</p>
<h3 id="open-questions-and-identified-areas-of-improvement" class="unnumbered">Open questions and identified areas of improvement</h3>
<p>Remain some open questions and areas of improvements were identified. The question of the scale, <strong>the effect of the resolution</strong> chosen on the results can be further explored <em>ref?</em>. Additionnally, the survey noted growing interest in the topic of <strong>beneficiaries</strong>. Not only quantifying the people benefiting from an intervention, but more precisely adding nuance in demographics or social metrics to the analysis, classify by subgroups (e.g which fraction of service benefits accrue to vulnerable populations?) and/or contrast beneficiary distribution in space with service distribution in space. Also, displaying the <strong>impact of intervention on a specific ES metric</strong> could be further investigated. The usual approach looks at the overall change in ES, failing to detail how each intervention impacts each ES metric (i.e where in space does a given intervention or scenario improve or worsen a specific ES metric? e.g Where does an activity contribute to objectives ?)</p>
<h2 id="concluding-remarks-about-developped-web-application-prototype-and-next-steps"><span class="header-section-number">6.3</span> Concluding remarks about developped web application prototype and next steps</h2>
<p><strong>(Todo)</strong> As noted in section , feedback about the tool prototype underlined its engaging aspect. An overview of next steps is detailed in part . An important choice that would need to be considered in moving this project further is about the intended audience. Currently, the tool is both applicable for communication purposes to a broader audiences, and to support data analysis. Two different versions (one simplified for communication, and a more detailed and rigorous for analysis) could be envisioned. Future directions could decide to focus on one or the other intended applications. The analysis tool would need tobe made more generic, while the communciation tool would call for deisng and easthetical considerations. Considerations about sever architecture (hosting the data on a seperate server), and raster on the fly computations will also have to be further explored.</p>
<h2 id="suggestions-for-the-natural-capital-project"><span class="header-section-number">6.4</span> Suggestions for the Natural Capital Project</h2>
<ul>
<li>Showcase successful existing visualizations (e.g the work of Greg Verutes), for example on the website within the <em>stories</em> tab; as these help understanding the scope of natural capital assessments and projects.</li>
</ul>
<h2 id="natural-capital-sustainable-management-great-potential-for-impact"><span class="header-section-number">6.5</span> Natural capital sustainable management: great potential for impact</h2>
<h4 id="a-great-unexplored-potential-and-unmet-demand-for-investment" class="unnumbered">A great unexplored potential and unmet demand for investment</h4>
<p>There is an enormous potential for environmental impact and climate change mitigation through an informed management of natural capital. Natural capital conservation is fully aligned with the <a href="http://www.un.org/sustainabledevelopment/sustainable-development-goals/">17 UN sustainable development goals</a>, and the Paris agreement (<span class="citation">Center for Climate and Energy Solutions (2015)</span>, <span class="citation">Guardian (2015)</span> among others). So called conservation finance (i.e a financial investment that aims to conserve the values of the ecosystem for the long term, as defined by <span class="citation">Huwyler et al. (2014)</span>) has a large unrealized potential, as noted by the same report. The demand for funding is yet significantly unmet<a href="#fn18" class="footnoteRef" id="fnref18"><sup>18</sup></a>, and the private sector opportunities are widely unexploited. Possible causes explaining this unmet demand include:</p>
<ul>
<li><strong>Measurable conservation benefits:</strong> <span class="citation">Huwyler et al. (2014)</span> notes one major problem: the fact that the ROI of this type of projects are hardly measurable, the same report deplores that the benefits are yet to be precisely identified and standardized. However, this is exactly the problem natural capital assessments, among which the ones conducted by The Natural Capital Project, are solving.</li>
<li><strong>Conservation finance still small</strong>: The conservation investment opportunities, especially for the private sector aren’t available at scale. However, banks and asset managers could develop the conversation finance possibilities as part of their impact investment offer. This may actually be a very profitable opportunity, supported by tools such as <a href="http://naturalcapitalcoalition.org/protocol/">the Natural Capital Protocol</a>.</li>
<li><strong>A sector historically reserved to NGOs and philantrophy</strong>: Traditionally, conservation projects have not focused on economical return on investment in the business model type of way, therefore appealing mostly philanthropy, rather than the banking or private sector.</li>
</ul>
<h4 id="moving-forward-linking-the-right-expertise" class="unnumbered">Moving forward: linking the right expertise</h4>
<p>From this constat, it seems to the author that linking the right expertise would allow to bridge the gaps and open the doors to many desired investments and high impact projects: partnering investors looking for long term reliable and meaningful project with cutting-edge scientists modeling the behavior of ecosystems to quantify the costs and benefits from natural capital and its sustainable management. In this context data visualization tools are crucial to connect the complex scientific results to the real world.</p>
<p>Several initiatives are going in this direction, Credit Suisse for example, expressed their long-term intent of creating a conservation finance asset class (<span class="citation">Huwyler et al. (2016)</span> and <span class="citation">Huwyler et al. (2014)</span>). It has been proven to be possible to deliver great conservation impacts while generating returns for investors ((<em>good reference about that by any chance bpb?</em>) and <span class="citation">Huwyler et al. (2014)</span>). Furthermore, <span class="citation">Huwyler et al. (2014)</span> states that <em>“There would be sufficient financial capital available to meet conservation investment needs if the main investor segments globally allocated 1% of their new and reinvested capital to conservation.”</em></p>
<h2 id="engaging-a-broader-audience-into-major-decisions"><span class="header-section-number">6.6</span> Engaging a broader audience into major decisions</h2>
<p>An effective visualization of natural capital assessment results must simplifies its complexity to be understandable, while staying rigorous. It would communicates its point in an engaging way, allowing more actors to get involved in natural capital sustainable management. Many decisions and investments are today left apart, because the actors and investors do not understand the complex problematic, these visualization decision support tools really aims to solve this problem. By involving a broader audience into major decisions, they are a democracy tool ! (<em>okay maybe getting too much there !</em>)</p>
<h1 id="acknowledgements" class="unnumbered">Acknowledgements</h1>
<p>Grant - Zeno Karl Schindler Foundation<br />
{There will be something here}</p>
<h1 id="appendices" class="unnumbered">Appendices</h1>
<div class="figure">
<img src="images/assess_table.png" alt="Figure 25: When Evaluating a Figure for Clarity and Completeness, Consider the Following Questions(Allen et al. 2012)" id="fig:crit2" style="width:80.0%" />
<p class="caption">Figure 25: When Evaluating a Figure for Clarity and Completeness, Consider the Following Questions<span class="citation">(Allen et al. 2012)</span></p>
</div>
<div class="figure">
<img src="images/Fig1.png" alt="Figure 26: Land cover in Pu‘u Wa‘awa‘a under different restoration and climate scenarios. The purple contours on the current land cover map outline the enclosure areas corresponding to the partial restoration scenario. The maps on top correspond to the evolution of land cover, under the current climate for the partial and full restoration scenarios. The maps underneath correspond to the evolution of the land cover, under the RCP 8.5 future climate projection for the partial and full restoration scenarios. (figure by author in Wada et al. (2017, in review))" id="fig:hawaii1" style="width:80.0%" />
<p class="caption">Figure 26: Land cover in Pu‘u Wa‘awa‘a under different restoration and climate scenarios. The purple contours on the current land cover map outline the enclosure areas corresponding to the partial restoration scenario. The maps on top correspond to the evolution of land cover, under the current climate for the partial and full restoration scenarios. The maps underneath correspond to the evolution of the land cover, under the RCP 8.5 future climate projection for the partial and full restoration scenarios. (figure by author in <span class="citation">Wada et al. (2017, in review)</span>)</p>
</div>
<div class="figure">
<img src="images/Fig2.png" alt="Figure 27: Impact of restoration on groundwater recharge in Pu‘u Wa‘awa‘a. The green contours outline the enclosure areas corresponding to the partial restoration scenario in which only these regions undergo some changes. Blue corresponds to an increase in groundwater recharge due to restoration, and red corresponds to a decrease. (figure by author in Wada et al. (2017, in review))" id="fig:hawaii2" style="width:80.0%" />
<p class="caption">Figure 27: Impact of restoration on groundwater recharge in Pu‘u Wa‘awa‘a. The green contours outline the enclosure areas corresponding to the partial restoration scenario in which only these regions undergo some changes. Blue corresponds to an increase in groundwater recharge due to restoration, and red corresponds to a decrease. (figure by author in <span class="citation">Wada et al. (2017, in review)</span>)</p>
</div>
<div class="figure">
<img src="images/Fig3.png" alt="Figure 28: Impact of restoration on landscape flammability in Pu‘u Wa‘awa‘a. The green contours outline the enclosure areas corresponding to the partial restoration scenario. Yellow corresponds to a decrease in landscape flammability due to restoration, and red means no change. (figure by author in Wada et al. (2017, in review))" id="fig:hawaii3" style="width:80.0%" />
<p class="caption">Figure 28: Impact of restoration on landscape flammability in Pu‘u Wa‘awa‘a. The green contours outline the enclosure areas corresponding to the partial restoration scenario. Yellow corresponds to a decrease in landscape flammability due to restoration, and red means no change. (figure by author in <span class="citation">Wada et al. (2017, in review)</span>)</p>
</div>
<div class="figure">
<img src="images/Fig4.png" alt="Figure 29: Spatial prioritization and restoration costs in in Pu‘u Wa‘awa‘a. For each objective and both combined. Rank 1 pixels correspond to the highest priority restoration areas. Costs are cumulative, such that if Rank n is restored, Rank n-1 was restored as well. The green contours outline the enclosure areas corresponding to the partial restoration scenario. (figure by author in Wada et al. (2017, in review))" id="fig:hawaii4" style="width:80.0%" />
<p class="caption">Figure 29: Spatial prioritization and restoration costs in in Pu‘u Wa‘awa‘a. For each objective and both combined. Rank 1 pixels correspond to the highest priority restoration areas. Costs are cumulative, such that if Rank n is restored, Rank n-1 was restored as well. The green contours outline the enclosure areas corresponding to the partial restoration scenario. (figure by author in <span class="citation">Wada et al. (2017, in review)</span>)</p>
</div>
<p></p>
<h1 id="bibliography" class="unnumbered">Bibliography</h1>
<div id="refs" class="references">
<div id="ref-Achtert2013_6">
<p>Achtert, E., Kriegel, H.-P., Schubert, E., and Zimek, A. (2013). “Interactive data mining with 3D-parallel-coordinate-trees.” <em>Proceedings of the 2013 acm sigmod international conference on management of data</em>, SIGMOD ’13, ACM, New York, NY, USA, 1009–1012.</p>
</div>
<div id="ref-Aerts03">
<p>Aerts, J. C. J. H., Clarke, K. C., and Keuper, A. D. (2003). “Testing popular visualization techniques for representing model uncertainty,” cartography and geographic.” <em>Information Science</em>, 249–261.</p>
</div>
<div id="ref-Allen1">
<p>Allen, E. A., Erhardt, E. B., and Calhoun, V. D. (2012). “Data visualization in the neurosciences: Overcoming the curse of dimensionality.” <em>Neuron</em>, 74(4), 603–608.</p>
</div>
<div id="ref-andrienkopp">
<p>Andrienko, G., and Andrienko, N. (2001). “Constructing parallel coordinates plot for problem solving.” <em>1st international symposium on smart graphics</em>, 9–14.</p>
</div>
<div id="ref-bifocal">
<p>Apperley, M. D., Tzavaras, I., and Spence, R. (1982). “A BIFOCAL DISPLAY TECHNIQUE FOR DATA PRESENTATION.” <em>Eurographics conference proceedings</em>, D. Greenaway and E. Warman, eds., The Eurographics Association.</p>
</div>
<div id="ref-Arkema2">
<p>Arkema, K. K., Verutes, G. M., Wood, S. A., Clarke-Samuels, C., Rosado, S., Canto, M., Rosenthal, A., Ruckelshaus, M., Guannel, G., Toft, J., Faries, J., Silver, J. M., Griffin, R., and Guerry, A. D. (2015). “Embedding ecosystem services in coastal planning leads to better outcomes for people and nature.” <em>Proceedings of the National Academy of Sciences</em>, 112(24), 7390–7395.</p>
</div>
<div id="ref-arkema1">
<p>Arkema, K. K., Verutes, G., Bernhardt, J. R., Clarke, C., Rosado, S., Canto, M., Wood, S. A., Ruckelshaus, M., Rosenthal, A., McField, M., and others. (2014). “Assessing habitat risk from human activities to inform coastal and marine spatial planning: A demonstration in belize.” <em>Environmental Research Letters</em>, IOP Publishing, 9(11), 114016.</p>
</div>
<div id="ref-beven2006undermining">
<p>Beven, K. (2006). “On undermining the science?” <em>Hydrological processes</em>, Wiley Online Library, 20(14), 3141–3146.</p>
</div>
<div id="ref-Bingham">
<p>Bingham, R. J., and Haines, K. (2006). “Mean dynamic topography: Intercomparisons and errors.” <em>IPhilosophical Transactions of The Royal Society A</em>, 903–916.</p>
</div>
<div id="ref-Desi5656">
<p>Brewer, C. (2004). <em>Designing better maps: A guide for gis users</em>. Environmental Systems Research.</p>
</div>
<div id="ref-Brown2005">
<p>Brown, D. G., Page, S., Riolo, R., Zellner, M., and Rand, W. (2005). “Path dependence and the validation of agent‐based spatial models of land use.” <em>International Journal of Geographical Information Science</em>, Taylor &amp; Francis, 19(2), 153–174.</p>
</div>
<div id="ref-Brown">
<p>Brown, R. (2004). “Animated visual vibrations as an uncertainty visualisation technique.” <em>Proceedings of the 2Nd international conference on computer graphics and interactive techniques in australasia and south east asia</em>, GRAPHITE ’04, ACM, New York, NY, USA, 84–89.</p>
</div>
<div id="ref-RIOS">
<p>Bryant, B. P., Wolny, S., and Vogl, A. L. (n.d.). “Understanding RIOS sensitivities , strengths , and weaknesses A demonstration in the Coyote Creek watershed.”</p>
</div>
<div id="ref-QUICK">
<p>Bryant, and Hawthorne. (n.d.). “Quick intro to optimization.”</p>
</div>
<div id="ref-Buckley2012">
<p>Buckley, A. R. (2012). “Make Maps People Want to Look At.” <em>ArcUser</em>, 46–51.</p>
</div>
<div id="ref-Buczkowski">
<p>Buczkowski, A. (2016). “Top 19 geovisualization tools, apis and libraries that will let you create beautiful web maps.” <em>GeoAwesomeness.com</em>, &lt;<a href="http://geoawesomeness.com/top-19-online-geovisualization-tools-apis-libraries-beautiful-maps/" class="uri">http://geoawesomeness.com/top-19-online-geovisualization-tools-apis-libraries-beautiful-maps/</a>&gt;.</p>
</div>
<div id="ref-Buja">
<p>Buja, A., Cook, D., and Swayne, D. F. (1996). “Interactive high-dimensional data visualization.” <em>Journal of Computational and Graphical Statistics</em>, 5, 78–99.</p>
</div>
<div id="ref-Butler">
<p>Butler, M. P., Reed, P. M., Fisher-Vanden, K., Keller, K., and Wagener, T. (2014). “Identifying parametric controls and dependencies in integrated assessment models using global sensitivity analysis.” <em>Environmental Modelling &amp; Software</em>, 59, 10–29.</p>
</div>
<div id="ref-cardinale2012">
<p>Cardinale, B. J., Duffy, J. E., Gonzalez, A., Hooper, D. U., Perrings, C., Venail, P., Narwani, A., Mace, G. M., Tilman, D., Wardle, D. A., and others. (2012). “Biodiversity loss and its impact on humanity.” <em>Nature</em>, Nature Publishing Group, 486(7401), 59–67.</p>
</div>
<div id="ref-correa">
<p>Carlos D. Correa, Yu-Hsuan Chan, and Ma, K.-L. (2009). “A framework for uncertainty-aware visual analytics.” I. P. of IEEE Symposium on Visual Analytics Science and T. V. 09, eds.</p>
</div>
<div id="ref-raw_raw">
<p>Caviglia, G., and al. (2013). “Raw website.” &lt;<a href="http://raw.densitydesign.org" class="uri">http://raw.densitydesign.org</a>&gt;.</p>
</div>
<div id="ref-Cop21">
<p>Center for Climate and Energy Solutions. (2015). “UN Framework Convention on Climate Change (UNFCCC).” <em>Outcomes of the UN Climate Change Conference in Paris</em>, (December), 1–5.</p>
</div>
<div id="ref-spiderman_bad_Ref">
<p>Chandoo. (2008). “You are not spider man, so why do you use radar charts?”</p>
</div>
<div id="ref-TerrSet">
<p>ClarkLabs. (2015). &lt;<a href="https://clarklabs.org/terrset/idrisi-gis/" class="uri">https://clarklabs.org/terrset/idrisi-gis/</a>&gt;.</p>
</div>
<div id="ref-cleveland1984graphical">
<p>Cleveland, W. S., and McGill, R. (1984). “Graphical perception: Theory, experimentation, and application to the development of graphical methods.” <em>Journal of the American statistical association</em>, Taylor &amp; Francis, 79(387), 531–554.</p>
</div>
<div id="ref-Cohen1960">
<p>Cohen, J. (1960). “A COEFFICIENT OF AGREEMENT FOR NOMINAL SCALES.” <em>EDUCATIONAL AND PSYCHOLOGICAL MEASUREMENT</em>, XX(1), 37–46.</p>
</div>
<div id="ref-costanza">
<p>Costanza, R. (1989). “Model goodness of fit: A multiple resolution procedure.” <em>Ecological Modelling</em>, 47(3-4), 199–215.</p>
</div>
<div id="ref-Crossman">
<p>Crossman, N., Burkhard, B., Nedkov, S., Willemen, L., Petz, K., Palomo, I., Drakou, E., Martín-Lopez, B., McPhearson, T., Boyanova, K., Alkemade, R., Egoh, B., Dunbar, M., and Maes, J. (2013). “A blueprint for mapping and modelling ecosystem services.” <em>Ecosystem Services</em>, 4, 4–14.</p>
</div>
<div id="ref-Cukier">
<p>Cukier, K. (2010). <em>Data, data everywhere: A special report on managing information</em>. Economist Newspaper.</p>
</div>
<div id="ref-daily2000">
<p>Daily, G. C., Söderqvist, T., Aniyar, S., Arrow, K., Dasgupta, P., Ehrlich, P. R., Folke, C., Jansson, A., Jansson, B.-O., Kautsky, N., and others. (2000). “The value of nature and the nature of value.” <em>Science</em>, American Association for the Advancement of Science, 289(5478), 395–396.</p>
</div>
<div id="ref-Ehlschlaeger">
<p>Ehlschlaeger, C. R., Shortridge, A. M., and Goodchild, M. F. (1997). “Visualizing spatial data uncertainty using animation.” <em>Computers in GeoSciences</em>, 23(4), 387–395.</p>
</div>
<div id="ref-Englund">
<p>Englund, O., Berndes, G., and Cederberg, C. (2017). “How to analyse ecosystem services in landscapes—A systematic review.” <em>Ecological Indicators</em>, 73, 492–504.</p>
</div>
<div id="ref-tornadospider">
<p>Eschenbach, T. G. (1992). “Spiderplots versus tornado diagrams for sensitivity analysis.” <em>Interfaces</em>, INFORMS, 22(6), 40–46.</p>
</div>
<div id="ref-Fisher">
<p>Fisher, P. (1994). “Animation and sound for the visualization of uncertain spatial information.” <em>Visualization in Graphical Information Systems</em>, Wiley, 181–185.</p>
</div>
<div id="ref-Fleming05">
<p>Fleming, P. J., Purshouse, R. C., and Lygoe, R. J. (2005). “Many-Objective Optimization: An Engineering Design Perspective.” <em>Evolutionary Multi-Criterion Optimization: Third International Conference, EMO 2005, Guanajuato, Mexico, March 9-11, 2005. Proceedings</em>, 14–32.</p>
</div>
<div id="ref-Furnas_fisheye">
<p>Furnas, G. W. (1986). “Generalized fisheye views.” <em>SIGCHI Bull.</em>, ACM, New York, NY, USA, 17(4), 16–23.</p>
</div>
<div id="ref-prosections">
<p>Furnas, G., and Bujat, A. (1994). “Prosection Views: Dimensional Inference Through Sections and Proje.” <em>Journal of Computational and Graphical Statistics</em>, 3(3), 323–353.</p>
</div>
<div id="ref-jgong">
<p>Gong, J., C., X. Y., C.X, Z., and Y.J., G. (2016). “Study on watershed ecosystem service governance based on landscape ecological risk assessment: A case study of bailongjiang watershed of southern gansu, china.”</p>
</div>
<div id="ref-griethe">
<p>Griethe, H., and Schumann, H. (2006). “The visualization of uncertain data: Methods and problems.” <em>SimVis</em>, 143–156.</p>
</div>
<div id="ref-Guardian">
<p>Guardian, T. (2015). “The 10 sustainable development goals that rainforests can help us achieve.” <em>The Guardian</em>, &lt;<a href="https://www.theguardian.com/cgd-partner-zone/2017/jan/23/10-ways-tropical-forests-help-sustainable-development-goals" class="uri">https://www.theguardian.com/cgd-partner-zone/2017/jan/23/10-ways-tropical-forests-help-sustainable-development-goals</a>&gt;.</p>
</div>
<div id="ref-AnneBlog">
<p>Guerry, A. (2016). “NATURE is priceless — so let’S value it.” &lt;<a href="http://ensia.com/voices/nature-priceless-value/" class="uri">http://ensia.com/voices/nature-priceless-value/</a>&gt;.</p>
</div>
<div id="ref-Hadka2015">
<p>Hadka, D., Herman, J., Reed, P., and Keller, K. (2015). “An open source framework for many-objective robust decision making.” <em>Environmental Modelling and Software</em>, 74, 114–129.</p>
</div>
<div id="ref-Hagen2003">
<p>Hagen, A. (2003). “Fuzzy set approach to assessing similarity of categorical maps.” <em>International Journal of Geographical Information Science</em>, 17(3), 235–249.</p>
</div>
<div id="ref-hamby">
<p>Hamby, D. (1994). “A review of techniques for parameter sensitivity analysis of environmental models.” <em>Environmental monitoring and assessment</em>, Springer, 32(2), 135–154.</p>
</div>
<div id="ref-Hauck">
<p>Hauck, J., Görg, C., Varjopuro, R., Ratamäki, O., Maes, J., Wittmer, H., and Jax, K. (2013). “‘Maps have an air of authority’: Potential benefits and challenges of ecosystem service maps at different levels of decision making.” <em>Ecosystem Services</em>, 4, 25–32.</p>
</div>
<div id="ref-Peter">
<p>Hawthorne, P. (2016). “Middle cedar visualization.” &lt;<a href="https://phawthorne.github.io/mc-vis/" class="uri">https://phawthorne.github.io/mc-vis/</a>&gt;.</p>
</div>
<div id="ref-hengl">
<p>Hengl, T. (2003). “Visualisation of uncertainty using the hsi colour model: Computation with colours.” <em>In Proceedings of the 7th International Conference on GeoComputation</em>, 8–17.</p>
</div>
<div id="ref-carto_img">
<p>Hennig, B. (2011). “Worldmapper population cartogram.” &lt;<a href="www.viewsoftheworld.net" class="uri">www.viewsoftheworld.net</a>&gt;.</p>
</div>
<div id="ref-violin">
<p>Hintze, J. L., and Nelson, R. D. (1998). “Violin plots: A box plot-density trace synergism.” <em>The American Statistician</em>, Taylor &amp; Francis Group, 52(2), 181–184.</p>
</div>
<div id="ref-Homma">
<p>Homma, T., and Saltelli, A. (1996). “Importance measures in global sensitivity analysis of nonlinear models.” <em>Reliability Engineering &amp; System Safety</em>, Elsevier, 52(1), 1–17.</p>
</div>
<div id="ref-hotelling1933analysis">
<p>Hotelling, H. (1933). “Analysis of a complex of statistical variables into principal components.” <em>Journal of educational psychology</em>, Warwick &amp; York, 24(6), 417.</p>
</div>
<div id="ref-Huang13">
<p>Huang, Q., Parker, D. C., Sun, S., and Filatova, T. (2013). “Effects of agent heterogeneity in the presence of a land-market: A systematic test in an agent-based laboratory.” <em>Computers, Environment and Urban Systems</em>, 41, 188–203.</p>
</div>
<div id="ref-CS">
<p>Huwyler, F., Käppeli, J., and Tobin, J. (2016). “Conservation finance - from niche to mainstream: The building of an institutional asset class.” <em>Crédit Suisse and McKinsey</em>.</p>
</div>
<div id="ref-McKinsey">
<p>Huwyler, F., Käppeli, J., Serafimova, K., Swanson, E., and Tobin, J. (2014). “Conservation finance : Moving beyond donor funding toward an investor-driven approach.” <em>Crédit Suisse AG, WWF and McKinsey</em>.</p>
</div>
<div id="ref-python_libs">
<p>Hügel, S. (2015). “So you’d like to make a map using python.” &lt;<a href="http://sensitivecities.com/so-youd-like-to-make-a-map-using-python-EN.html#.WCpPzBRFRhN" class="uri">http://sensitivecities.com/so-youd-like-to-make-a-map-using-python-EN.html#.WCpPzBRFRhN</a>&gt;.</p>
</div>
<div id="ref-Piotr">
<p>Jankowski, P., Zielinska, A.-L., and Swobodzinski, M. (2008). “Choice modeler: A web-based spatial multiple criteria evaluation tool.” <em>Transactions in GIS</em>, 12(4), 541–561.</p>
</div>
<div id="ref-horizon">
<p>Jeffrey Heer, M. A., Nicholas Kong. (2009). “Sizing the horizon: The effects of chart size and layering on the graphical perception of time series visualizations.” <em>ACM Human Factors in Computing Systems</em>, 1303–1312.</p>
</div>
<div id="ref-Tour">
<p>Jeffrey Heer, V. O., Michael Bostock. (2010). “A tour through the visualization zoo.” <em>Communications of the ACM</em>, 53(6), 59–67.</p>
</div>
<div id="ref-potter">
<p>K. Potter, A. W., P.-t. Bremer, D. W., C. Doutriaux, V. P., and Johnson, C. (2009). “Ensemble-vis: A framework for the statistical visualization of ensemble data.” I. P. of the 2009 IEEE International Conference on Data Mining Workshops, ed., IEEE Computer Society, 233–240.</p>
</div>
<div id="ref-kader7">
<p>Kader, G. D., and Perry, M. (2007). “Variability for categorical variables.” <em>Journal of Statistics Education</em>, American Statistical Association. 732 North Washington Street, Alexandria, VA 22314, 15(2), 1–17.</p>
</div>
<div id="ref-ggmap">
<p>Kahle, D., and Wickham, H. (2013). “Ggmap: Spatial visualization with ggplot2.” <em>The R Journal</em>, 5(1), 144–162.</p>
</div>
<div id="ref-Keim">
<p>Keim, D. A. (2000). “Designing Pixel-oriented Visualization Techniques : Theory and Applications.” 6(1), 59–78.</p>
</div>
<div id="ref-Kelleher">
<p>Kelleher, C., and Wagener, T. (2011). “Ten guidelines for effective data visualization in scientific publications.” <em>Environmental Modelling &amp; Software</em>, 26(6), 822–827.</p>
</div>
<div id="ref-Brodlie">
<p>Ken Brodlie, R. A. O., and Lopes, A. (2012). “A review of uncertainty in data visualization.”</p>
</div>
<div id="ref-Dimitra">
<p>Kitsiou, D., and Karydis, M. (2000). “Categorical mapping of marine eutrophication based on ecological indices.” <em>Science of The Total Environment</em>, 255(1–3), 113–127.</p>
</div>
<div id="ref-Kollat_Video">
<p>Kollat, J. B., and Reed, P. (2007). “A framework for Visually Interactive Decision-making and Design using Evolutionary Multi-objective Optimization (VIDEO).” <em>Environmental Modelling and Software</em>, 22(12), 1691–1704.</p>
</div>
<div id="ref-kosslyn1992minding">
<p>Kosslyn, S. M., and Chabris, C. F. (1992). “Minding information graphics.” <em>Folio: the Magazine for Magazine Management</em>, 21(2), 69–71.</p>
</div>
<div id="ref-Kuhnert2005">
<p>Kuhnert, M., Voinov, A., and Seppelt, R. (2005). “Comparing Raster Map Comparison Algorithms for Spatial Modeling and Analysis.” <em>Photogrammetric Engineering and remote Sensing (PE&amp;RD)</em>, 71(8), 975–984.</p>
</div>
<div id="ref-Lamping">
<p>Lamping, J., Rao, R., and Pirolli, P. (1995). “A focus+context technique based on hyperbolic geometry for visualizing large hierarchies.” <em>Proceedings of the sigchi conference on human factors in computing systems</em>, CHI ’95, ACM Press/Addison-Wesley Publishing Co., New York, NY, USA, 401–408.</p>
</div>
<div id="ref-ABMleelig">
<p>Lee, J.-S., Filatova, T., Ligmann-Zielinska, A., Hassani-Mahmooei, B., Stonedahl, F., Lorscheid, I., Voinov, A., Polhill, J. G., Sun, Z., and Parker, D. C. (2015). “The complexities of agent-based modeling output analysis.” <em>Journal of Artificial Societies and Social Simulation</em>, 18(4), 4.</p>
</div>
<div id="ref-Leung">
<p>Leung, Y. K., and Apperley, M. D. (1994). “A review and taxonomy of distortion-oriented presentation techniques.”</p>
</div>
<div id="ref-lig14">
<p>Ligmann-Zielinska, A., Kramer, D., Spence Cheruvelil, K., and Soranno, P. A. (2014). “Using uncertainty and sensitivity analyses in socioecological agent-based models to improve their analytical performance and policy relevance.” <em>PLOS ONE</em>, Public Library of Science, 9(10), 1–13.</p>
</div>
<div id="ref-ourenco2004binary">
<p>Lourenco, F., Lobo, V., and Bacao, F. (2004). “Binary-based similarity measures for categorical data and their application in self-organizing maps.” JOCLAD.</p>
</div>
<div id="ref-Lundstrom">
<p>Lundstrom, C., Ljung, P., Persson, A., and Ynnerman, A. (2007). “Uncertainty visualization in medical volume rendering using probabilistic animation ieee transactions on visualization and computer graphics 13 (6).” 1648–1655.</p>
</div>
<div id="ref-mac92">
<p>Maceachren, A. M. (1992). “Visualizing uncertain information.” <em>Cartographic Perspectives</em>, 13, 10–19.</p>
</div>
<div id="ref-Mackinlay">
<p>Mackinlay, J. D., Robertson, G. G., and Card, S. K. (1991). “The perspective wall: Detail and context smoothly integrated.” <em>Proceedings of the sigchi conference on human factors in computing systems</em>, CHI ’91, ACM, New York, NY, USA, 173–176.</p>
</div>
<div id="ref-Maier">
<p>Maier, H., Guillaume, J., Delden, H. van, Riddell, G., Haasnoot, M., and Kwakkel, J. (2016). “An uncertain future, deep uncertainty, scenarios, robustness and adaptation: How do they fit together?” <em>Environmental Modelling &amp; Software</em>, 81, 154–164.</p>
</div>
<div id="ref-Myanmar16">
<p>Mandle, L., Wolny, S., Hamel, P., Helsingen, H., Bhagabati, N., and Dixon, A. (2016). “Natural connections: How natural capital supports Myanmar’s people and economy.”</p>
</div>
<div id="ref-Manson2005">
<p>Manson, S. M. (2005). “Agent-based modeling and genetic programming for modeling land change in the Southern Yucat??n Peninsular Region of Mexico.” <em>Agriculture, Ecosystems and Environment</em>, 111(1-4), 47–62.</p>
</div>
<div id="ref-Maria">
<p>Martínez-Harms, M. J., and Balvanera, P. (2012). “Methods for mapping ecosystem service supply: A review.” <em>International Journal of Biodiversity Science, Ecosystem Services &amp; Management</em>, 8(1-2), 17–25.</p>
</div>
<div id="ref-akbar">
<p>Matkan, A. A., Shahri, M., and Mirzaie, M. (2013). “Bivariate moran’s i and lisa to explore the crash risky locations in urban areas.” <em>Proceedings of the conference of network-association of european researchers on urbanisation in the south, enschede, the netherlands</em>, 12–14.</p>
</div>
<div id="ref-McMahon2016">
<p>McMahon, R., Stauffacher, M., and Knutti, R. (2016). “The scientific veneer of ipcc visuals.” <em>Climatic Change</em>, 138(3), 369–381.</p>
</div>
<div id="ref-LectureGIS">
<p>Medeiros, D. (2016). “An introduction to gis using arcgis.” Stanford Geospatial Center, Stanford University; University Lecture.</p>
</div>
<div id="ref-murphy04">
<p>Murphy, J. M., Sexton, D. M., Barnett, D. N., Jones, G. S., Webb, M. J., Collins, M., and Stainforth, D. A. (2004). “Quantification of modelling uncertainties in a large ensemble of climate change simulations.” <em>Nature</em>, Nature Publishing Group, 430(7001), 768–772.</p>
</div>
<div id="ref-naturalcapitalscotland">
<p>Natural Capital Scotland Ltd. (2015). “World forum on natural capital, edinburgh, uk.” &lt;<a href="naturalcapitalforum.com/about/" class="uri">naturalcapitalforum.com/about/</a>&gt;.</p>
</div>
<div id="ref-polasky">
<p>Nelson, E., Polasky, S., Lewis, D. J., Plantinga, A. J., Lonsdorf, E., White, D., Bael, D., and Lawler, J. J. (2008). “Efficiency of incentives to jointly increase carbon sequestration and species conservation on a landscape.” <em>Proceedings of the National Academy of Sciences</em>, National Acad Sciences, 105(28), 9471–9476.</p>
</div>
<div id="ref-Kkkk">
<p>Nemec, K. T., and Raudsepp-Hearne, C. (2013). “The use of geographic information systems to map and assess ecosystem services.” <em>Biodiversity and conservation</em>, Springer, 22(1), 1–15.</p>
</div>
<div id="ref-paretoUNIL">
<p>Pareto, V. (1896). <em>Cours d’Économie politique professé a l’Université de lausanne</em>.</p>
</div>
<div id="ref-Parker2004">
<p>Parker, D. C., and Meretsky, V. (2004). “Measuring pattern outcomes in an agent-based model of edge-effect externalities using spatial metrics.” <em>Agriculture, Ecosystems &amp; Environment</em>, 101(2–3), 233–250.</p>
</div>
<div id="ref-Millennium2005">
<p>Percy, S., and Lubchencho, J. (2005). “Ecosystems and human well being–opportunities and challenges for business and industry.” <em>Millennium Ecosystem Assessment</em>.</p>
</div>
<div id="ref-Pianosi2016">
<p>Pianosi, F., Beven, K., Freer, J., Hall, J. W., Rougier, J., Stephenson, D. B., and Wagener, T. (2016). “Sensitivity analysis of environmental models: A systematic review with practical workflow.” <em>Environmental Modelling &amp; Software</em>, 79, 214–232.</p>
</div>
<div id="ref-Pontius2000">
<p>Pontius, G. R. (2000). “Quantification error versus location error in comparison of categorical maps.” <em>Photogrammetric Engineering and Remote Sensing</em>, 66(8), 1011–1016.</p>
</div>
<div id="ref-Pontius2011">
<p>Pontius, R. G., and Millones, M. (2011). “Death to kappa: Birth of quantity disagreement and allocation disagreement for accuracy assessment.” <em>International Journal of Remote Sensing</em>, 32(15), 4407–4429.</p>
</div>
<div id="ref-Pontius2008">
<p>Pontius, R. G., Thontteh, O., and Chen, H. (2008). “Components of information for multiple resolution comparison between maps that share a real variable.” <em>Environmental and Ecological Statistics</em>, Springer.</p>
</div>
<div id="ref-power2001">
<p>Power, C., Simms, A., and White, R. (2001). “Hierarchical fuzzy pattern matching for the regional comparison of land use maps.” <em>International Journal of Geographical Information Science</em>, Taylor &amp; Francis, 15(1), 77–100.</p>
</div>
<div id="ref-Natcapwebsite">
<p>Project, T. N. C. (n.d.). “The natural capital project.” &lt;<a href="http://www.naturalcapitalproject.org" class="uri">http://www.naturalcapitalproject.org</a>&gt;.</p>
</div>
<div id="ref-temporalmap">
<p>R., K. (2014). “Using a temporal information system for visualization and analysis of hydrologic time-series data.”</p>
</div>
<div id="ref-ABM_intro">
<p>Rand, U. W. W. (2015). <em>An introduction to agent-based modeling</em>. MIT Press.</p>
</div>
<div id="ref-Reed04">
<p>Reed, P. M., and Minsker, B. S. (2004). “Striking the Balance: Long-Term Groundwater Monitoring Design for Conflicting Objectives.” <em>Journal of Water Resources Planning and Management</em>, 130(2), 140–149.</p>
</div>
<div id="ref-reichert2005does">
<p>Reichert, P., and Borsuk, M. E. (2005). “Does high forecast uncertainty preclude effective decision support?” <em>Environmental Modelling &amp; Software</em>, Elsevier, 20(8), 991–1001.</p>
</div>
<div id="ref-datavizz">
<p>Ribecca, S. (n.d.). “Data visualization catalogue.” &lt;<a href="http://datavizcatalogue.com" class="uri">http://datavizcatalogue.com</a>&gt;.</p>
</div>
<div id="ref-Ritters1995">
<p>Ritters, K., O’Neill, R., Hunsaker, C., Wickham, J., Yankee, D., Timmins, S., Jones, K., and Jackson, B. (1995). “A factor analysis of landscape pattern and structure metrics.” <em>Landscape Ecology</em>, 10(1), 23–39.</p>
</div>
<div id="ref-Roth">
<p>Roth, R. E., and M., H. (2008). “Addressing map interface usability: Learning from the lakeshore nature preserve interactive map.” <em>Cartographic Perspectives</em>, (60), 46–66.</p>
</div>
<div id="ref-Ruckelshaus15">
<p>Ruckelshaus, M., McKenzie, E., Tallis, H., Guerry, A., Daily, G., Kareiva, P., Polasky, S., Ricketts, T., Bhagabati, N., Wood, S. A., and Bernhardt, J. (2015). “Notes from the field: Lessons learned from using ecosystem service approaches to inform real-world decisions.” <em>Ecological Economics</em>, 115, 11–21.</p>
</div>
<div id="ref-russ95">
<p>Russ, J. C. (1995). <em>The image processing handbook</em>. Boca Raton, CRC Press, 2nd Edition, 674 p. (ISBN 0-8493-2516-1).</p>
</div>
<div id="ref-Lodha">
<p>S.K. Lodha, C.M. Wilson, and Sheehan, R. (1996). “LISTEN: Sounding uncertainty visualization.” <em>In Proceedings of Visualization 96</em>, 189–195.</p>
</div>
<div id="ref-sanyal">
<p>Sanyal, J., Zhang, S., Dyer, J., Mercer, A., Amburn, P., and Moorhead, R. J. (2010). “Noodles: A tool for visualization of numerical weather model ensemble uncertainty.” <em>Visualization and Computer Graphics</em>, 16, 1421–1430.</p>
</div>
<div id="ref-Seppelt2003217">
<p>Seppelt, R., and Voinov, A. (2003). “Optimization methodology for land use patterns—evaluation based on multiscale habitat pattern comparison.” <em>Ecological Modelling</em>, 168(3), 217–231.</p>
</div>
<div id="ref-isoflor">
<p>Specht, R. L. (1981). <em>Heathlands and related shrublands : Analytical studies</em>. Elsevier Scientific Pub.</p>
</div>
<div id="ref-stephens2012">
<p>Stephens, E. M., Edwards, T. L., and Demeritt, D. (2012). “Communicating probabilistic information from climate model ensembles—lessons from numerical weather prediction.” <em>Wiley interdisciplinary reviews: climate change</em>, Wiley Online Library, 3(5), 409–426.</p>
</div>
<div id="ref-Sun14">
<p>Sun, S., Parker, D. C., Huang, Q., Filatova, T., Robinson, D. T., Riolo, R. L., Hutchins, M., and Brown, D. G. (2014). “Market impacts on land-use change: An agent-based experiment.” <em>Annals of the Association of American Geographers</em>, 104(3), 460–484.</p>
</div>
<div id="ref-Teo2003281">
<p>Teo, H.-H., Oh, L.-B., Liu, C., and Wei, K.-K. (2003). “An empirical study of the effects of interactivity on web user attitude.” <em>International Journal of Human-Computer Studies</em>, 58(3), 281–305.</p>
</div>
<div id="ref-piepiepie">
<p>Todd, C. (2016). “The pros and cons of pie charts (mostly the cons though).” <em>Stytch</em>, &lt;<a href="https://www.stytch.com/pros-cons-pie-charts-data-visualization/" class="uri">https://www.stytch.com/pros-cons-pie-charts-data-visualization/</a>&gt;.</p>
</div>
<div id="ref-sohardtovizuncertainty">
<p>Torres, N. (2016). “Why it’s so hard for us to visualize uncertainty.” <em>Harvard Business Review</em>.</p>
</div>
<div id="ref-Alluvial">
<p>Trindade, B. (2017). “Alluvial plots.” <em>Water Programming: A Collaborative Research Blog</em>, &lt;<a href="https://waterprogramming.wordpress.com/2017/01/21/alluvial-plots/" class="uri">https://waterprogramming.wordpress.com/2017/01/21/alluvial-plots/</a>&gt;.</p>
</div>
<div id="ref-Troy">
<p>Troy, A., and Wilson, M. (2006). “Mapping ecosystem services: Practical challenges and opportunities in linking gis and value transfer.” <em>Ecological Economics</em>, 60(2), 435–449.</p>
</div>
<div id="ref-tufte">
<p>Tufte, E. (1983). <em>The visual display of quantitative information</em>. The visual display of quantitative information, Graphics Press.</p>
</div>
<div id="ref-streamchart">
<p>Vallandingham, J. (n.d.). “How to animate transitions between multiple charts.” &lt;<a href="http://flowingdata.com/2013/01/17/how-to-animate-transitions-between-multiple-charts" class="uri">http://flowingdata.com/2013/01/17/how-to-animate-transitions-between-multiple-charts</a>&gt;.</p>
</div>
<div id="ref-jaccard">
<p>Van Rijsbergen, C. (1979). “Information retrieval. dept. of computer science, university of glasgow.” <em>URL: citeseer. ist. psu. edu/vanrijsbergen79information. html</em>, 14.</p>
</div>
<div id="ref-greggg">
<p>Verutes, G., Stacie Wolny, G. K., and Wyatt, K. (2015). “Getting started with a natural capital approach.”</p>
</div>
<div id="ref-villamor14">
<p>Villamor, G. B., Le, Q. B., Djanibekov, U., Noordwijk, M. van, and Vlek, P. L. (2014). “Biodiversity in rubber agroforests, carbon emissions, and rural livelihoods: An agent-based model of land-use dynamics in lowland sumatra.” <em>Environmental Modelling &amp; Software</em>, 61, 151–165.</p>
</div>
<div id="ref-visser2006map">
<p>Visser, H., and De Nijs, T. (2006). “The map comparison kit.” <em>Environmental Modelling &amp; Software</em>, Elsevier, 21(3), 346–358.</p>
</div>
<div id="ref-Vitousek494">
<p>Vitousek, P. M., Mooney, H. A., Lubchenco, J., and Melillo, J. M. (1997). “Human domination of earths ecosystems.” <em>Science</em>, American Association for the Advancement of Science, 277(5325), 494–499.</p>
</div>
<div id="ref-Sadrian">
<p>Vogl, A., Wolny, S., Hamel, P., Johnson, J., Rogers, M., and Dennedy-Frank, J. (2014). “Valuation of hydropower services (technical support for himachal pradesh development policy loan).”</p>
</div>
<div id="ref-PWW">
<p>Wada, C., Bremer, L., Burnett, K., Trauernicht, C., Giambelluca, T., Mandle, L., Parsons, E., Weil, C., and Ticktina, T. (2017, in review). “Prioritizing management investments at pu‘u wa‘awa‘a, hawai‘i using spatial changes in water yield and landscape flammability under forest restoration and climate change.”</p>
</div>
<div id="ref-xmdvtool">
<p>Ward, M. (1994). “Xmdvtool: Integrating multiple methods for visualizing multivariate data.” <em>Proceedings of the conference on visualization’94</em>, IEEE Computer Society Press, 326–333.</p>
</div>
<div id="ref-Ware2000">
<p>Ware, C. (2000). “Information visualization: Perception for design morgan kaufmann.” <em>New York</em>.</p>
</div>
<div id="ref-Vander">
<p>Wel, F. J. V. der, Gaag, L. C. V. der, and Gorte, B. G. (1998). “Visual exploration of uncertainty in remote-sensing classification.” <em>Computers &amp; Geosciences</em>, 24(4), 335–343.</p>
</div>
<div id="ref-van2008">
<p>Werkhoven, K. van, Wagener, T., Reed, P., and Tang, Y. (2008). “Characterization of watershed model behavior across a hydroclimatic gradient.” <em>Water Resources Research</em>, Wiley Online Library, 44(1).</p>
</div>
<div id="ref-wickham08">
<p>Wickham, H. (2008). <em>A layered grammar of graphics</em>.</p>
</div>
<div id="ref-wieland212">
<p>Wieland, A., and Marcus Wallenburg, C. (2012). “Dealing with supply chain risks: Linking risk management practices and strategies to performance.” <em>International Journal of Physical Distribution &amp; Logistics Management</em>, Emerald Group Publishing Limited, 42(10), 887–905.</p>
</div>
<div id="ref-Wijk">
<p>Wijk, R. V. L., Jarke J van. (1993). “HyperSlice.” <em>IEEE</em>.</p>
</div>
<div id="ref-bin">
<p>Wikipedia. (2016). “Data binning.”</p>
</div>
<div id="ref-wilhelm1995software">
<p>Wilhelm, A., Unwin, A. R., and Theus, M. (1995). “Software for interactive statistical graphics-a review.” <em>Proc. int. softstat ‘95 conf., heidelberg, germany</em>.</p>
</div>
<div id="ref-PotterWilson">
<p>Wilson, A., and Potter, K. (2009). “Toward Visual Analysis of Ensemble Data Sets.” <em>UltraVis ’09 Proceedings of the 2009 Workshop on Ultrascale Visualization</em>, 48–53.</p>
</div>
<div id="ref-Winer02">
<p>Winer, E. H., and Bloebaum, C. L. (2002). “Development of visual design steering as an aid in large-scale multidisciplinary design optimization. Part II: Method validation.” <em>Structural and Multidisciplinary Optimization</em>, 23(6), 425–435.</p>
</div>
<div id="ref-StaciePrez">
<p>Wolny, S. (2016). “Introduction to natural capital approach.” WWF Bhutan workshop.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The field of ecosystem services suffers some inconsistent terminology in literature <span class="citation">(Englund et al. 2017)</span>. Hence, an effort is made here to define precisely the terms used, point out synonyms and vague terminology, to avoid confusions.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>evaluated by the Millenium Assessments <span class="citation">(Percy and Lubchencho 2005)</span>.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>On a scale from 0 to 5, with 0 meaning totally useless and 5 totally useful.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Useful links about analysis of spatial data in R:<br />
- <a href="https://cran.r-project.org/web/views/Spatial.html">overview of analysis of spatial data</a><br />
- <a href="https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf">Illustration of the ggmap package</a><br />
- <a href="https://cran.r-project.org/web/packages/raster/vignettes/Raster.pdf">Introduction to the raster package</a><br />
- <a href="https://oscarperpinan.github.io/rastervis/">and to RasterVis, which builds on raster package</a><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Useful links to make maps using Python (matplotlib, basemap):<br />
- <a href="http://sensitivecities.com/so-youd-like-to-make-a-map-using-python-EN.html#.WCJPDvkrJhE">A well written blogpost</a><br />
- <a href="http://www.datadependence.com/2016/06/creating-map-visualisations-in-python/">and another one</a><br />
- <a href="http://matplotlib.org/basemap/users/examples.html">basemap examples</a>.<a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>Vocabulary note: “multi-objective” refers here to problems with three or more objectives, also called many-objective problems <span class="citation">(Fleming et al. 2005)</span> or high order-Pareto optimization problems <span class="citation">(Reed and Minsker 2004)</span><a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>A side concern that may come up in these cases, is about data management: the total size of the runs can become is too large for available main memory. A strategy is to precompute summary statistics, such as the mean and extrema <span class="citation">(Wilson and Potter 2009)</span>.<a href="#fnref7">↩</a></p></li>
<li id="fn8"><p>Links to parallel coordinates and alluvial plots implementations and packages:<br />
- <a href="https://reed.cee.cornell.edu/parallel-axis/">A tool to build directly an interactive parallel coordinate plot</a><br />
- <a href="http://syntagmatic.github.io/parallel-coordinates/">Its underlying implementation, with D3.js</a><br />
- <a href="https://waterprogramming.wordpress.com/2016/09/12/easy-vectorized-parallel-plots-for-multiple-data-sets/">Parallel plots in Python</a><br />
- <a href="https://openmordm.shinyapps.io/Iris/">Interactive parallel plots in R, with Shiny and 3D scatterplot</a><br />
- <a href="https://cran.r-project.org/web/packages/alluvial/vignettes/alluvial.html">Alluvial plot package in R</a>.<a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>Spiderplots or spidercharts is a blurry term to that has been used to refer both to 2-axis spiderplots (as in figure ), but also to multi-axis spiderplots which are also refered to as radar chart (as in figure a).<a href="#fnref9">↩</a></p></li>
<li id="fn10"><p>see also petal charts, and discussion from <span class="citation">Chandoo (2008)</span>.<a href="#fnref10">↩</a></p></li>
<li id="fn11"><p>Normalizing consists in dividing the variable of interest per unit area; e.g to express population, the population per square kilometer should be displayed.<a href="#fnref11">↩</a></p></li>
<li id="fn12"><p>MCK compares raster maps using fuzzy set map comparison, hierarchical fuzzy pattern matching, and moving window based comparison of landscape structure. <a href="http://mck.riks.nl">See MCK website</a>.<a href="#fnref12">↩</a></p></li>
<li id="fn13"><p>More precisely, the modal portfolio maps can either display the category assigned in most of the runs, or limit to these assigned in a certain threshold percentage of the runs.<a href="#fnref13">↩</a></p></li>
<li id="fn14"><p>Agent-based modeling (ABM), or indivisual-based modeling consist in representing phenomenas as dynamical systems of interacting agents, where an agent is a discrete and autonomous entity. Their individual behaviors are encoded, resulting in outputs describing the the agents’ interactions that are used to describe complex systems. These systems can be a variety of processes, phenomena, and situations in any field. <span class="citation">(Rand 2015)</span> In the context of this work, ABM is of interest because of the high volume of multidimensional output data (induces by Monte Carlo sampling), the visualization and statistical analysis of these outputs can be applied.<a href="#fnref14">↩</a></p></li>
<li id="fn15"><p>Details of calculations can be found <a href="https://docs.google.com/spreadsheets/d/1wsm0-X5-pJ_I7J7nduWE_dmiOVWgSUyyo-51t58C8Vo/edit#gid=436596527">here</a><a href="#fnref15">↩</a></p></li>
<li id="fn16"><p>Spiderplots or spidercharts is a blurry term to that has been used to refer both to 2-axis spiderplots (as in figure ), but also to multi-axis spiderplots which are also refered to as radar chart (as in figure a).<a href="#fnref16">↩</a></p></li>
<li id="fn17"><p>Examples: a run where each objective is given equal importance : <em>AWY_weigth = SDE_weight = SDL_weight = 33%</em>. A run where one cares mostly about AWY and slightly about SDE: <em>AWY_weight = 75%, SDE_weight = 25%, SDL_weight = 0%</em>.<a href="#fnref17">↩</a></p></li>
<li id="fn18"><p><span class="citation">Huwyler et al. (2014)</span> calculates that, to meet the global need for conservation funding, investable cash flows from conservation projects need to be at least 20-30 times greater than they are today, reaching USD 200-300 billion per year.<a href="#fnref18">↩</a></p></li>
</ol>
</div>
</div>
</main>
<!-- jQuery  -->
<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

<!-- Materialize javascript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>

<!-- Beautiful math formulaes -->
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>

// Insert title of project
const titleFirst="Natural Capital Data Visualization";
const titleSecond="to promote sustainable decision making";
$(
    '<h1 id="title" class="title first">' + titleFirst + '</h1>' +
    '<h1 class="title second">' + titleSecond + '</h1>'
 ).insertAfter("#TOC");

// Make table of contents the side navigation
const toc = $('#TOC ul:first-child');
toc.addClass("side-nav").addClass("fixed");

// Add link to live demo & title of project
const demoUrl = 'https://charlottegiseleweil.github.io/webviz_natcap/intro.html';
toc.prepend('<li>' + 
    '<a href="' + demoUrl + '">' +
    '<i class="material-icons">launch</i> Visualization dashboard' +
    '</a>' +
    '<div class="bottom divider"></div>' +
    '</li>' +
    '<li>' +
    '<a class="title" href="#title">' +
    titleFirst +
    '</a>' +
    '</li>');

// Add link to pdf document
toc.append(
    '<li>' + 
    '<div class="divider"></div>' +
    '<a href="thesis.pdf" target="_blank">' +
    '<i class="material-icons">picture_as_pdf</i> PDF version' +
    '</a>' +
    '</li>');


// Truncate long titles in side-nav & cool wave effect
$('#TOC ul li a').addClass("truncate").addClass('waves-effect');

// Make elements collapsible in side nav
$('#TOC ul').addClass("collapsible").addClass("collapsible-accordion");
$('#TOC ul li a').addClass("collapsible-header");
$('#TOC ul li a + ul').addClass("collapsible-body");

// Add cool avatar picture
const avatarUrl = '../images/avatar.jpg';
const logoUrl = '../images/natcap-logo.jpg';
const natcapUrl = 'http://www.naturalcapitalproject.org';
const githubUrl = 'https://github.com/charlottegiseleweil';
const linkedInUrl = 'https://www.linkedin.com/in/charlotteweil';
const email = 'weilcharlotte@gmail.com';
toc.prepend('<li>' +
    '<div class="userView">' +
    '<a class="inline" href="' + natcapUrl + '"><img class="logo" src="' + logoUrl + '"></a>' +
    '<a class="inline" href="' + githubUrl + '"><img class="avatar circle" src="' + avatarUrl + '"></a>' +
    '<span class="name">' + 
    'Author: Charlotte Weil' +
    '<a class="inline-icon" href="mailto:' + email + '"><i class="material-icons">email</i></a>' +
    '<a class="inline-icon" href="' + linkedInUrl + '"><i class="zmdi zmdi-linkedin"></i></a>' +
    '<a class="inline-icon" href="' + githubUrl + '"><i class="zmdi zmdi-github"></i></a>' +
    '</span>' +
    '</div>' +
    '<div class="divider"></div>' +
    '</li>');

// Make all external links open in new tab
$("main a[href^='http']").attr("target", "_blank");
</script>
</body>
</html>
